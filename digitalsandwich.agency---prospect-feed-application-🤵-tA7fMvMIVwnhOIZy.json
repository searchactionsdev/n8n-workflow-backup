{"createdAt":"2025-01-17T13:25:05.430Z","updatedAt":"2025-02-10T21:42:21.000Z","id":"tA7fMvMIVwnhOIZy","name":"digitalsandwich.agency - Prospect Feed application 🤵","active":true,"nodes":[{"parameters":{"formTitle":"Digital Sandwich - Prospect Feed ","formFields":{"values":[{"fieldLabel":"Company Name","placeholder":"Your company name","requiredField":true},{"fieldLabel":"Your Website URL ","placeholder":"Your website URL ","requiredField":true}]},"responseMode":"lastNode","options":{}},"type":"n8n-nodes-base.formTrigger","typeVersion":2.2,"position":[-40,80],"id":"62833454-8368-413d-bfa6-e208e53ec649","name":"On form submission","webhookId":"286e55a8-367e-496f-8e5f-de7841dc388d","disabled":true},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const client_name = $json.body.name ?   $json.body.name.trim() : null\nconst client_email = $json.body.email ? $json.body.email.trim() : null\nconst company_name = $json.body.companyName ? $json.body.companyName.trim() : null\nlet website_url = $json.body.website ? $json.body.website.trim() : null\n\n// DATA VALIDATION\nif(!client_name || !client_email || !company_name || !website_url ){\n  return {error: 'All fields are required'}\n}\n\nfunction isValidEmail(email) {\n    const regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n    return regex.test(email);\n}\n\nconst is_email_valid = isValidEmail(client_email)\nif(!is_email_valid){\n  return {error: \"Please provide a valid email address\"}\n}\n\n\nfunction isValidURL(url) {\n    // Regex for valid URL format including the protocol (http/https), domain, and optional path\n    const regex = /^(https?:\\/\\/)?([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}(\\/[^\\s]*)?$/;\n    return regex.test(url);\n}\n\n// Check if the website URL includes protocol, if not, prepend https://\nif (!/^https?:\\/\\//i.test(website_url)) {\n    website_url = \"https://\" + website_url;\n}\n\nconst is_url_valid = isValidURL(website_url);\nif (!is_url_valid) {\n  return { error: \"Website URL is not valid.\" };\n}\n// ----------- EXTRACTING DOMAIN -------------------\nfunction extractDomain(url) {\n    try {\n        if (!url) return null; // Handle empty input\n\n        url = url.trim(); // Remove leading and trailing white spaces\n\n        // Ensure the URL has a protocol; if not, prepend \"https://\"\n        if (!/^https?:\\/\\//i.test(url)) {\n            url = \"https://\" + url;\n        }\n\n        // Regular expression to extract domain from URL\n        let domainMatch = url.match(/^https?:\\/\\/(www\\.)?([^\\/:]+)/i);\n        \n        if (domainMatch && domainMatch[2]) {\n            return domainMatch[2].trim(); // Extracts domain and removes extra spaces\n        } else {\n            throw new Error(\"Invalid URL format\");\n        }\n    } catch (error) {\n        console.error(\"Invalid URL:\", url, error);\n        return null;\n    }\n}\n\n// ---------------- EXTRACTING ROOT DOMAIN ---------------------\nfunction extractRootDomain(url) {\n    let domain = extractDomain(url);\n    if (!domain) return null;\n\n    domain = domain.trim(); // Remove any spaces from the extracted domain\n\n    // Split domain by dots\n    let domainParts = domain.split('.');\n\n    // If it has multiple parts (e.g., sub.example.co.uk), take the second-to-last part\n    if (domainParts.length > 2) {\n        return domainParts[domainParts.length - 2].trim();\n    }\n\n    // If it's a standard domain (e.g., example.com), return the first part\n    return domainParts[0].trim();\n}\n\n// ------------ FORMATTING COMPANY NAME ------------------\nfunction toTitleCase(str) {\n    if (!str) return \"\"; // Handle empty input\n\n    return str\n        .trim() // Remove leading and trailing white spaces\n        .toLowerCase()\n        .replace(/\\b\\w/g, char => char.toUpperCase());\n}\n\n// ------------ CLEAN AND PROCESS JSON INPUT ---------------\nconst websiteURL = $json.body.website;\nconst companyName = $json.body.companyName;\n\nconst domain = extractDomain(websiteURL);\nconst root_domain = extractRootDomain(websiteURL);\nconst formatted_company_name = toTitleCase(companyName);\nconst formatted_name = toTitleCase(client_name)\nreturn {\n    email: client_email,\n    name: formatted_name,\n    domain: domain,\n    root_domain: root_domain,\n    company_name: formatted_company_name,\n    slack_channel_name: `${root_domain}-prospect-feed`\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[180,-40],"id":"0fe1e904-1609-4443-af9d-366b7796df16","name":"Formatting Form response"},{"parameters":{"tableId":"signup-form","fieldsUi":{"fieldValues":[{"fieldId":"company_name","fieldValue":"={{ $('Formatting Form response').item.json.company_name }}"},{"fieldId":"company_domain","fieldValue":"={{ $('Formatting Form response').item.json.domain }}"},{"fieldId":"subscription","fieldValue":"Free"},{"fieldId":"slack_channel_name","fieldValue":"={{ $('Formatting Form response').item.json.slack_channel_name }}"},{"fieldId":"email","fieldValue":"={{ $('Formatting Form response').item.json.email }}"},{"fieldId":"name","fieldValue":"={{ $('Formatting Form response').item.json.name }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[1020,80],"id":"3a02bdcf-3469-4308-b14f-96c91b309107","name":"Adding company to the database","notesInFlow":true,"credentials":{"supabaseApi":{"id":"AZhuxf9jkjUKSF2O","name":"searchactions.com -  digitalsandwich.agency - Prospect Feed appl"}}},{"parameters":{"authentication":"oAuth2","resource":"channel","channelId":"={{$('Formatting Form response').item.json.root_domain}}-prospect-feed"},"type":"n8n-nodes-base.slack","typeVersion":2.3,"position":[1480,20],"id":"11f8b96e-bf5e-4fd8-9604-576021d8c3b8","name":"Creating Slack Channel","webhookId":"b600603c-3f76-4e82-ac6f-09e74c91caeb","notesInFlow":true,"credentials":{"slackOAuth2Api":{"id":"PPnwMaC7LkBl1xoD","name":"searchactions.com: digitalsandwich.agency  - Prospect Feed"}}},{"parameters":{"content":"# Sign Up Form","height":420,"width":2300,"color":4},"type":"n8n-nodes-base.stickyNote","position":[-120,-180],"typeVersion":1,"id":"1c46add5-2f5e-407e-b79e-8e9b3725aba7","name":"Sticky Note"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"\nconst input = $input.item.json;\n\nconst user_info = input.user_info\nconst company_info = input.company_info\nconst technical_data = input.technical_data\nconst upcoming_meeting_data = input?.upcoming_meeting_data \n\nfunction extractDomain(url) {\n    try {\n        if (!url) return null; \n        url = url.trim(); \n        if (!/^https?:\\/\\//i.test(url)) {\n            url = \"https://\" + url;\n        }\n\n        \n        let domainMatch = url.match(/^https?:\\/\\/(www\\.)?([^\\/:]+)/i);\n  \n        if (domainMatch && domainMatch[2]) {\n            return domainMatch[2].trim(); \n        } else {\n            throw new Error(\"Invalid URL format\");\n        }\n    } catch (error) {\n        console.error(\"Invalid URL:\", url, error);\n        return null;\n    }\n}\n\n\nconst page_visited_domain  = extractDomain(technical_data.page_visited_url)\n\nconst formatted_data = {\n user_info:{\n    \"first_name\" : user_info.first_name || \"\",\n    \"last_name\" : user_info.last_name || \"\" ,\n    \"role\": user_info.role || \"\",\n    \"primary_email\" : user_info.primary_email || \"\",\n    \"personal_emails\" : user_info.personal_emails || [],\n    \"work_emails\" : user_info.work_emails || [],\n    \"phone_numbers\": user_info.phone_numbers || [],\n    \"social_urls\":{\n      \"linked_in\" :user_info.social_urls.linked_in || \"\",\n      \"facebook\": user_info.social_urls.facebook || \"\",\n      \"twitter\" : user_info.social_urls.twitter || \"\",\n      \"git_hub\": user_info.social_urls.git_hub || \"\",\n      \"blog\": user_info.social_urls.blog || \"\",\n      \"stackoverflow\": user_info.social_urls.stackoverflow || \"\",\n      \"pitchbook\": user_info.social_urls.pitchbook || \"\",\n      \"monster\": user_info.social_urls.monster || \"\",\n      \"crunchbase\": user_info.social_urls.crunchbase || \"\",\n      \"angellist\": user_info.social_urls.angellist || \"\",\n      \"indeed\": user_info.social_urls.indeed || \"\",\n      \"glassdoor\": user_info.social_urls.glassdoor || \"\",\n    },\n    \"location\":{\n      \"city\": user_info.location.city || \"\",\n      \"state\": user_info.location.state || \"\",\n      \"country\": user_info.location.country || \"\",\n      \"address\": user_info.location.address || \"\",\n      \"zip\": user_info.location.zip || \"\"\n    },\n },\n company_info:{\n   \"name\": company_info.name || \"\",\n   \"size\": company_info.size || \"\",\n   \"revenue\": company_info.revenue || \"\",\n   \"domain\": company_info.domain || \"\",\n   \"industry\": company_info.industry || \"\",\n   \"specialities\": [],\n   \"social_urls\":{\n     \"linked_in\": company_info.social_urls.linked_in || \"\",\n     \"facebook\" : company_info.social_urls.facebook || \"\",\n     \"twitter\": company_info.social_urls.twitter || \"\",\n     \"instagram\": company_info.social_urls.instagram || \"\",\n     \"blog\": company_info.social_urls.blog || \"\",\n     \"stackoverflow\": company_info.social_urls.stackoverflow || \"\",\n     \"pitchbook\": company_info.social_urls.pitchbook || \"\",\n     \"monster\": company_info.social_urls.monster || \"\",\n     \"crunchbase\": company_info.social_urls.crunchbase || \"\",\n     \"angellist\": company_info.social_urls.angellist || \"\",\n     \"indeed\": company_info.social_urls.indeed || \"\",\n     \"glassdoor\": company_info.social_urls.glassdoor || \"\",\n   },\n   \"phone_numbers\": company_info.phone_numbers || [],\n   \"location\":{\n     \"city\" : company_info.location.city || \"\",\n     \"state\": company_info.location.state || \"\",\n     \"country\": company_info.location.country || \"\",\n     \"address\": company_info.location.address || \"\",\n     \"zip\": company_info.location.zip || \"\",\n    }\n },\n  technical_data:{\n    \"page_visited_title\": technical_data.page_visited_title || \"\",\n    \"page_visited_url\": technical_data.page_visited_url || \"\",\n    \"page_visited_domain\": page_visited_domain,\n    \"utmCampaign\":technical_data.utmCampaign || \"\",\n    \"utmContent\": technical_data.utmContent || \"\",\n    \"utmMedium\": technical_data.utmMedium || \"\",\n    \"utmSource\": technical_data.utmSource || \"\",\n    \"utmTerm\":technical_data.utmTerm || \"\",\n    \"vvid\": technical_data.vvid || \"\",\n    \"hem\": technical_data.hem || \"\"\n  }\n}\nreturn formatted_data;"},"id":"6d2a224a-6fff-4f11-92d2-91ded751a5d9","name":"Summarizing","type":"n8n-nodes-base.code","typeVersion":2,"position":[1080,540]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const input = $input.item.json.body\nconst company = input.type === \"company.visited\"\n\nlet city = \"\"\nlet state = \"\"\n\nif(input.location){\n  const split = input.location.split(\",\")\n  city = split[0]\n  state = split[1]\n}\nconst formatted = {\n  user_info:{\n    \"first_name\": input.firstName || \"\",\n    \"last_name\": input.lastName || \"\",\n    \"primary_email\": input.email || input.externalId ||  \"\",\n    \"personal_emails\":input.email ||  input.externalId ? [input.email || input.externalId] :   [],\n    \"social_urls\":{\n      \"linked_in\": !company ? input.linkedinUrl ||  \"\" : \"\"\n    },\n    \"location\":{\n      \"city\": !company ? city || \"\" :\"\",\n      \"state\": !company ? state || \"\" : \"\",\n    },\n  },\n  company_info:{\n    \"name\":  input.company || \"\",\n    \"domain\": input.companyDomain || \"\",\n    \"social_urls\":{\n      \"linked_in\": company ? input.linkedinUrl ||  \"\" : \"\"\n    },\n    \"location\":{\n      \"city\": company ? city || \"\" :\"\",\n      \"state\": company ? state || \"\" : \"\",\n    }\n  },\n  technical_data:{\n    \"page_visited_title\": input.pageTitle || \"\",\n    \"page_visited_url\": input.pageUrl || \"\",\n    \"utmCampaign\": input.utmCampaign || \"\",\n    \"utmContent\": input.utmContent || \"\",\n    \"utmMedium\": input.utmMedium || \"\",\n    \"utmSource\": input.utmSource || \"\",\n    \"utmTerm\": input.utmTerm || \"\",\n    \"vvid\": input.vvid || \"\",\n    \"hem\": input.hem\n  }\n \n}\n\n\nreturn formatted;"},"id":"d1135719-5d01-4397-95b3-878b082d20f8","name":"Vector data normalization","type":"n8n-nodes-base.code","typeVersion":2,"position":[420,760],"disabled":true},{"parameters":{"httpMethod":"POST","path":"digital-sandwich/prospectfeed","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-20,760],"id":"2c530329-0f8e-4dcc-8db8-8dbf2af70311","name":"Vector","webhookId":"e9da270b-8a1c-4544-8c11-43ba44a4bd9e","disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"32ca7758-53ee-4e47-b7ed-04775984fa96","leftValue":"={{ $json.technical_data.page_visited_url }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}},{"id":"8c9aa068-8a8d-43a1-bcc1-7ab58dfceb54","leftValue":"={{ $json.technical_data.page_visited_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[760,560],"id":"fd41b871-61bd-430c-97fd-71374ecfbc63","name":"Page Visited URL present"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const formatted = {\n  \"user_info\":{\n    \"first_name\": \"Cameron\" ,\n    \"last_name\": \"Fulton\",\n    \"role\":\"\",\n    \"primary_email\": \"\",\n    \"personal_emails\":  [],\n    \"work_emails\": [],\n    \"phone_numbers\":[],\n    \"social_urls\":{\n     \"linked_in\": \"\",\n    },\n    \"location\":{\n      \"city\": \"\" ,\n      \"state\":\"\",\n      \"zip\":\"\"\n    },\n  },\n  \"company_info\":{\n    name: \"Search Actions\",\n    size: \"\",\n    revenue: \"\",\n    domain: \"https://www.searchactions.com/\",\n    industry: \"\",\n    social_urls:{\n     linked_in: \"https://www.linkedin.com/company/searchactions\",\n     facebook: \"\",\n     twitter: \"\",\n     instagram: \"\",\n    },\n    phone_numbers:[],\n    \"location\":{\n      \"city\":\"\",\n      \"state\":\"\",\n      \"country\":\"\",\n      \"address\":\"\",\n      \"zip\":\"\",\n    }\n  },\n   technical_data:{\n    \"page_visited_url\": \"https://www.searchactions.com/\" || \"\",\n    \"utmCampaign\": \"Winter Campaign\" || \"\",\n    \"utmContent\": \"product_launch\" || \"\",\n    \"utmMedium\": \"email\" || \"\",\n    \"utmSource\": \"newsletter\" || \"\",\n    \"utmTerm\": \"new_product\" || \"\",\n    \"vvid\": \"1234abcd\" || \"\",\n    \"hem\": \"heme123\"\n  }\n}\nreturn formatted\n"},"id":"8927fb00-40e0-4737-bf2e-a0143b28c5ab","name":"Mockup Data","type":"n8n-nodes-base.code","typeVersion":2,"position":[420,560]},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-20,560],"id":"8a20e4e9-4a2a-4f71-ad3b-a395a0a61a61","name":"Manually Testing the workflow","disabled":true},{"parameters":{"operation":"get","tableId":"signup-form","filters":{"conditions":[{"keyName":"company_domain","keyValue":"={{ $json.technical_data.page_visited_domain }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[1300,540],"id":"97b07e5b-970f-4274-9ecc-cc33da547ecb","name":"Getting Client","notesInFlow":true,"credentials":{"supabaseApi":{"id":"AZhuxf9jkjUKSF2O","name":"searchactions.com -  digitalsandwich.agency - Prospect Feed appl"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"7c041c17-bded-4098-a09a-d54242add2a0","leftValue":"={{ $json.id }}","rightValue":"","operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1500,540],"id":"5d0f1b0e-1cd2-4f1a-820f-f201cf3c066d","name":"Client Exists"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"fdb9f259-41a3-4afb-ac4b-0f71d534126f","leftValue":"={{ $json.subscription }}","rightValue":"Free","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1820,520],"id":"6144ded2-7c29-49e0-9878-3c796100ab10","name":"Is client on a free plan ?"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"9679f1e0-756a-40c5-8c66-c89c67190e98","leftValue":"={{ $json.wisitors_identified }}","rightValue":200,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2120,420],"id":"971cdac3-2496-46c9-b2e6-831832881b1e","name":"Did they exceed the limit ?"},{"parameters":{"model":"claude-3-5-sonnet-20241022","options":{}},"id":"5b1cebaa-2157-4552-876a-553316d48758","name":"Anthropic Chat Model","type":"@n8n/n8n-nodes-langchain.lmChatAnthropic","typeVersion":1.2,"position":[2680,780],"credentials":{"anthropicApi":{"id":"TAgU99J0SeGyXIyU","name":"searchactions.com : digitalsandwich.agency - Website Visitor Enr"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const input = $('Summarizing').first().json\n\nconst message = `\n${JSON.stringify(input)}\n-- YOUR TASK --\nFill out missing information about the company and the user\n(User that visited Client's website and their Company).\nUse the data that exists to help you out in your task.\n\nThe most important data that we need are:\n- Users First Name and Last Name\n- Users Primary Email (This is important to find)\n- Users Linked IN profile URL \n- Company Linked IN profile URL\n- Company Name and Domain\n- Users Profile Picture URL (Find on Linked in or Scraping the Web)\n\n-- TASK EXAMPLE -- \nIf there is for example Company name provided, use that to search \nadditional information about that Company on the internet (Size, Revenue, Domain, etc.).\nCompany domain can be also helpful: ${input.company_info.domain}.\n\n\n-- INFORMATION ABOUT PROVIDED OBJECT KEY'S --- \n- User info Object\nfirst_name (First Name of the User)\nlast_name (Last Name of the User) \nrole (Users role / title in the Company)\nprimary_email (Users primary email) \npersonal_emails (Array of users personal emails)\nwork_emails (Array of users work emails)\nphone_numbers (Array of Users phone numbers )\nsocial_urls (Object providing Social URL's of the User)\nlocation (Object providing users Location)\n- Company Info Object\nname (Name of the Company)\nsize (Company's number of employees)\nrevenue (Company's revenue)\ndomain (Domain of companies Website)\nindustry (The industry that the Company is in)\nsocial_urls (Object of Company's social URL's )\nphone_numbers (Array of Company's phone numbers)\nlocation (Object providing Company's location)\n\n\n--- RULES ---\na) IMPORTANT! Do not fill any information about technical_data and upcoming_meeting_data but include them in your response.\nb) Try to have as little empty values for the key's inside the object.\n`\n\n\nreturn {message:message};\n//.replace(/\\s/g, '')"},"id":"1a8e11a2-67d1-487d-9a50-d3736f49b82f","name":"Anhtropic Query","type":"n8n-nodes-base.code","typeVersion":2,"position":[2500,540]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const user_info = $json?.output?.user_info  || null\nconst company_info = $json?.output?.company_info  || null\nconst technical_data = $json?.output?.technical_data  || null\nconst fallback = $('Summarizing').first().json\n\nlet prospect = {}\n\n\n\nif(user_info && company_info && technical_data){\n  prospect =  {\n  user_info:user_info,\n  company_info:company_info,\n  technical_data: technical_data\n}\n}else{\n  prospect = {\n  user_info:fallback.user_info,\n  company_info:fallback.company_info,\n  technical_data:fallback.technical_data\n }\n}\n\n\nreturn prospect\n\n"},"id":"aa1d0bec-fd1f-482b-932c-1253a2909a36","name":"Anthropic Response","type":"n8n-nodes-base.code","typeVersion":2,"position":[3040,540]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const formatted = {\n  email: $json?.email || \"\",\n  status: $json?.status || \"\",\n  is_domain_catch_all: $json?.is_domain_catch_all ? \"true\" :\"false\" ,\n  mx_record: $json?.mx_record || \"\" ,\n  mx_provider: $json?.mx_provider || \"\",\n  mx_security_gateway:$json?.mx_security_gateway  ? \"true\" :\"false\" ,\n  company_name: $json?.company_name || \"\",\n  company_industry:$json?.company_industry ||\"\" ,\n  company_size:$json?.company_size || \"\" ,\n  company_founded:$json?.company_founded || \"\" ,\n  company_location:$json?.company_location || {} ,\n  company_linkedin_url:$json?.company_linkedin_url || \"\" ,\n  company_facebook_url: $json?.company_facebook_url || \"\",\n  company_twitter_url: $json?.company_twitter_url || \"\",\n  company_type: $json?.company_type ||\"\"\n};\n\nreturn formatted;"},"id":"eeb82542-cd04-4c91-84f7-3e44af611aba","name":"Combining Email data","type":"n8n-nodes-base.code","typeVersion":2,"position":[4780,540]},{"parameters":{"promptType":"define","text":"={{ $json.message }}","hasOutputParser":true,"options":{}},"id":"46bfb0f6-b45c-4960-b085-77d961224ac2","name":"Finding Missing data Agent","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[2700,540],"retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"jsonSchemaExample":" {\n \"user_info\":{\n    \"first_name\" : \"\",\n    \"last_name\" : \"\" ,\n    \"role\":  \"\",\n    \"primary_email\" : \"\",\n    \"personal_emails\" : [\"\"],\n    \"work_emails\" : [\"\",\"\"],\n    \"phone_numbers\":  [\"38162899895\"],\n   \"profile_pick\":\"\",\n    \"social_urls\":{\n      \"linkedin\":\"\",\n      \"facebook\":\"\",\n      \"twitter\" :\"\",\n      \"git_hub\":\"\",\n      \"blog\": \"\",\n      \"stackoverflow\": \"\",\n      \"pitchbook\":  \"\",\n      \"monster\":  \"\",\n      \"crunchbase\": \"\",\n      \"angellist\": \"\",\n      \"indeed\": \"\",\n      \"glassdoor\": \"\"\n    },\n    \"location\":{\n      \"city\": \"\",\n      \"state\": \"\",\n      \"country\": \"\",\n      \"address\":  \"\",\n      \"zip\": \"\"\n    }\n },\n \"company_info\":{\n   \"name\": \"\",\n   \"size\": \"\",\n   \"revenue\": \"\",\n   \"domain\": \"\",\n   \"industry\": \"\",\n   \"specialities\": [\"38162899895\"],\n   \"social_urls\":{\n     \"linkedin\": \"\",\n     \"facebook\" :  \"\",\n     \"twitter\": \"\",\n     \"instagram\": \"\",\n     \"blog\": \"\",\n     \"stackoverflow\": \"\",\n     \"pitchbook\":\"\",\n     \"monster\": \"\",\n     \"crunchbase\": \"\",\n     \"angellist\": \"\",\n     \"indeed\": \"\",\n     \"glassdoor\": \"\"\n   },\n   \"phone_numbers\": [\"38162899895\"],\n   \"location\":{\n     \"city\" :\"\",\n     \"state\": \"\",\n     \"country\": \"\",\n     \"address\":\"\",\n     \"zip\": \"\"\n    }\n },\n  \"technical_data\":{\n    \"page_visited_title\": \"\",\n    \"page_visited_domain\":\"\",\n    \"page_visited_url\": \"\",\n    \"utmCampaign\":\"\",\n    \"utmContent\":\"\",\n    \"utmMedium\": \"\",\n    \"utmSource\": \"\",\n    \"utmTerm\": \"\",\n    \"vvid\": \"\",\n    \"hem\": \"\"\n  }\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[2920,780],"id":"07da486b-3c03-4a73-b1e2-c575c09c9e1b","name":"Finding Missing Data - Parser"},{"parameters":{"toolDescription":"Find missing email using Leadmagic","method":"POST","url":"https://api.leadmagic.io/email-finder","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"parametersBody":{"values":[{"name":"first_name"},{"name":"last_name"},{"name":"domain"},{"name":"company_name"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[3580,860],"id":"2116ef1a-9706-4ee9-8d3c-6ffa9d43f47f","name":"Lead magic Email Finder","notesInFlow":true,"credentials":{"httpHeaderAuth":{"id":"DStPfj1QdkdAfw2x","name":"searchactions.com (Lead Magic v2)"}}},{"parameters":{"toolDescription":"Finding missing email using Findymail ","method":"POST","url":"https://app.findymail.com/api/search/name","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"parametersBody":{"values":[{"name":"name"},{"name":"domain"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[3720,860],"id":"d5679446-c5d8-442a-b49b-add8cc5b8692","name":"Findymail Email Finder 1","notesInFlow":true,"credentials":{"httpHeaderAuth":{"id":"NGAAmruIOet9fCiY","name":"searchactions.com Findymail"}}},{"parameters":{"toolDescription":"Finding missing email using Findymail with LinkedIN Profile URL","method":"POST","url":"https://app.findymail.com/api/search/linkedin","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"parametersBody":{"values":[{"name":"linkedin_url"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[3880,860],"id":"17df2025-4204-449d-b510-4e0797b1bfa7","name":"Findymail Email Finder 2","notesInFlow":true,"credentials":{"httpHeaderAuth":{"id":"NGAAmruIOet9fCiY","name":"searchactions.com Findymail"}}},{"parameters":{"toolDescription":"Find missing email using Prospeo with Company's domain,website or Company name.","method":"POST","url":"https://api.prospeo.io/email-finder","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"parametersHeaders":{"values":[{"name":"Content-Type","valueProvider":"fieldValue","value":"application/json"}]},"sendBody":true,"parametersBody":{"values":[{"name":"company"},{"name":"first_name","valueProvider":"modelOptional"},{"name":"last_name","valueProvider":"modelOptional"}]},"placeholderDefinitions":{"values":[{"name":"company","description":"The company domain, website, or name. Using a domain or website is recommended for better accuracy."}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[4180,860],"id":"f67a23bd-7215-4231-9158-d4149c0832d8","name":"Prospeo Email Finder","notesInFlow":true,"credentials":{"httpHeaderAuth":{"id":"sKQF5cdfDTi5Dovq","name":"searchactions.com Prospeo"}}},{"parameters":{"toolDescription":"Validate Contact email using LeadMagic ","method":"POST","url":"https://api.leadmagic.io/email-validate","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"parametersBody":{"values":[{"name":"email"},{"name":"first_name"},{"name":"last_name"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[4320,860],"id":"b5cdba57-a0c9-4e9e-ab21-2072d5825b47","name":"LeadMagic Email Validation","notesInFlow":true,"credentials":{"httpHeaderAuth":{"id":"DStPfj1QdkdAfw2x","name":"searchactions.com (Lead Magic v2)"}}},{"parameters":{"fieldToSplitOut":"output","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[4360,540],"id":"c9450c4e-5bda-446d-bb86-c5892a51d547","name":"Split Out"},{"parameters":{"promptType":"define","text":"=--- DATA TO USE IN THE TASKS---\n{{ JSON.stringify($json)}}\n--- TASKS --- \nTry and find primary email for the user using following tools\na) LeadMagic\nb) Findymail\nc) Prospeo \n\nAbove tools should be used as an waterfall effect, if LeadMagic couldn't find the email we try Findymail, if Findymail couldn't find the email we go for Prospeo etc. (IMPORTANT, use all available tools)\n\nFinal step is to validated the found email using LeadMagic validation tool.\n\nThis additional information can be found when email is found using LeadMagic:\ncompany_name\ncompany_industry\ncompany_size\ncompany_founded\ncompany_location\ncompany_linkedin_url\ncompany_facebook_url\ncompany_twitter_url\ncompany_type\n\nIf they are not found just add empty strings as the value's. ","hasOutputParser":true,"options":{"systemMessage":"As an AI agent, you are designed to optimize the analysis and understanding of users or companies visiting a website. Your functionality includes enhancing the data by integrating added insights extracted from platforms like Opensend, RB2B, and Vector. Furthermore, you are equipped to sanitize and normalize output data to maintain its integrity and consistency. By conducting thorough web research, you can identify and fill in any gaps in the data, providing a comprehensive outlook of all website visitors. Processing begins once the initial data is provided."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[3900,540],"id":"af22093f-a332-4561-8bf0-16487fc62e81","name":"Email Finder Agent","retryOnFail":true,"maxTries":5,"waitBetweenTries":2000},{"parameters":{"model":"gpt-4o","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[3400,860],"id":"95650743-32ab-4afb-9d8c-e0b3e3642172","name":"OpenAI Chat Model - Email finder","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"jsonSchemaExample":"[{\n  \"email\": \"\",\n  \"status\": \"\",\n  \"is_domain_catch_all\": \"\",\n  \"mx_record\": \"\" ,\n  \"mx_provider\":  \"\",\n  \"mx_security_gateway\": \"\" ,\n  \"company_name\": \"\",\n  \"company_industry\":\"\" ,\n  \"company_size\": \"\" ,\n  \"company_founded\":\"\" ,\n  \"company_location\":{} ,\n  \"company_linkedin_url\":\"\" ,\n  \"company_facebook_url\": \"\",\n  \"company_twitter_url\": \"\",\n  \"company_type\": \"\"\n}]"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[4520,860],"id":"ffd1931a-bbbb-4321-b519-04d4797eb6b4","name":"Email Finder Parser"},{"parameters":{"toolDescription":"Finding missing email using Findymail if Email domain and Users role in the company are present","method":"POST","url":"https://app.findymail.com/api/search/domain","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"parametersBody":{"values":[{"name":"domain"},{"name":"roles"}]},"placeholderDefinitions":{"values":[{"name":"domain","description":"Company domain"},{"name":"roles","description":"Job Role User has"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[4020,860],"id":"bcb92cc2-e836-450a-8922-d88ba20d1176","name":"Findymail Email Finder 3","notesInFlow":true,"credentials":{"httpHeaderAuth":{"id":"NGAAmruIOet9fCiY","name":"searchactions.com Findymail"}}},{"parameters":{"content":"# Profile Search\n","height":662.0009562366216,"width":474.6057449096941},"id":"22812428-aed5-4520-a12c-66c1e38b18b9","name":"Sticky Note20","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[6420,400]},{"parameters":{"content":"# Mobile Finder\n","height":668.0153059386458,"width":531.407552793027},"id":"a4f1ae9d-f4ef-4543-b0c2-46244f097547","name":"Sticky Note21","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[6920,400]},{"parameters":{"content":"# Company Search","height":665.6974451120005,"width":616.2127612181199},"id":"a87fe2cd-116d-4b67-a974-bb04fbe8a4f8","name":"Sticky Note22","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[7480,400]},{"parameters":{"content":"# Finding Linked In","height":662.0009562366216,"width":744.3058102443995},"id":"bcf5d4bc-7d2d-451e-bb84-61da1517245f","name":"Sticky Note23","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[5640,400]},{"parameters":{"content":"# Combining enriched data","height":666.3611607590979,"width":1104.1482358361466},"id":"5d34d342-c6d9-4eb7-bd9a-98e47b785f53","name":"Sticky Note24","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[8120,400]},{"parameters":{"content":"# Finding most probable data","height":666,"width":846},"id":"a3df8687-d1d5-42ea-a8ad-a3e7135b613e","name":"Sticky Note25","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[9240,400]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"let query = {}\nconst anthropic_response = $('Anthropic Response')?.first()?.json\nconst email_data = $('Combining Email data')?.first()?.json\n\nconst personal_email = anthropic_response?.user_info?.primary_email || anthropic_response?.user_info?.personal_emails[0] || email_data?.email || null\n\nif(personal_email){\n  query.personal_email = personal_email\n}\n\nconst work_email = anthropic_response?.user_info?.work_emails[0]\nif(work_email){\n  query.work_email = work_email\n}\n\nreturn {query: query};"},"id":"eaa34aa1-e931-454b-a63e-64186fed4a84","name":"Finding Linked In query","type":"n8n-nodes-base.code","typeVersion":2,"position":[5880,800]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8f76ed7b-d138-4cb3-8222-41eed0b74261","leftValue":"={{ $('Anthropic Response').item.json.user_info.social_urls.linkedin }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"99313796-efb3-4947-a47d-450ec44dfd11","leftValue":"={{ $('Combining Email data').item.json.email }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"or"},"options":{}},"id":"6c07d719-c69d-44c4-9070-0eb65dab8b1d","name":"Is personal LinkedIn present?","type":"n8n-nodes-base.if","typeVersion":2.2,"position":[5720,540]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b6eb8329-6460-444c-90e8-a9cdf8dcde11","leftValue":"={{ $('Anthropic Response').item.json.user_info.social_urls.linkedin }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"3d756f01-b5b7-4035-9283-84d85f2d0eeb","leftValue":"={{ $('Anthropic Response').item.json.company_info.social_urls.linkedin }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"bcedea83-7c76-49c1-a177-e2fffebc8bf3","leftValue":"={{ $('Combining Email data').item.json.company_linkedin_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"or"},"options":{}},"id":"e486bcbf-e77a-4a5c-9c37-80882dd5bd65","name":"Is personal OR company LinkedIn present?","type":"n8n-nodes-base.if","typeVersion":2.2,"position":[6240,580]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"\nconst input = $input.item.json;\nlet query= {}\n\nconst email_data =  $('Combining Email data').first().json\n\nconst linked_in = $('Anthropic Response')?.first()?.json?.user_info?.social_urls?.linked_in ||$('Anthropic Response')?.first()?.json?.company_info?.social_urls?.linked_in || email_data?.company_linkedin_url || email_data?.company_linkedin_url || input?.company_linkedin_url || \"\"\n\n\n// const personal_email = $('Anthropic Response').first()?.json?.user_info?.primary_email || $('Anthropic Response').first()?.json?.user_info?.personal_emails[0] || $('Email Validation').first()?.json?.email || $('Email Finder').first().json?.email\n\nconst personal_email = email_data?.email || $('Anthropic Response').first()?.json?.user_info?.primary_email || $('Anthropic Response').first()?.json?.user_info?.personal_emails[0] \n\n\nconst work_email = $('Anthropic Response')?.first()?.json?.user_info?.work_emails[0]\n\nif(linked_in){\n  query.profile_url = linked_in\n}\nif(personal_email){\n  query.personal_email = personal_email\n}\nif(work_email){\n  query.work_email = work_email\n}\n\nreturn {query: query};"},"id":"d2720038-85bc-4810-a6bb-fbc09b2b3680","name":"Mobile Finder query","type":"n8n-nodes-base.code","typeVersion":2,"position":[7000,700]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"\nconst input = $input.item.json\nlet profile_search = null\ntry{\n  profile_search = $('Profile Search').first().json\n}catch(error){}\n\n\nlet query = {}\nconst linked_in =$('Anthropic Response').first().json.user_info.social_urls.linked_in ||profile_search?.profileUrl\n\nconst company_domain = $('Anthropic Response').first().json.company_info.domain || profile_search?.company_website\n\nconst company_name = $('Anthropic Response').first().json?.company_info?.name || $('Combining Email Data').first().json?.company_name || profile_search?.company_name\n\n\nif(linked_in){\n  query.profile_url = linked_in\n}\nif(company_domain){\n  query.company_domain = company_domain\n}\nif(company_name){\n  query.company_name = company_name\n}\nreturn {query:query};"},"id":"2e0b2aa1-326e-4b50-9f3e-c5cb13f9f656","name":"Company Search query","type":"n8n-nodes-base.code","typeVersion":2,"position":[7540,700]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"41f0e71c-482c-403d-bacf-426677d88292","leftValue":"={{ $json.query }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"or"},"options":{}},"id":"3e468b8c-a8c9-4821-80f2-306e44e6bbc7","name":"Do we have Linked in, company domain or company name ?","type":"n8n-nodes-base.if","typeVersion":2.2,"position":[7760,700]},{"parameters":{"method":"POST","url":"https://api.leadmagic.io/company-search","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"},{"name":"content-type","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.query }}","options":{}},"id":"4ce70371-7386-42a5-b588-e5e150d028c2","name":"Company Search","type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[7980,520],"retryOnFail":false,"notesInFlow":true,"alwaysOutputData":true,"credentials":{"httpHeaderAuth":{"id":"DStPfj1QdkdAfw2x","name":"searchactions.com (Lead Magic v2)"}},"onError":"continueRegularOutput","notes":"Lead Magic"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const structured_object = {\n  \"user_info\":$('Summarizing User Info').first().json.user_info,\n  \"company_info\": $('Summarizing Company Info').first().json.company_info,\n  \"technical_data\": $json.structured_object\n}\n\nreturn structured_object;"},"id":"4684d2c7-0d18-4e5b-b323-048dc34071d0","name":"Combining Company - User - Technical Data","type":"n8n-nodes-base.code","typeVersion":2,"position":[9040,720]},{"parameters":{"method":"POST","url":"https://api.leadmagic.io/b2b-profile","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"},{"name":"content-type","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.query }}","options":{}},"id":"0443c682-d823-45df-b7c4-b2424f530543","name":"Finding Linked In2","type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[6100,800],"retryOnFail":true,"notesInFlow":true,"credentials":{"httpHeaderAuth":{"id":"DStPfj1QdkdAfw2x","name":"searchactions.com (Lead Magic v2)"}},"onError":"continueRegularOutput","notes":"Lead Magic"},{"parameters":{"method":"POST","url":" https://api.leadmagic.io/profile-search","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"},{"name":"content-type","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"profile_url\": \"{{ $('Anthropic Response').item.json.user_info.social_urls.linkedin || $('Anthropic Response').item.json.company_info.social_urls.linkedin || $('Combining Email data').item.json.company_linkedin_url||$json.profile_url }}\"\n}","options":{}},"id":"19ee4b82-7481-4b52-a08d-2e2e20a6aa2e","name":"Profile Search","type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[6600,520],"retryOnFail":true,"notesInFlow":true,"maxTries":5,"credentials":{"httpHeaderAuth":{"id":"DStPfj1QdkdAfw2x","name":"searchactions.com (Lead Magic v2)"}},"onError":"continueRegularOutput","notes":"Lead Magic"},{"parameters":{"method":"POST","url":"https://api.leadmagic.io/mobile-finder","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"},{"name":"content-type","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.query }}","options":{}},"id":"68adf6a0-771b-48e3-bbca-04fdc07ab87f","name":"Mobile Finder","type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[7240,700],"retryOnFail":true,"notesInFlow":true,"credentials":{"httpHeaderAuth":{"id":"DStPfj1QdkdAfw2x","name":"searchactions.com (Lead Magic v2)"}},"onError":"continueRegularOutput","notes":"Lead Magic"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"let profile_search = null\ntry{\n  profile_search = $('Profile Search').first().json\n}catch(error){}\n// NAME\nconst names = []\n\nconst summarizing_name = $('Anthropic Response')?.first()?.json?.company_info?.name || null\nsummarizing_name && names.push(summarizing_name)\n\nconst email_data_name = $('Combining Email data')?.first()?.json?.company_name || null\nemail_data_name && names.push(email_data_name)\n\nconst profile_search_name = profile_search?.company_name || null\nprofile_search_name && names.push(profile_search_name)\n\nconst company_search_name = $('Company Search')?.first()?.json?.companyName || null\ncompany_search_name && names.push(company_search_name)\n\n// SIZE\nconst sizes = []\nconst summarizing_size = $('Anthropic Response')?.first()?.json?.company_info?.size || null\nsummarizing_size && sizes.push(summarizing_size)\n\nconst email_data_size = $('Combining Email data')?.first()?.json?.company_size || null\nemail_data_size && sizes.push(email_data_size)\n\nconst profile_search_size = profile_search?.company_size || null\nprofile_search_size && sizes.push(profile_search_size)\n\n\nconst company_search_size = $('Company Search')?.first()?.json?.employeeCount || null\ncompany_search_size && sizes.push(company_search_size)\nconst company_search_size_start = $('Company Search')?.first()?.json?.employeeCountRange?.start || null\nconst company_search_size_end = $('Company Search')?.first()?.json?.employeeCountRange?.end || null\n \nif(company_search_size_start || company_search_size_end){\n  let finalSize = ''\n  if(company_search_size_start){\n    finalSize = finalSize + `${company_search_size_start} -`\n  }\n  if(company_search_size_end){\n    finalSize = finalSize + company_search_size_end\n  }\n  sizes.push(finalSize)\n}\n// REVENUE\nconst revenues = []\n\nconst summarizing_revenue = $('Anthropic Response')?.first()?.json?.company_info?.revenue || null\nsummarizing_revenue && revenues.push(summarizing_revenue)\n// DOMAIN\nconst domains = []\n\nconst summarizing_domain = $('Anthropic Response')?.first()?.json?.company_info?.domain || null\nsummarizing_domain && domains.push(summarizing_domain)\n\nconst email_data_domain = $('Combining Email data')?.first()?.json?.domain || null\nemail_data_domain && domains.push(email_data_domain)\n\nconst profile_search_domain = profile_search?.company_website || null\nprofile_search_domain && domains.push(profile_search_domain)\n\nconst company_search_domain = $('Company Search')?.first()?.json?.websiteUrl || null\ncompany_search_domain && domains.push(company_search_domain)\n//INDUSTRY\nconst industries = []\n\nconst summarizing_industry = $('Anthropic Response')?.first()?.json?.company_info?.industry || null\nsummarizing_industry && industries.push(summarizing_industry)\n\nconst email_data_industry = $('Combining Email data')?.first()?.json?.company_industry || null\nemail_data_industry && industries.push(email_data_industry)\n\nconst profile_search_industry = profile_search?.company_industry || null\nprofile_search_industry && industries.push(profile_search_industry)\n\nconst company_search_industry = $('Company Search')?.first()?.json?.industry || null\ncompany_search_industry && industries.push(company_search_industry)\n// SPECIALITIES\nconst specialities = $('Company Search')?.first()?.json?.specialities || $('Anthropic Response')?.first()?.json?.company_info?.specialities || null\n// SOCIAL URLS\nlet social_urls_combined =   {\n      \"linked_in\": \"\",\n      \"facebook\": \"\",\n      \"twitter\" : \"\",\n      \"git_hub\": \"\",\n      \"blog\":  \"\",\n      \"stackoverflow\": \"\",\n      \"pitchbook\": \"\",\n      \"monster\": \"\",\n      \"crunchbase\": \"\",\n      \"angellist\": \"\",\n      \"indeed\": \"\",\n      \"glassdoor\": \"\"\n}\n // linked in\nconst combined_linked_ins  = []\nlet social_urls = $('Anthropic Response')?.first()?.json?.company_info?.social_urls \nsocial_urls.linked_in && combined_linked_ins.push(social_urls.linked_in)\n\nconst email_data_linked_in = $('Combining Email data')?.first()?.json?.company_linkedin_url\nemail_data_linked_in && combined_linked_ins.push(email_data_linked_in)\n\nconst profile_search_company_linkedin = profile_search?.company_linkedin_url\nprofile_search_company_linkedin && combined_linked_ins.push(profile_search_company_linkedin)\n\nconst website_search_linkedin = $('Company Search')?.first()?.json?.url\nwebsite_search_linkedin && combined_linked_ins.push(website_search_linkedin)\n\n\nsocial_urls_combined.linked_in = combined_linked_ins\n// facebook\nconst combined_facebook = []\nsocial_urls?.facebook && combined_facebook.push(social_urls.facebook)\n\nconst email_data_facebook  = $('Combining Email data')?.first()?.json?.company_facebook_url\nemail_data_facebook && combined_facebook.push(email_data_facebook)\n\nsocial_urls_combined.facebook = combined_facebook\n// twitter\nconst combined_twitter = []\nsocial_urls?.twitter && combined_twitter.push(social_urls.twitter)\n\nconst email_data_twitter = $('Combining Email data')?.first()?.json?.company_twitter_url\nemail_data_twitter && combined_twitter.push(email_data_twitter)\n\nsocial_urls_combined.twitter = combined_twitter\n\n\n//PHONE NUMBERS\nconst phone_numbers = $('Anthropic Response')?.first()?.json?.company_info?.phone_numbers\n\n//LOCATION\nconst locations = []\nconst summarizing_location = $('Anthropic Response')?.first()?.json?.company_info?.location\nlocations.push(summarizing_location)\n\nconst email_data_location = $('Combining Email data')?.first()?.json?.company_location\nif(email_data_location){\n  locations.push({\n     \"city\" :  email_data_location.locality || \"\",\n     \"state\": email_data_location.region || \"\",\n     \"country\":  email_data_location.country || \"\",\n     \"address\":  email_data_location.street_address || email_data_location.address_line_2 || \"\",\n     \"zip\": email_data_location.postal_code || \"\",\n  })\n}\n\nconst company_search_locations = $('Company Search')?.first()?.json?.locations\nif(company_search_locations && company_search_locations.length > 0 ){\n  company_search_locations.forEach(location =>{\n    locations.push({\n     \"city\" :  location?.city|| \"\",\n     \"state\":  location?.geographicArea || \"\",\n     \"country\":  location?.country || \"\",\n     \"address\":  location?.line1 || location?.line2 ? `${location?.line1} ${location?.line2}` : \"\",\n     \"zip\": location?.postalCode || \"\",\n    })\n  })\n}\n// COMPANY FOUNDED \nconst company_founded = []\nconst email_data_company_founded = $('Combining Email data')?.first()?.json?.company_founded\nemail_data_company_founded && company_founded.push(email_data_company_founded)\n\nconst company_data_founded_on_year = $('Company Search')?.first()?.json?.foundedOn?.year\ncompany_data_founded_on_year && company_founded.push(company_data_founded_on_year)\n\n// COMPANY TYPE\nconst company_types = []\nconst email_data_company_type = $('Combining Email data')?.first()?.json?.company_type\nemail_data_company_type && company_types.push(email_data_company_type)\n// COMPANY LOGO\nconst company_logo = $('Company Search')?.first()?.json?.logoResolutionResult || \"\"\n// COVER IMAGE\nconst cover_image = $('Company Search')?.first()?.json?.croppedCoverImage ? $('Company Search').first().json.croppedCoverImage : \"\"\n\n// SIMILAR ORGANIZATIONS\nconst similar_organizations = []\nconst company_data_similar_organizations = $('Company Search')?.first()?.json?.similarOrganizations\nif(company_data_similar_organizations &&company_data_similar_organizations.length >0 ){\n  company_data_similar_organizations.forEach(organization=>{\n    similar_organizations.push({\n      \"name\": organization?.name || \"\",\n      \"industry\": organization?.industry || \"\",\n      \"company_logo\": organization?.logoResolutionResult || \"\",\n      \"cover_image\": organization?.croppedCoverImage || \"\",\n      \"size\": organization?.employeeCountRange?.end || \"\",\n      \"locations\":[\n        {\n         \"city\" : organization?.headquarter?.city || \"\" ,\n         \"state\": organization?.headquarter?.geographicArea || \"\",\n         \"country\": organization?.headquarter?.country || \"\",\n         \"address\":  organization?.headquarter?.line1 || organization?.headquarter?.line2 ?`${organization?.headquarter?.line1 } ${organization?.headquarter?.line2}`: \"\" ,\n         \"zip\": organization?.headquarter?.postalCode || \"\",\n        }\n      ]\n    })\n  })\n\n}\n// DESCRIPTION\nconst company_description = $('Company Search')?.first()?.json?.description || \"\"\nconst company_info = {\n   \"name\": names,\n   \"description\" : company_description,\n   \"logo\": company_logo,\n   \"cover_image\": cover_image,\n   \"size\": sizes,\n   \"founded\": company_founded,\n   \"revenue\":  revenues,\n   \"type\": company_types,\n   \"domain\":  domains,\n   \"industries\": industries,\n   \"specialities\": specialities,\n   \"social_urls\":social_urls_combined,\n   \"phone_number\":  phone_numbers,\n   \"location\": locations,\n   \"similar_organizations\" :similar_organizations\n}\n\nreturn {company_info};\n"},"id":"a49f74ac-ac15-4b79-ba90-a82a09fbddad","name":"Summarizing Company Info","type":"n8n-nodes-base.code","typeVersion":2,"position":[8460,720]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"let profile_search = null\ntry{\n  profile_search = $('Profile Search').first().json\n}catch(err){}\n\n// FIRST NAME\nconst first_names = [] \n\nconst summarizing_first_name = $('Anthropic Response')?.first()?.json?.user_info?.first_name || null\nsummarizing_first_name && first_names.push(summarizing_first_name);\n\nconst email_data_first_name = $('Combining Email data')?.first()?.json?.first_name || null\nemail_data_first_name && first_names.push(email_data_first_name)\n\nconst profile_search_first_name = profile_search?.firstName || null\nprofile_search_first_name && first_names.push(profile_search_first_name)\n\n// LAST NAME\nconst last_names = []\n\nconst summarizing_last_name = $('Anthropic Response')?.first()?.json?.user_info?.last_name || null\nsummarizing_last_name && last_names.push(summarizing_last_name);\n\nconst email_data_last_name = $('Combining Email data')?.first()?.json?.last_name || null\nemail_data_last_name && last_names.push(email_data_last_name)\n\nconst profile_search_last_name = profile_search?.lastName || null\nprofile_search_last_name && last_names.push(profile_search_last_name)\n// ROLE \nconst roles = []\nconst summarizing_role = $('Anthropic Response')?.first()?.json?.user_info?.role || null\nsummarizing_role && roles.push(summarizing_role)\n\nconst profile_search_role = profile_search?.headline || null\nprofile_search_role && roles.push(profile_search_role)\n\n// PRIMARY EMAIL\nconst primary_emails = []\n// const summarizing_primary_email = $('Anthropic Response')?.first()?.json?.user_info?.primary_email || null\n// summarizing_primary_email && primary_emails.push(summarizing_primary_email)\n\nconst email_data_primary_email = $('Combining Email data')?.first()?.json?.email || null\nemail_data_primary_email && primary_emails.push(email_data_primary_email)\n// PERSONAL EMAILS\nlet personal_emails =  $('Anthropic Response')?.first()?.json?.user_info?.personal_emails || []\nconst combining_email_data_personal_email =  $('Combining Email data')?.first()?.json?.email || null\ncombining_email_data_personal_email && personal_emails.push(combining_email_data_personal_email)\n\n\n\n// WORK EMAILS\nlet work_emails = $('Anthropic Response')?.first()?.json?.user_info?.work_emails || []\n// PHONE NUMBERS\nlet phone_numbers =  $('Anthropic Response')?.first()?.json?.user_info?.phone_numbers || []\nconst lead_magic_phone_number = $('Mobile Finder')?.first()?.json?.mobile_number || null\nlead_magic_phone_number && phone_numbers.push(lead_magic_phone_number)\n// SOCIAL URLS\nconst combined_social_urls = {\n     \"linked_in\": \"\",\n      \"facebook\": \"\",\n      \"twitter\" : \"\",\n      \"git_hub\": \"\",\n      \"blog\":  \"\",\n      \"stackoverflow\": \"\",\n      \"pitchbook\": \"\",\n      \"monster\": \"\",\n      \"crunchbase\": \"\",\n      \"angellist\": \"\",\n      \"indeed\": \"\",\n      \"glassdoor\": \"\"\n}\nlet social_urls = $('Anthropic Response')?.first()?.json?.user_info?.social_urls || null\nconst profile_search_linked_in = profile_search?.profileUrl || null\n\nconst linked_in_list = []\nsocial_urls?.linked_in && linked_in_list.push(social_urls.linked_in)\nprofile_search_linked_in && linked_in_list.push(profile_search_linked_in)\n\ncombined_social_urls.linked_in = linked_in_list\n// LOCATION\nconst locations =[ $('Anthropic Response')?.first()?.json?.user_info?.location]\nconst profile_search_splitted_location = profile_search?.location ? profile_search?.location.split(',') : null\n\nif(profile_search_splitted_location){\n  locations.push({\n      \"city\":profile_search_splitted_location[0] || \"\",\n      \"state\": profile_search_splitted_location[1] || \"\",\n      \"country\":\"\",\n      \"address\": \"\",\n      \"zip\":  \"\"\n  })  \n}\n// USER SKILLS \nconst user_skills =  profile_search?.userSkills || \"\"\n// ABOUT\nconst user_about = profile_search?.about || \"\"\n// EXPERIENCES\nconst user_experiences = [];\nconst profile_data_user_experiences = profile_search?.experiences\n\nif(profile_data_user_experiences && profile_data_user_experiences.length > 0 ){\n  profile_data_user_experiences.forEach(experience => {\n    user_experiences.push({\n       \"company_name\": experience.subtitle || \"\",\n       \"company_domain\" : experience.companyLink1 || \"\",\n       \"role\" : experience.title || \"\",\n       \"company_logo\": experience.logo || \"\"\n    })\n  })\n}\n// PROFILE PIC\nconst profile_picture = profile_search?.profilePic || $('Anthropic Response')?.first()?.json?.user_info?.profile_pick\nconst user_info = {\n    \"first_name\" : first_names,\n    \"last_name\" : last_names ,\n    \"profile_pick\":profile_picture  ,\n    \"about\": user_about,\n    \"user_skills\" : user_skills,\n    \"experiences\": user_experiences,\n    \"role\":  roles,\n    \"primary_email\" :  primary_emails,\n    \"personal_email\" :  personal_emails,\n    \"work_email\" : work_emails,\n    \"phone_number\":phone_numbers,\n    \"social_urls\":combined_social_urls,\n    \"location\": locations\n }\n\nreturn {user_info};\n"},"id":"9f8c4557-9b68-423c-bbda-3c7a755d7e67","name":"Summarizing User Info","type":"n8n-nodes-base.code","typeVersion":2,"position":[8260,720]},{"parameters":{"content":"# Page Visited More information\n","height":664.711775870632,"width":984.2296898110443},"id":"b086d3be-c316-4bfb-913f-3baf8650ef30","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[10100,400]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const prompt = `\n<TASK>\nGo to the provided page and extract the following information:\nPage:  ${$json.technical_data.page_visited_url} \n\n1. **page_title**: The page title or META title.  \n2. **type_of_page**: Choose one of the following options based on the content:\n   - Service Page: Promotes a compliance solution, framework, or certification that I.S. Partners provides.\n   - Blog Article: Provides informational or educational content.  Blog articles will have /blog/ in the URL\n   - Company Page: Focuses on I.S. Partners' company information (e.g., about, contact).\n   - Partner Page: Contains \"/partnerships/\" in the URL or focuses on partner-related content.\n3. **framework_of_page**: Identify the primary IT compliance framework, certification, or solution mentioned on the page. Follow these rules:\n   - If mentioned in the title (e.g., \"SOC 1 Bridge Letter Explained\"), your output should be the specific framework (e.g., \"SOC 1\").\n   - If the page is about two frameworks, output both (e.g., \"SOC 1 and SOC 2\").\n   - If multiple frameworks are mentioned, choose the one mentioned first in the title.\n   - If no frameworks are directly mentioned, infer the logical framework based on the main topic of the page.\n   - If unsure, output \"Not Sure.\" Your output should be no more than two frameworks or certifications.\n4. **summary**: Provide a brief summary of the page.\n5. **keyword**: Choose one main keyword that likely led users to this page. Keep it in sentence case unless normally uppercase (e.g., \"SOC 2\").\n6. **topic**: Identify the main topic of the page. Keep the output concise and direct, with no more than five words, formatted in sentence case (unless uppercase is required). The output should fit into this sentence: \"I noticed you recently checked out info about {{TOPIC}} on our website.\"\n7. **intent**: Page Visited - Intent (What is the goal of the page - is it to sell or inform?) \n   There are two possible options:\n   a)Sales page (service/product/partner signup pages/Request a Quote, Call to Action pages)\n   b)Informational page (about, contact, blog articles, resources, etc)\n\n<RESPONSE_EXAMPLES>\n{\n\"page_title\": \"SOC 2 Compliance Audit Services\",\n\"type_of_page\": \"Service Page\",\n\"framework_of_page\": \"SOC 2\",\n\"keyword\": \"SOC 2 Audit Services\",\n\"summary\": \"The page outlines the SOC 2 compliance audit services provided by I.S. Partners, detailing the process, requirements, and benefits of engaging their services.\",\n\"page_title_friendly\": \"SOC 2 Audit Services\",\n\"topic\": \"SOC 2 compliance audit services\",\n\"intent\": \"Sales page\"\n}\n\n{\n\"page_title\": \"Understanding ISO 27001 Certification\",\n\"type_of_page\": \"Blog Article\",\n\"framework_of_page\": \"ISO 27001\",\n\"keyword\": \"ISO 27001 Certification\",\n\"summary\": \"The blog article explains what ISO 27001 certification is, its benefits, and why organizations should consider obtaining it.\",\n\"page_title_friendly\": \"Understanding ISO 27001\",\n\"topic\": \"ISO 27001 certification\",\n\"intent\": \"Informational page\"\n}\n\n{\n\"page_title\": \"Partnerships: SOC 2 for Cloud Services\",\n\"type_of_page\": \"Partner Page\",\n\"framework_of_page\": \"SOC 2\",\n\"keyword\": \"SOC 2 for Cloud Services\",\n\"summary\": \"Outlines the partnership between I.S. Partners and cloud service providers to implement SOC 2 compliance, facilitating enhanced security and trust.\",\n\"page_title_friendly\": \"SOC 2 for Cloud Services\",\n\"topic\": \"SOC 2 compliance for cloud services\",\n\"intent\": \"Sales page\"\n}\n<RULES>\n- Use uppercase only for words that are conventionally uppercase (e.g., SOC 2, PCI).\n`\n\nreturn {prompt: prompt}"},"id":"690d06b9-601b-4b17-80af-3136758edb90","name":"Page Information prompt","type":"n8n-nodes-base.code","typeVersion":2,"position":[10200,720]},{"parameters":{"jsonSchemaExample":"{\n  \"page_title\":\"string\",\n  \"type_of_page\":\"string\",\n  \"framework_of_page\": \"string\",\n  \"keyword\":\"string\",\n  \"summary\":\"string\",\n  \"page_title_friendly\":\"string\",\n  \"topic\":\"string\",\n  \"intent\":\"string\"\n}"},"id":"6b5d7b71-1685-4063-933b-04dc35c4bfe0","name":"Page info - Output parser","type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[10640,940]},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{}},"id":"3ec69257-03d7-46eb-b790-23479ec65e1d","name":"Page Visited Agent","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[10400,720],"retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"jsonSchemaExample":"{\n\t\"job_responsibilities\": \"Supervising and guiding the sales team, developing a business marketing strategy, maintaining relationships with clients, coordinating marketing activities, analyzing market trends and demographic data.\",\n\t\"job_challenges\": \"Handling underperforming team members, dealing with volatile market conditions, maintaining consistent brand identity across different marketing platforms, acquiring a significant market share in an oversaturated market.\",\n    \"intent\": \"Looking for potential job opportunities in marketing\",\n    \"report\": \"The individual visited the page to explore potential job opportunities within our organization. They spent a significant amount of time examining the job responsibilities and challenges associated with our marketing roles. Additionally, they returned to the page multiple times indicating a heightened interest in our company. We recommend reaching out to them with customised job opportunities in line with their expressed intent.\"\n}"},"id":"80b9958f-85f7-44b9-b62b-4f2633eb6a6e","name":"About the Contact - Output parser","type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[12560,920]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const model_response = $json?.output \nconst prospect_object = $('Prospect final structure').first().json\nprospect_object.technical_data.page_visited_type = model_response?.type_of_page || \"\"\nprospect_object.technical_data.page_visited_framework = model_response?.framework_of_page ||\"\"\nprospect_object.technical_data.page_visited_keyword = model_response?.keyword ||\"\"\nprospect_object.technical_data.page_visited_summary = model_response?.summary||\"\"\nprospect_object.technical_data.page_visited_title_friendly = model_response?.page_title_friendly ||\"\"\nprospect_object.technical_data.page_visited_topic = model_response?.topic ||\"\"\nprospect_object.technical_data.page_visited_intent = model_response?.intent || \"\"\nreturn prospect_object\n"},"id":"897bf711-6503-432e-b862-c48cde604e97","name":"Combining Page Info. Data","type":"n8n-nodes-base.code","typeVersion":2,"position":[10840,720]},{"parameters":{"content":"# About the Company (non-public information)","height":659.7636212052339,"width":857.31022486797},"id":"a0e803eb-72c4-4a7b-a105-02638eb22fb9","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[11100,400]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const prompt = `\n--- TASK ---\nYour task is to find following information about the company:\n- Products/Services\n- Industries or specific audiences they target\n- Unique Selling Proposition\n- ICP (if they define their Ideal Customer Profile on the site, then we can list it here) \n- Clients (if they list clients on their website, we can identify them)\n- Testimonials (pull out any reviews/testimonials they have)\n- Case Studies (pull out any case studies they reference on their site) \n- Report (Based on the provided object with company's information and the data you gatherered from the previous tasks combine all of the information that is overall summary of the company)\n\n\nHere is company's domain to help you in the above tasks: ${$json.company_info.domain}, scrape it to get more information.\nHere is additional information about the company (structured as an object) to help you in your task:\n${JSON.stringify($json.company_info)}.\n--- RESPONSE EXAMPLE ---\nYour response shoulf follow this object structure:\n{\n\"products\": [\"Comprehensive Security Solutions\", \"Risk Assessment Services\", \"Compliance Management Tools\"],\n\"industries\": [\"Healthcare\", \"Financial Services\", \"Information Technology\"],\n\"unique_selling_proposition\": \"Highly tailored, industry-specific security and compliance solutions with exceptional customer service.\",\n\"icp\": \"Mid to large-sized companies in regulated industries seeking robust, customizable compliance and security solutions.\",\n\"clients\": [\"MediCorp\", \"FinBank\", \"TechSoft\"],\n\"testimonials\": [\n{\n\"client\": \"MediCorp\",\n\"name\": \"John Doe\",\n\"position\": \"CISO\",\n\"testimonial\": \"Their tailored solutions and expertise helped us achieve compliance smoothly.\"\n}\n],\n\"case_studies\": [\n{\n\"title\": \"Achieving SOC2 Compliance for MediCorp\",\n\"link\": \"www.example.com/case-study/mediCorp\"\n}\n],\n\"report\": \"The company provides a range of security and compliance solutions, specializing in the healthcare, financial services, and IT sectors. They pride themselves on their personalized approach and excellent customer service. Their ideal customers are mid to large-sized firms in regulated industries. Their success stories include big names like MediCorp, FinBank, and TechSoft.\"\n}\n\n`\n\nreturn {prompt:prompt}"},"id":"bc9ef897-c258-44e6-811f-c6e287e816cf","name":"About the Company prompt","type":"n8n-nodes-base.code","typeVersion":2,"position":[11160,720]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining Company info. data').first().json\nconst job_responsibilities = $json?.output?.job_responsibilities || \"\"\nconst job_challenges = $json?.output?.job_challenges || \"\"\nconst intent = $json?.output?.intent || \"\"\nconst report = $json?.output?.report || \"\"\n\noriginal.user_info.job_responsibilities = job_responsibilities\noriginal.user_info.job_challenges = job_challenges\noriginal.user_info.report = report\noriginal.user_info.visit_intent = intent\n\n\nreturn original\n\n"},"id":"d523a7b3-2323-40f7-bfa7-acde890775e3","name":"Combining Contact non-public information","type":"n8n-nodes-base.code","typeVersion":2,"position":[12720,720]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining Page Info. Data').first().json\n\nconst products = $json?.output?.products || []\nconst industries = $json?.output?.industries || []\nconst unique_selling_proposition = $json?.output?.unique_selling_proposition || \"\"\nconst icp = $json?.output?.icp || \"\"\nconst clients = $json?.output?.clients || []\nconst testimonials = $json?.output?.testimonials || []\nconst case_studies = $json?.output?.case_studies || []\nconst report = $json?.output?.report || \"\"\n\noriginal.company_info.products = products\noriginal.company_info.industries = [...industries,original.company_info.industries ]\noriginal.company_info.unique_selling_proposition = unique_selling_proposition\noriginal.company_info.icp = icp\noriginal.company_info.clients = clients\noriginal.company_info.testimonials = testimonials\noriginal.company_info.case_studies = case_studies\noriginal.company_info.report = report\n\n\n\n\nreturn original;"},"id":"2fb5fd1d-1dca-473e-9ffb-63bfa4d25566","name":"Combining Company info. data","type":"n8n-nodes-base.code","typeVersion":2,"position":[11800,720]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const prompt = `\n-- DATA TO BE USED IN THE TASK -- \nInformation of the user who wisited the page ${JSON.stringify($json.user_info)}\n\n-- TASK -- \nYour task is to find:\n- Job responsibilities \nStep 1:  Search Google for job postings for the company that are for the exact job title (${$json.user_info.role}) of the contact.  This will help us find the exact job responsibilities this contact has in their day to day job\nStep 2:  If Step 1 isn't found, then look for job posts from the same company that are for similar job titles as the contacts current job title.   This will give us more accurate information about their responsibilities then we will get if we depend on generic job responsibilities.\nStep 3: If Step 2 isn't found, then have AI provide the job responsibilities based on the products and services offered by the company. Here is the list of products/services: ${$json.company_info.products}\n------------------------------\n- Job challenges: Based on the following information, list the daily challenges/problems user is likely to face on their job:\na)Users job title - ${$json.user_info.role}\nb)Users job Responsibilties - Get from the previous task\nc)Users industry where he is workin - ${$json.company_info.industries}\nd)Products/Services the users company offers - ${$json.company_info.products}\n------------------------------\n- Intent (Why they visited the site)\nBased on the following information, come up with a reason why the person visited the website\na)Users job title - ${$json.user_info.role}\nb)Users job Responsibilities - Get from the previous task\nc)Users industry where he is workin - ${$json.company_info.industries}\nd)Products/Services the users company offers - ${$json.company_info.products}\ne)Page Visited - Summary: ${$json.technical_data.page_visited_summary}\nf)Page Visited - Main Topic: ${$json.technical_data.page_visited_topic}\ng)Page Visited - Intent: ${$json.technical_data.page_visited_intent} (What is the goal of the page - is it to sell or inform?):  (Sales page (service/product/partner signup pages/Request a Quote, Call to Action pages) Informational page (about, contact, blog articles, resources, etc))\n------------------------------\n- Contact Report\nBased on the provided object with contact's information and the data you gatherered from the previous tasks combine all of the information that is overall summary of the contact.\n\n`\nreturn {prompt:prompt}"},"id":"6420a959-5a4a-4709-82a4-b031f5ae53ac","name":"About the contact prompt","type":"n8n-nodes-base.code","typeVersion":2,"position":[12080,720]},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{}},"id":"d0eef9b6-4505-4293-916f-066cc81c7f29","name":"About the Company Agent","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[11400,720],"retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{}},"id":"ae6c9a3f-0873-4dae-bd24-7ce571c3425d","name":"About the Contact Agent","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[12300,720],"retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"promptType":"define","text":"=Given this object: \n{{ JSON.stringify($json)}}\n** YOUR TASK **\n- Looking at the whole provided object above summerize array's into a single \"most probable\" value.\n  Don't summerize following array's: experiences, industries, specialities, similar_organizations. \n- Industries array can't contain object's, make sure you add in just string values to that array.\n- Do nothing for technical_data and upcoming_meeting_data, they need to stay the same as in the provided object.\n- If any of the values are empty, keep them that way.\n\n\n\n** EXAMPLE OF WHAT YOU SHOULD DO **\nIf we for example have an array of first names [\"David\", \"Cam\", \"Stefan\"] we are going to set the\nfirst_name to be \"Stefan\", why ? because for example we have an email in the object \"stefan@searchactions.com\" containing users first name in the email. \n\n\n** OUTPUT EXAMPLE ** \nYour output should follow the structure of this following object:\n{\n  \"user_info\": {\n    \"first_name\": \"Cameron\",\n    \"last_name\": \"Fulton\",\n    \"profile_pick\":\"https://media.licdn.com/dms/image/v2/C5603AQG5_NVelxM7Ww/profile-displayphoto-shrink_100_100/profile-displayphoto-shrink_100_100/0/1517376023958?e=1741219200&v=beta&t=8tFOFZgHBpdwalBX7pCwBvhECjJLFIYC26YoHK_zdEI\",\n    \"about\": \"I am a dedicated and flexible researcher who is able to effectively and efficiently learn both technical skills and theoretical concepts. Situational awareness and decisive action are key points to keeping operations orderly and safe, which I believe I can bring along with my knowledge of the Geological Sciences. \\n\\nMy experience as a laboratory assistant and a researcher has instilled in me a detail oriented mindset to my work. Being able to recognize and remediate errors in both my own and other's work to create an efficient and safe work environment\",\n    \"user_skills\": \"Soil Sampling, Water Sampling, Phase I Environmental Site Assessments, Phase II Environmental Site Assessments, Laboratory Skills, Communication, Community Outreach, Research, Presentation Skills\",\n    \"experiences\": [\n      {\n        \"company_name\": \"TRC Companies, Inc. · Full-time\",\n        \"company_domain\": \"https://www.linkedin.com/company/7886/\",\n        \"role\": \"Environmental Technician\",\n        \"company_logo\": \"https://media.licdn.com/dms/image/v2/D560BAQFvsK8Gz_WaMQ/company-logo_200_200/company-logo_200_200/0/1719583843650/trc_companies_inc_logo?e=1741219200&v=beta&t=S2uoY6abHaiyPwcl8YaVodvO4u7Oevquwrcxe_nR_gc\"\n      },\n      {\n        \"company_name\": \"Draper Aden Associates · Full-time\",\n        \"company_domain\": \"https://www.linkedin.com/search/results/all/?keywords=Draper+Aden+Associates\",\n        \"role\": \"Environmental Technician I\",\n        \"company_logo\": \"\"\n      },\n      {\n        \"company_name\": \"HEPACO, LLC · Full-time\",\n        \"company_domain\": \"https://www.linkedin.com/company/676924/\",\n        \"role\": \"Environmental Professional\",\n        \"company_logo\": \"https://media.licdn.com/dms/image/v2/D560BAQFzpnkQ2YgwMQ/company-logo_200_200/company-logo_200_200/0/1667786682624/hepaco_inc_logo?e=1741219200&v=beta&t=39qyS4pKHHVLAqYUZA45jrYiRb0S2YtWqaLloOkZleE\"\n      },\n      {\n        \"company_name\": \"1 yr 5 mos\",\n        \"company_domain\": \"https://www.linkedin.com/company/3757/\",\n        \"role\": \"University of North Carolina at Chapel Hill\",\n        \"company_logo\": \"https://media.licdn.com/dms/image/v2/D4E0BAQHJC70g6t2Zvg/company-logo_200_200/company-logo_200_200/0/1721159675755/university_of_north_carolina_at_chapel_hill_logo?e=1741219200&v=beta&t=Ith8idPUNUr78MXxAUi1icIWgwVla2yNwO_zxS9G7LA\"\n      }\n    ],\n    \"role\": \"Environmental Technician I at TRC\",\n    \"primary_email\": \"cameron.fulton@searchactions.com\",\n    \"personal_email\": \"cameron.fulton@gmail.com\",\n    \"work_email\": \"cameron.fulton@searchactions.com\",\n    \"phone_number\": \"+16197234483\",\n    \"social_urls\": {\n      \"linked_in\": \"https://www.linkedin.com/in/cameron-fulton\",\n      \"facebook\": \"\",\n      \"twitter\": \"\",\n      \"git_hub\": \"\",\n      \"blog\": \"\",\n      \"stackoverflow\": \"\",\n      \"pitchbook\": \"\",\n      \"monster\": \"\",\n      \"crunchbase\": \"\",\n      \"angellist\": \"\",\n      \"indeed\": \"\",\n      \"glassdoor\": \"\"\n    },\n    \"location\": {\n      \"city\": \"San Francisco\",\n      \"state\": \"CA\",\n      \"country\": \"United States\",\n      \"address\": \"\",\n      \"zip\": \"94105\"\n    }\n  },\n  \"company_info\": {\n    \"name\": \"SearchActions\",\n    \"description\": \"\",\n    \"logo\": \"\",\n    \"cover_image\": \"\",\n    \"sizes\": \"11-50 employees\",\n    \"founded\": 2012,\n    \"revenue\": \"$1M - $5M\",\n    \"type\": \"private\",\n    \"domain\": \"https://www.searchactions.com/\",\n    \"industries\": [\n      \"Information Technology & Services\",\n      \"Marketing And Advertising\",\n      \"environmental services\"\n    ],\n    \"specialities\": [\n      \"Search Technology\",\n      \"Enterprise Software\",\n      \"SaaS\"\n    ],\n    \"social_urls\": {\n      \"linked_in\": \"https://www.linkedin.com/company/searchactions\",\n      \"facebook\": \"facebook.com/searchactions\",\n      \"twitter\": \"https://twitter.com/searchactions\",\n      \"git_hub\": \"\",\n      \"blog\": \"\",\n      \"stackoverflow\": \"\",\n      \"pitchbook\": \"\",\n      \"monster\": \"\",\n      \"crunchbase\": \"\",\n      \"angellist\": \"\",\n      \"indeed\": \"\",\n      \"glassdoor\": \"\"\n    },\n    \"phone_number\": \"+1 (888) 123-4567\",\n    \"location\": {\n      \"city\": \"San Francisco\",\n      \"state\": \"CA\",\n      \"country\": \"United States\",\n      \"address\": \"123 Tech Lane\",\n      \"zip\": \"94105\"\n    },\n    \"similar_organizations\": [{\n      \"name\": \"New York State Homes & Community Renewal\",\n      \"size\": 1000,\n      \"industry\": \"Government Administration\",\n      \"locations\": {\n        \"zip\": \"10022\",\n        \"city\": \"New York\",\n        \"state\": \"NY\",\n        \"address\": \"641 Lexington Ave null\",\n        \"country\": \"US\"\n      },\n      \"cover_image\": \"https://media.licdn.com/dms/image/v2/D4E3DAQGOOwPpDaO42Q/image-scale_127_750/image-scale_127_750/0/1730489453975/nyshcr_cover?e=1734969600&v=beta&t=gq6enOuDmNAehs5s6STx_A2myFdTjacpqpKofPwOKnE\",\n      \"company_logo\": \"https://media.licdn.com/dms/image/v2/C4D0BAQGMwByuQu_ZJA/company-logo_200_200/company-logo_200_200/0/1630526406531?e=1742428800&v=beta&t=8rtF75ynKjWjtFq4g4a5o7aYe9Z2FiVYxM-ZFbhQ9GQ\"\n    }]\n  },\n  \"technical_data\": {\n    \"page_visited_title\": \"SearchActions - Home\",\n    \"page_visited_url\": \"https://example.com/home\",\n    \"page_visited_domain\":\"example.com\",\n    \"utmCampaign\": \"WinterCampaign\",\n    \"utmContent\": \"product_launch\", \n    \"utmMedium\": \"email\",\n    \"utmSource\": \"newsletter\",\n    \"utmTerm\": \"new_product\",\n    \"vvid\": \"1234abcd\",\n    \"hem\": \"heme123\",\n    \"urn\": \"ACoAAC5k4O0Bc6RfjERHO9za2lbTGfTLtsF-KBw\",\n    \"mx_record\": \"searchactions-com.mail.protection.outlook.com\",\n    \"mx_provider\": \"Microsoft 365\",\n    \"mx_security_gateway\": \"false\"\n  },\n    \"upcoming_meeting_data\": {\n      \"meeting_with\": \"\",\n      \"meeting_time\": \"\",\n      \"lifecycle_stage\": \"\",\n      \"form_message\": \"\",\n      \"hubspot_id\": \"\"\n    }\n}\n\n","hasOutputParser":true,"options":{"maxIterations":20}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[9400,720],"id":"7cf86fbc-43eb-4fbf-a9b4-3e75849e9174","name":"Analyzing data","retryOnFail":true,"maxTries":5,"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const structured_object = $json?.output\n\n\nconst fallback_data = $('Combining Company - User - Technical Data').first().json\n\nconst transformArraysToFirstItem = (inputData) => {\n  // Helper function to check if value should be processed\n  const shouldProcessArray = (key, parentKey) => {\n    const exclusions = {\n      user_info: ['experiences'],\n      company_info: ['industries', 'similar_organizations', 'specialities']\n    };\n    \n    return !(exclusions[parentKey] && exclusions[parentKey].includes(key));\n  };\n\n  // Deep clone to avoid modifying original data\n  const processObject = (obj, parentKey = '') => {\n    const result = {};\n    \n    for (const [key, value] of Object.entries(obj)) {\n      if (Array.isArray(value) && shouldProcessArray(key, parentKey)) {\n        // Transform array to first item if it should be processed\n        result[key] = value[0];\n      } else if (typeof value === 'object' && value !== null) {\n        // Recursively process nested objects\n        result[key] = processObject(value, key);\n      } else {\n        // Keep non-array values as is\n        result[key] = value;\n      }\n    }\n    \n    return result;\n  };\n\n  // Process the object directly\n  return processObject(inputData);\n};\n\n\n\nif(structured_object){\n  return structured_object\n}else{\n return transformArraysToFirstItem({\n    user_info: fallback_data.user_info,\n    company_info:fallback_data.company_info,\n    technical_data: fallback_data.technical_data,\n    upcoming_meeting_data: fallback_data.upcoming_meeting_data\n })\n}\n\n\n"},"id":"8c9c9bbd-7016-4513-b0f2-40176e4106aa","name":"Prospect final structure","type":"n8n-nodes-base.code","typeVersion":2,"position":[9820,720]},{"parameters":{"jsonSchemaExample":"{\n  \"user_info\": {\n    \"first_name\": \"Cameron\",\n    \"last_name\": \"Fulton\",\n    \"profile_pick\":\"https://media.licdn.com/dms/image/v2/C5603AQG5_NVelxM7Ww/profile-displayphoto-shrink_100_100/profile-displayphoto-shrink_100_100/0/1517376023958?e=1741219200&v=beta&t=8tFOFZgHBpdwalBX7pCwBvhECjJLFIYC26YoHK_zdEI\",\n    \"about\": \"I am a dedicated and flexible researcher who is able to effectively and efficiently learn both technical skills and theoretical concepts. Situational awareness and decisive action are key points to keeping operations orderly and safe, which I believe I can bring along with my knowledge of the Geological Sciences. \\n\\nMy experience as a laboratory assistant and a researcher has instilled in me a detail oriented mindset to my work. Being able to recognize and remediate errors in both my own and other's work to create an efficient and safe work environment\",\n    \"user_skills\": \"Soil Sampling, Water Sampling, Phase I Environmental Site Assessments, Phase II Environmental Site Assessments, Laboratory Skills, Communication, Community Outreach, Research, Presentation Skills\",\n    \"experiences\": [\n      {\n        \"company_name\": \"TRC Companies, Inc. · Full-time\",\n        \"company_domain\": \"https://www.linkedin.com/company/7886/\",\n        \"role\": \"Environmental Technician\",\n        \"company_logo\": \"https://media.licdn.com/dms/image/v2/D560BAQFvsK8Gz_WaMQ/company-logo_200_200/company-logo_200_200/0/1719583843650/trc_companies_inc_logo?e=1741219200&v=beta&t=S2uoY6abHaiyPwcl8YaVodvO4u7Oevquwrcxe_nR_gc\"\n      },\n      {\n        \"company_name\": \"Draper Aden Associates · Full-time\",\n        \"company_domain\": \"https://www.linkedin.com/search/results/all/?keywords=Draper+Aden+Associates\",\n        \"role\": \"Environmental Technician I\",\n        \"company_logo\": \"\"\n      },\n      {\n        \"company_name\": \"HEPACO, LLC · Full-time\",\n        \"company_domain\": \"https://www.linkedin.com/company/676924/\",\n        \"role\": \"Environmental Professional\",\n        \"company_logo\": \"https://media.licdn.com/dms/image/v2/D560BAQFzpnkQ2YgwMQ/company-logo_200_200/company-logo_200_200/0/1667786682624/hepaco_inc_logo?e=1741219200&v=beta&t=39qyS4pKHHVLAqYUZA45jrYiRb0S2YtWqaLloOkZleE\"\n      },\n      {\n        \"company_name\": \"1 yr 5 mos\",\n        \"company_domain\": \"https://www.linkedin.com/company/3757/\",\n        \"role\": \"University of North Carolina at Chapel Hill\",\n        \"company_logo\": \"https://media.licdn.com/dms/image/v2/D4E0BAQHJC70g6t2Zvg/company-logo_200_200/company-logo_200_200/0/1721159675755/university_of_north_carolina_at_chapel_hill_logo?e=1741219200&v=beta&t=Ith8idPUNUr78MXxAUi1icIWgwVla2yNwO_zxS9G7LA\"\n      }\n    ],\n    \"role\": \"Environmental Technician I at TRC\",\n    \"primary_email\": \"cameron.fulton@searchactions.com\",\n    \"personal_email\": \"cameron.fulton@gmail.com\",\n    \"work_email\": \"cameron.fulton@searchactions.com\",\n    \"phone_number\": \"+16197234483\",\n    \"social_urls\": {\n      \"linked_in\": \"https://www.linkedin.com/in/cameron-fulton\",\n      \"facebook\": \"\",\n      \"twitter\": \"\",\n      \"git_hub\": \"\",\n      \"blog\": \"\",\n      \"stackoverflow\": \"\",\n      \"pitchbook\": \"\",\n      \"monster\": \"\",\n      \"crunchbase\": \"\",\n      \"angellist\": \"\",\n      \"indeed\": \"\",\n      \"glassdoor\": \"\"\n    },\n    \"location\": {\n      \"city\": \"San Francisco\",\n      \"state\": \"CA\",\n      \"country\": \"United States\",\n      \"address\": \"\",\n      \"zip\": \"94105\"\n    }\n  },\n  \"company_info\": {\n    \"name\": \"SearchActions\",\n    \"description\": \"\",\n    \"logo\": \"\",\n    \"cover_image\": \"\",\n    \"sizes\": \"11-50 employees\",\n    \"founded\": 2012,\n    \"revenue\": \"$1M - $5M\",\n    \"type\": \"private\",\n    \"domain\": \"https://www.searchactions.com/\",\n    \"industries\": [\n      \"Information Technology & Services\",\n      \"Marketing And Advertising\",\n      \"environmental services\"\n    ],\n    \"specialities\": [\n      \"Search Technology\",\n      \"Enterprise Software\",\n      \"SaaS\"\n    ],\n    \"social_urls\": {\n      \"linked_in\": \"https://www.linkedin.com/company/searchactions\",\n      \"facebook\": \"facebook.com/searchactions\",\n      \"twitter\": \"https://twitter.com/searchactions\",\n      \"git_hub\": \"\",\n      \"blog\": \"\",\n      \"stackoverflow\": \"\",\n      \"pitchbook\": \"\",\n      \"monster\": \"\",\n      \"crunchbase\": \"\",\n      \"angellist\": \"\",\n      \"indeed\": \"\",\n      \"glassdoor\": \"\"\n    },\n    \"phone_number\": \"+1 (888) 123-4567\",\n    \"location\": {\n      \"city\": \"San Francisco\",\n      \"state\": \"CA\",\n      \"country\": \"United States\",\n      \"address\": \"123 Tech Lane\",\n      \"zip\": \"94105\"\n    },\n    \"similar_organizations\": [{\n      \"name\": \"New York State Homes & Community Renewal\",\n      \"size\": 1000,\n      \"industry\": \"Government Administration\",\n      \"locations\": {\n        \"zip\": \"10022\",\n        \"city\": \"New York\",\n        \"state\": \"NY\",\n        \"address\": \"641 Lexington Ave null\",\n        \"country\": \"US\"\n      },\n      \"cover_image\": \"https://media.licdn.com/dms/image/v2/D4E3DAQGOOwPpDaO42Q/image-scale_127_750/image-scale_127_750/0/1730489453975/nyshcr_cover?e=1734969600&v=beta&t=gq6enOuDmNAehs5s6STx_A2myFdTjacpqpKofPwOKnE\",\n      \"company_logo\": \"https://media.licdn.com/dms/image/v2/C4D0BAQGMwByuQu_ZJA/company-logo_200_200/company-logo_200_200/0/1630526406531?e=1742428800&v=beta&t=8rtF75ynKjWjtFq4g4a5o7aYe9Z2FiVYxM-ZFbhQ9GQ\"\n    }]\n  },\n  \"technical_data\": {\n    \"page_visited_title\": \"SearchActions - Home\",\n    \"page_visited_url\": \"https://example.com/home\",\n    \"page_visited_domain\":\"example.com\",\n    \"utmCampaign\": \"WinterCampaign\",\n    \"utmContent\": \"product_launch\", \n    \"utmMedium\": \"email\",\n    \"utmSource\": \"newsletter\",\n    \"utmTerm\": \"new_product\",\n    \"vvid\": \"1234abcd\",\n    \"hem\": \"heme123\",\n    \"urn\": \"ACoAAC5k4O0Bc6RfjERHO9za2lbTGfTLtsF-KBw\",\n    \"mx_record\": \"searchactions-com.mail.protection.outlook.com\",\n    \"mx_provider\": \"Microsoft 365\",\n    \"mx_security_gateway\": \"false\"\n  }\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[9660,920],"id":"e6f6d04d-e9e1-473f-81a5-bf419138e80c","name":"Analyzing data - Parser"},{"parameters":{"jsonSchemaExample":"{\n\"products\": [\"CRM Software\", \"Marketing Automation Tools\"],\n\"industries\": [\"Sales and Marketing\"],\n\"unique_selling_proposition\": \"Integration of CRM and marketing automation in one platform.\",\n\"icp\": \"Sales and marketing teams looking for integrated solutions for improved efficiency.\",\n\"clients\": [\"SalesPro\", \"MarketLead\"],\n\"testimonials\": [\n{\n\"client\": \"SalesPro\",\n\"name\": \"Emma Brown\",\n\"position\": \"Sales Manager\",\n\"testimonial\": \"Their integrated tools have significantly improved our efficiency.\"\n}\n],\n\"case_studies\": [\n{\n\"title\": \"Boosting MarketLead's Sales with Integrated CRM\",\n\"link\": \"www.example.com/case-study/marketlead\"\n}\n],\n\"report\": \"The company specializes in CRM software and marketing automation tools, specifically for sales and marketing firms. Their unique selling proposition is their integration of CRM and marketing automation tools in one platform. Notable clients include SalesPro and MarketLead, who attest to the efficiency of their integrated platform.\"\n}"},"id":"a1d1a0da-21b7-4160-b36a-598b85e8586b","name":"About Company - Parser","type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[11640,920]},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[10340,940],"id":"24d7779e-d58a-43a2-988f-fa7ccb5eadf8","name":"OpenAI Chat Model - Page Info","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[11380,920],"id":"6a6f30ee-5efd-4723-95db-a6955bf2fb3a","name":"OpenAI Chat Model - Company Info","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[12280,920],"id":"2b055b07-dc70-4e37-bd0c-09e29427dcc1","name":"OpenAI Chat Model - Contact info.","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const summarizing_technical_data = $('Anthropic Response')?.first()?.json?.technical_data\nconst structured_object = {...summarizing_technical_data , urn: \"\" , mx_record:\"\", mx_provider:\"\",mx_security_gateway:\"\" }\n//PROFILE SEARCH URN\nlet profile_data = null\ntry{\n  profile_data = $('Profile Search')?.first()?.json\n}catch(error){\n  \n}\n\nconst profile_data_urn = profile_data?.urn\nif(profile_data_urn){\n  structured_object.urn = profile_data_urn\n}\n// MX DATA\nconst email_data  = $('Combining Email data')?.first()?.json\nif(email_data?.mx_record){\n  structured_object.mx_record = email_data.mx_record\n}\nif(email_data?.mx_provider){\n  structured_object.mx_provider = email_data.mx_provider\n}\nif(email_data?.mx_security_gateway){\n  structured_object.mx_security_gateway = email_data.mx_security_gateway\n}\n// if (structured_object?.page_visited_url) {\n//     const str = structured_object.page_visited_url;\n            \n//     const matches = str.match(/^https?\\:\\/\\/([^\\/?#]+)(?:[\\/?#]|$)/i);\n//     if (matches && matches[1]) {\n//        structured_object.page_visited_domain = matches[1].toLowerCase();\n//     } else {\n//         // Only use fallback if regex doesn't match\n//         let domain = str.replace(/^(https?:\\/\\/)?(www\\.)?/, '');\n//         domain = domain.split('@').pop()          // Handle authentication\n//                      .split(':')[0]               // Remove port\n//                      .split(/[/?#]/)[0];          // Remove path and params\n        \n//         // Basic validation\n//         if (domain && domain.includes('.') && domain.length > 2) {\n//               structured_object.page_visited_domain = domain.toLowerCase();\n//         }\n//     }\n// }\nreturn {structured_object};"},"id":"22b199c5-72d0-48fd-8b18-5e140da20104","name":"Summarizing Technical Data","type":"n8n-nodes-base.code","typeVersion":2,"position":[8660,720]},{"parameters":{"model":"claude-3-5-sonnet-20241022","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatAnthropic","typeVersion":1.2,"position":[9360,920],"id":"24a657af-78eb-418d-af05-8fc8ed0bc994","name":"Analyzing data Anthropic Model","credentials":{"anthropicApi":{"id":"TAgU99J0SeGyXIyU","name":"searchactions.com : digitalsandwich.agency - Website Visitor Enr"}}},{"parameters":{"content":"# About the contact (non-public information)","height":659.7636212052339,"width":1021.8084371329403},"id":"d313920a-4a68-4ead-9fee-c524e6d878c1","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[11980,400]},{"parameters":{"content":"# Email","height":658,"width":1819},"id":"6b065025-06c7-4db2-9bc5-6f94271b44c6","name":"Sticky Note19","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[3300,400]},{"parameters":{"content":"# Finding Missing data using AI","height":660,"width":921},"id":"1aa4be99-77b1-486e-a34b-3ca77b9f0dea","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[2340,400]},{"parameters":{"content":"# Prospect Report\n\n","height":660,"width":402},"id":"28c26df7-b431-413d-b2a7-beb1388a0033","name":"Sticky Note12","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[22600,400]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $json\nconst report = ` \n${$json?.user_info?.first_name} ${$json?.user_info?.last_name}\n\n\n### About \n${$json?.user_info?.first_name} ${$json?.user_info?.last_name}\n\n${$json?.user_info?.visit_intent}\n\n### Prospect Score (See bottom for scoring rules)\n\n${$json?.company_info?.icp_score?.total_score_string}(${$json?.company_info?.icp_score?.total_score}/62 Points)\n\nSummary:${$json?.company_info?.icp_score?.summary}\n\n### Job Title Score\nTotal Score: ${$json?.company_info?.icp_score?.component_scores?.job_title?.total_score} /12 Points\nJob Title:  ${$json?.company_info?.icp_score?.components?.icp_job}\nReasoning:  ${$json?.company_info?.icp_score?.component_scores?.job_title?.reasoning}\n\n### Industry Title Score\nTotal Score: ${$json?.company_info?.icp_score?.component_scores?.industry?.total_score}/8 Points\nIndustry:  ${$json?.company_info?.icp_score?.components?.icp_industry}\nReasoning:  ${$json?.company_info?.icp_score?.component_scores?.industry?.reasoning}\n\n### Location Score\nTotal Score: ${$json?.company_info?.icp_score?.component_scores?.location?.total_score}/8 Points\nLocal: ${$json?.company_info?.location?.city}, ${$json?.company_info?.location?.state}(${$json?.company_info?.icp_score?.components?.icp_local})\nReasoning:  ${$json?.company_info?.icp_score?.component_scores?.location?.reasoning}\n\n\n### Company Size Score\nTotal Score: ${$json?.company_info?.icp_score?.component_scores?.company_size?.total_score}/4 Points\nEmployee Count: ${$json?.company_info?.icp_score?.components?.icp_company_size}\nReasoning:  ${$json?.company_info?.icp_score?.component_scores?.company_size?.reasoning}\n\n### Frameworks\nTotal Score: ${$json?.company_info?.icp_score?.component_scores?.frameworks?.total_score}/12 Points\nFrameworks: ${$json?.company_info?.icp_score?.components?.icp_frameworks}\nReasoning: ${$json?.company_info?.icp_score?.component_scores?.frameworks?.reasoning}\nResearch:  ${$json?.company_info?.framework_review?.analysis}\n\n### Intent\nTotal Score: ${$json?.company_info?.icp_score?.component_scores?.intent?.total_score}/18 Points\nIntent: ${$json?.company_info?.icp_score?.components?.icp_intent}\nPage Visited: ${$json?.technical_data?.page_visited_url}\nTopic of Page: ${$json?.technical_data?.page_visited_topic}\nReasoning: ${$json?.technical_data?.page_visited_summary}\n\n\n### Auditors & GRC Tools\nAuditors: ${$json?.company_info?.auditor_grc_tools?.auditors}\nGRC Tools: ${$json?.company_info?.auditor_grc_tools?.grc_tools}\n\n### Criteria\nLocal:  ${$json?.company_info?.icp_score?.components?.icp_local}\nJob Title: ${$json?.company_info?.icp_score?.components?.icp_job}\nEmployee Count:${$json?.company_info?.icp_score?.components?.icp_company_size}\nIndustry: ${$json?.company_info?.icp_score?.components?.icp_industry}\nIntent: ${$json?.company_info?.icp_score?.components?.icp_intent}\n\n## Compliance Frameworks & Certifications\n- **Frameworks/Certifications that ${$json?.company_info?.name} has:**  \n${$json?.company_info?.framework_review?.confirmed_frameworks}\n- **Auditors they used for compliance/certifications:**  \n${$json?.company_info?.auditor_grc_tools?.auditors}\n- **GRC Tools they use:**  \n${$json?.company_info?.auditor_grc_tools?.grc_tools}\n- **Research and Reasoning:**  \nAnalysis:  ${$json?.company_info?.framework_review?.analysis}\nReasoning: ${$json?.company_info?.framework_review?.reasoning}\n\n### Contact Info\nName: ${$json?.user_info?.first_name} ${$json?.user_info?.last_name}\nJob Title: ${$json?.user_info?.role}\nPhone: ${$json?.user_info?.phone_number}\nEmail: ${$json?.user_info?.primary_email}\nLinkedIn: ${$json?.user_info?.social_urls?.linked_in}\nRecent Posts (If available): \"\"\n\n### Company Info\nCompany Name: ${$json?.company_info?.name}\nCity/State: ${$json?.company_info?.location?.city} ${$json?.company_info?.location?.state}\nWebsite: ${$json?.company_info?.domain}\nIndustry: ${$json?.company_info?.industries}\nSpecialties: ${$json?.company_info?.specialities}\nProducts / Services: ${$json?.company_info?.products}\n### ICP SCORING GUIDELINES\nTier 1: 50-65 points\nTier 2: 31-49 points\nTier 3: 20-30 points\n--\nFramework Score: \nFactor A: Page Type by URL Structure\n\nScore 3: Sales page visit (URL does not contain \"/blog/\")\nScore 1: Blog or informational page (URL contains \"/blog/\")\n\nFactor B: Framework Relevancy\n\nScore 3: Page EXCLUSIVELY about a framework the company has documented\nScore 2: Page EXCLUSIVELY about single framework company doesn't have (never use for government agencies)\nScore 1: Default score for:\n- Any government agency framework pages\n- Multiple frameworks mentioned\n- Framework implementation status unclear\n- General compliance topics\n- Any uncertainty about framework focus\n`\noriginal.prospect_reports = report\nreturn original\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[22740,720],"id":"fce292c9-0879-4dc8-80c5-6e3d58de21d0","name":"Prospect Report"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"function ensureHttps(url) {\n    // First remove any existing protocol\n    const urlWithoutProtocol = url.replace(/^https?:\\/\\//, '');\n    \n    // Remove query parameters if present\n    const urlWithoutQuery = urlWithoutProtocol.split('?')[0];\n    \n    // Always add https:// prefix\n    return 'https://' + urlWithoutQuery;\n}\n\nif($json.user_info.social_urls.linked_in){\n const newUrl =   ensureHttps($json.user_info.social_urls.linked_in)\n $json.user_info.social_urls.linked_in = newUrl\n}\nif($json.company_info.social_urls.linked_in){\n  const newUrl =  ensureHttps($json.company_info.social_urls.linked_in)\n  $json.company_info.social_urls.linked_in = newUrl\n}\nif($json.technical_data.page_visited_url){\n$json.technical_data.page_visited_url = ensureHttps($json.technical_data.page_visited_url)\n}\n\nreturn $json"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[22360,720],"id":"0d89af9c-1ea1-4f5c-9c6a-a23285f7d325","name":"Data Normalization"},{"parameters":{"content":"# Normalization\n\n","height":660,"width":302},"id":"fb140177-73f7-4afc-a326-1e12b005f93a","name":"Sticky Note9","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[22260,400]},{"parameters":{"content":"# Client validation\n","height":660,"width":2381},"id":"189e4831-2698-429e-a5b7-00eb72a3a89a","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-80,400]},{"parameters":{"content":"# Enrichment workflow\n","height":940,"width":24480,"color":2},"type":"n8n-nodes-base.stickyNote","position":[-120,240],"typeVersion":1,"id":"72fc9b48-cedd-4558-8d59-fb8f5890a472","name":"Sticky Note6"},{"parameters":{"tableId":"website-visitors","fieldsUi":{"fieldValues":[{"fieldId":"client","fieldValue":"={{ $json.technical_data.page_visited_domain }}"},{"fieldId":"user_information","fieldValue":"={{ $json.user_info }}"},{"fieldId":"company_information","fieldValue":"={{ $json.company_info }}"},{"fieldId":"technical_data","fieldValue":"={{ $json.technical_data }}"},{"fieldId":"prospect-report","fieldValue":"={{ $json.prospect_reports }}"},{"fieldId":"email","fieldValue":"={{ $json.user_info.primary_email }}"},{"fieldId":"personalization","fieldValue":"={{ $json.personalization }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[23380,740],"id":"cb1a3c42-42c0-4403-89e2-ab96cd7ea209","name":"Adding enriched data to the database","notesInFlow":true,"credentials":{"supabaseApi":{"id":"AZhuxf9jkjUKSF2O","name":"searchactions.com -  digitalsandwich.agency - Prospect Feed appl"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4fbe6116-052f-4117-986a-49c04a6d1114","leftValue":"={{ $('Getting Client').item.json.subscription }}","rightValue":"Free","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[23120,720],"id":"95f91f24-2a93-42e2-89fd-0f284b3a181b","name":"Extend enrichment ?"},{"parameters":{"operation":"update","tableId":"signup-form","filters":{"conditions":[{"keyName":"company_domain","condition":"eq","keyValue":"={{ $json.technical_data.page_visited_domain }}"}]},"fieldsUi":{"fieldValues":[{"fieldId":"wisitors_identified","fieldValue":"={{ $('Getting Client').item.json.wisitors_identified + 1}}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[23380,900],"id":"5a6e8647-2927-494b-b350-68e7ebf70a29","name":"Updating enrichment count for the Client","notesInFlow":true,"credentials":{"supabaseApi":{"id":"AZhuxf9jkjUKSF2O","name":"searchactions.com -  digitalsandwich.agency - Prospect Feed appl"}}},{"parameters":{"operation":"get","tableId":"website-visitors","filters":{"conditions":[{"keyName":"email","keyValue":"={{ $json.email }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[5180,540],"id":"26409f65-9c41-4b9d-92d1-54c39135a815","name":"Visitor Exists","notesInFlow":true,"alwaysOutputData":true,"credentials":{"supabaseApi":{"id":"AZhuxf9jkjUKSF2O","name":"searchactions.com -  digitalsandwich.agency - Prospect Feed appl"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"cc8f5e78-78e7-4737-b54f-874073a3aec5","leftValue":"={{ $json.id }}","rightValue":"","operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[5400,540],"id":"994fb7d3-23a4-4a20-b2f0-94d632855cd8","name":"Does visitor exist ?"},{"parameters":{"content":"# Checking if visitor is already in the database","height":658,"width":479},"id":"926ebb64-2b4a-4ade-b9c8-021950df5dd4","name":"Sticky Note26","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[5140,400]},{"parameters":{"content":"# Saving to the database \n\n\n","height":660,"width":742},"id":"eb4106f7-6a1e-4838-8847-41a235679090","name":"Sticky Note13","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[23060,400]},{"parameters":{"select":"channel","channelId":{"__rl":true,"value":"={{ $('Getting Client').item.json.slack_channel_name }}","mode":"name"},"messageType":"block","blocksUi":"={\n\t\"blocks\": [\n\t\t{\n\t\t\t\"type\": \"header\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"{{ $json.company_information.icp_score.total_score_string ? $json.company_information.icp_score.total_score_string : 'Prospect Identified'}}\",\n\t\t\t\t\"emoji\": false\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*<{{$json.user_information.social_urls.linked_in ? $json.user_information.social_urls.linked_in : $json.company_information.social_urls.linked_in ? $json.company_information.social_urls.linked_in : 'https://www.linkedin.com/'}} | {{$json.user_information.first_name ? $json.user_information.first_name : ''}}{{ $json.user_information.last_name ? ' ' + $json.user_information.last_name : '' }}{{ $json.user_information.role ? ',' + $json.user_information.role : '' }}{{ $json.company_information.name ? \" at \" + $json.company_information.name :'' }}>*\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"header\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"About {{ $json.user_information.first_name ? $json.user_information.first_name : '' }}{{ $json.user_information.last_name ? \" \" + $json.user_information.last_name : \"\"}}\",\n\t\t\t\t\"emoji\": true\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*Summary:* {{ $json.user_information.report ? $json.user_information.report.replace(/\\\"/g, '\\\\\"').replace(/\\n/g, ' ').trim() : 'Not Generated' }}\"\n\t\t\t},\n\t\t\t\"accessory\": {\n\t\t\t\t\"type\": \"image\",\n\t\t\t\t\"image_url\": \"{{ $json.user_information.profile_pick ? $json.user_information.profile_pick : $json.company_information.logo ? $json.company_information.logo : ''}}\",\n\t\t\t\t\"alt_text\": \"Prospect Profile Picture\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"context\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"‎\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"rich_text\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"rich_text_list\",\n\t\t\t\t\t\"style\": \"bullet\",\n\t\t\t\t\t\"indent\": 0,\n\t\t\t\t\t\"border\": 0,\n\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Name:\",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \" {{$json.user_information.first_name ? $json.user_information.first_name : ''}}{{ $json.user_information.last_name ? \" \" + $json.user_information.last_name  : ''}}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Job Title:\",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \" {{ $json.user_information.role ? $json.user_information.role : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Company: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"{{ $json.company_information.name ? $json.company_information.name : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Email: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"link\",\n\t\t\t\t\t\t\t\t\t\"url\": \"mailto:{{ $json.user_information.primary_email ? $json.user_information.primary_email : $json.user_information.work_email ? $json.user_information.work_email :$json.user_information.personal_email ? $json.user_information.personal_email : '' }}\",\n\t\t\t\t\t\t\t\t\t\"text\": \"{{ $json.user_information.primary_email ? $json.user_information.primary_email : $json.user_information.work_email ? $json.user_information.work_email :$json.user_information.personal_email ? $json.user_information.personal_email : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Page visited: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"link\",\n\t\t\t\t\t\t\t\t\t\"url\": \"{{ $json.technical_data.page_visited_url ? $json.technical_data.page_visited_url : '' }}\",\n\t\t\t\t\t\t\t\t\t\"text\": \"{{ $json.technical_data.page_visited_url ? $json.technical_data.page_visited_url : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Topic of Page: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"{{$json.technical_data.page_visited_topic ? $json.technical_data.page_visited_topic : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"context\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"‎\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"header\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"About {{ $json.company_information.name ? $json.company_information.name : 'Not Found' }}\",\n\t\t\t\t\"emoji\": true\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*Summary:* {{$json.company_information.report ? $json.company_information.report.replace(/\\\"/g, '\\\\\"').replace(/\\n/g, ' ').trim() : 'Not Generated'  }}\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"context\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"‎\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"rich_text\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"rich_text_list\",\n\t\t\t\t\t\"style\": \"bullet\",\n\t\t\t\t\t\"indent\": 0,\n\t\t\t\t\t\"border\": 0,\n\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Company Name:\",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \" {{ $json.company_information.name ? $json.company_information.name : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Location:\",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \" {{$json.user_information.location.city ? $json.user_information.location.city  : ''}}{{ $json.user_information.location.state ? ', ' +$json.user_information.location.state : '' }}{{$json.user_information.location.country ? ', ' + $json.user_information.location.country : '' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Website: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"link\",\n\t\t\t\t\t\t\t\t\t\"url\": \"{{$json.company_information.domain ? $json.company_information.domain : ''  }}\",\n\t\t\t\t\t\t\t\t\t\"text\": \"{{$json.company_information.domain ? $json.company_information.domain : 'Not Found'  }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Industry: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \" {{ $json.company_information.industries[0] ? $json.company_information.industries[0] : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Specialization: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \" {{ $json.company_information.specialities ? $json.company_information.specialities : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Products/Services: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"{{ $json.company_information.products ? $json.company_information.products : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Size: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"{{ $json.company_information.sizes ? $json.company_information.sizes : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Revenue: \",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"{{ $json.company_information.revenue ? $json.company_information.revenue : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"context\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"‎\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"header\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"Prospect Score\",\n\t\t\t\t\"emoji\": true\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"rich_text\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"rich_text_list\",\n\t\t\t\t\t\"style\": \"bullet\",\n\t\t\t\t\t\"indent\": 0,\n\t\t\t\t\t\"border\": 0,\n\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Score:\",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \" {{ $json.company_information.icp_score.total_score_string ? $json.company_information.icp_score.total_score_string : 'Not Calculated' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Reasoning:\",\n\t\t\t\t\t\t\t\t\t\"style\": {\n\t\t\t\t\t\t\t\t\t\t\"bold\": true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \" {{ $json.company_information.icp_score.reasoning ? $json.company_information.icp_score.reasoning.replace(/\\\"/g, '\\\\\"').replace(/\\n/g, ' ').trim() : 'Not Found' }}\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\"elements\": []\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"header\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"How to Use This Information\",\n\t\t\t\t\"emoji\": true\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"rich_text\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"rich_text_list\",\n\t\t\t\t\t\"style\": \"bullet\",\n\t\t\t\t\t\"indent\": 0,\n\t\t\t\t\t\"border\": 0,\n\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Idea 1: Send{{ $json.user_information.first_name ? \" \" + $json.user_information.first_name +\" \" : \"\" }}a LinkedIn message to initiate a conversation \"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"emoji\",\n\t\t\t\t\t\t\t\t\t\"name\": \"point_right\",\n\t\t\t\t\t\t\t\t\t\"unicode\": \"1f449\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\"elements\": []\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"header\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"Example: Send{{ $json.user_information.first_name && $json.user_information.last_name ? $json.user_information.first_name + \" \" + $json.user_information.last_name : ' ' }}a LinkedIn Message\",\n\t\t\t\t\"emoji\": true\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"{{ $json.personalization.linked_in_message ? $json.personalization.linked_in_message.replace(/\\\"/g, '\\\\\"').replace(/\\n/g, ' ').trim() : 'Not Generated' }}\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"actions\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"button\",\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\"emoji\": true,\n\t\t\t\t\t\t\"text\": \"Send this message\"\n\t\t\t\t\t},\n\t\t\t\t\t\"url\": \"{{$json.user_information.social_urls.linked_in ? $json.user_information.social_urls.linked_in : $json.company_information.social_urls.linked_in ? $json.company_information.social_urls.linked_in : 'https://www.linkedin.com/'}}\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"header\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"Want More Prospects? Have Questions?\",\n\t\t\t\t\"emoji\": true\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"Wheather you want to upgrade and reach more than 200 prospects, want us to handle outreach for you, or you or have questions - we're here! Use one of the links bellow to contact us:\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"rich_text\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"rich_text_list\",\n\t\t\t\t\t\"style\": \"bullet\",\n\t\t\t\t\t\"indent\": 0,\n\t\t\t\t\t\"border\": 0,\n\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"link\",\n\t\t\t\t\t\t\t\t\t\"url\": \"https://www.google.com/\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Contact Us\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"link\",\n\t\t\t\t\t\t\t\t\t\"url\": \"https://www.google.com/\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Schedule a Meeting\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\t\t\"elements\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"type\": \"link\",\n\t\t\t\t\t\t\t\t\t\"url\": \"https://www.google.com/\",\n\t\t\t\t\t\t\t\t\t\"text\": \"Frequently Asked Questions\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"rich_text_section\",\n\t\t\t\t\t\"elements\": []\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t]\n}\n\n","otherOptions":{"includeLinkToWorkflow":false,"botProfile":{"imageValues":{"profilePhotoType":"image","icon_url":"https://digitalsandwich.agency/wp-content/uploads/logo-95x100-1-65x68.webp"}},"mrkdwn":true,"unfurl_links":false,"unfurl_media":false}},"id":"844ceee6-d5c5-4e42-9d6d-b02585c19f07","name":"Sending out slack notification","type":"n8n-nodes-base.slack","typeVersion":2.2,"position":[23640,740],"webhookId":"226137ed-702c-45da-9156-6a897fc967d9","retryOnFail":true,"waitBetweenTries":2000,"maxTries":4,"notesInFlow":true,"credentials":{"slackApi":{"id":"RmScu5MfhNQrIDn6","name":"searchactions.com: digitalsandwich.agency  - Prospect Feed"}}},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{"systemMessage":"# ROLE\nYou are an ICP (Ideal Customer Profile) scoring assistant. Your role is to:\n1.  Carefully analyze the provided prospect information against the scoring criteria below\n2.  Score ONLY based on explicitly provided information - do not make assumptions about missing data\n\n3.  Use the lowest applicable score when information is unclear or ambiguous\n4.  Show your work by explaining the reasoning behind each score component\n5.  Maintain consistency in scoring across different prospects\n# IMPORTANT\n- Never infer frameworks that aren't explicitly listed in company information\n- Use exact URL patterns for blog detection (\"/blog/\")\n- Default to Score 1 for any missing or unclear information\n- Follow the binary location scoring strictly (60-mile Philadelphia radius)\n- Round all calculations down to nearest whole number\n- Accuracy is critical.Refer to the information provided to score this prospect.  \n- show the steps you have taken\n- If the prospects company has a compliance framework/certification in place, it will be mentioned in the prospects company information\n- The job titles Founder, Co-founder, Owner, Co-owner, Principle and Partner = Score 4.  \n\n# INSTRUCTIONS FOR SCORING\n\nUsing the provided Scoring Criteria, analyze the prospect information and assign scores accordingly. Ensure that each component is evaluated based solely on the explicitly provided information. Do not make assumptions about any missing data, and default to the lowest applicable score when information is unclear or ambiguous.\nOutput Requirements\n\n- JSON Format: Adhere strictly to the specified JSON structure in the Output Format section.\n- Detailed Scoring Breakdown: After the JSON output, provide a detailed explanation of the reasoning behind each score component.\n- Consistency: Maintain consistency in scoring across different prospects.\n- No Inferences: Do not infer any frameworks or make assumptions beyond the provided data.","maxIterations":10}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[19020,720],"id":"f7ec2d91-ef80-4fc2-b17c-b792f29266c8","name":"ICP Score","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"\nconst prompt = `\n# INFORMATION\n## About Prospect\nTitle: ${$json.user_info.role|| \"\"}\nEmail: ${$json.user_info.work_email ||$json.user_info.primary_email || \"\" }\nLinkedIn: ${$json.user_info.social_urls.linked_in || \"\"}\n\n<About Page Visited>\nThis prospect visited a ${$json.technical_data.page_visited_intent} with the following attributes: \nAbout a Framework/Certification?: ${$json.technical_data.page_visited_framework || \"\"} \nPage Summary: ${$json.technical_data.page_visited_summary || \"\"}\nMain Keyword: ${$json.technical_data.page_visited_topic || \"\"}\n\n## About Prospect Company\nCompany name: ${$json.company_info.name || \"\"}\nCompany Size: ${$json.company_info.size || \"\"}\nCompany Summary: ${$json.company_info.report || \"\"}\nIndustry: ${$json.company_info.industries.join(',') || \"\"}\nSpecialty: ${$json.company_info.specialities || \"\"}\nProducts/Services: ${$json.company_info.products ||\"\"}\nFrameworks/Certifications that ${$json.company_info.name} has:  ${$json.company_info.framework_review.confirmed_frameworks}\n\n\n# ROLE\nYou are an ICP (Ideal Customer Profile) scoring assistant. Your role is to:\n1.  Carefully analyze the provided prospect information against the scoring criteria below\n2.  Score ONLY based on explicitly provided information - do not make assumptions about missing data\n3.  Use the lowest applicable score when information is unclear or ambiguous\n4.  Show your work by explaining the reasoning behind each score component\n5.  Maintain consistency in scoring across different prospects\n6.  Return results in the exact JSON format specified\n# IMPORTANT RULES\n- Never infer frameworks that aren't explicitly listed in company information\n- Use exact URL patterns for blog detection (\"/blog/\")\n- Default to Score 1 for any missing or unclear information\n- Follow the binary location scoring strictly (60-mile Philadelphia radius)\n- Round all calculations down to nearest whole number\n## Scoring Criteria\n\n### 1. Job Title Scoring\n**Weight: 3**\n\n#### Score 4 (High Authority):\n1. **C-Level Executives:**\n   - CISO, CIO, CTO\n   - Chief AI Officer\n   - Chief Risk Officer\n   - Chief Compliance Officer\n   - Chief Security Officer\n2. **VP/Director/Head of Technical Departments:**\n   - Security\n   - Compliance\n   - IT Security\n   - Risk Management\n   - Information Security\n   - Cybersecurity\n   - Data Protection\n   - AI Governance\n   - Technology Risk\n   - Internal Audit\n   - GRC (Governance, Risk and Compliance)\n\n3. ** Owners **\n- Owner, Co-Owner\n- Founder, Co-Founder\n- Partner\n- Principle\n- Other titles indicating full or partial ownership in the company\n\n#### Score 3 (Strong Influence):\n1. **Management of Technical Teams:**\n   - Security Manager\n   - Compliance Manager\n   - IT Audit Manager\n   - Risk Manager\n   - AI Security Architect\n   - Security Operations Manager\n2. **Senior Technical Roles:**\n   - Senior Security Engineer\n   - Senior Compliance Analyst\n   - Senior Risk Analyst\n   - Technical Security Lead\n   - Senior IT Auditor\n3. **Information Systems Security Officer (ISSO)**\n4. **Internal Audit Managers**\n5. **Manager of GRC**\n\n#### Score 2 (Contributing Role):\n1. **Technical Individual Contributors:**\n   - Security Analyst\n   - Compliance Analyst\n   - Risk Analyst\n   - IT Auditor\n   - Security Engineer\n   - GRC Specialist\n2. **Implementation Roles:**\n   - Security Administrator\n   - System Administrator (with security focus)\n   - Technical Support (security systems)\n\n#### Score 1 (Limited Influence):\n1. **Leadership in Non-Technical Departments:**\n   - Head/Director/VP of:\n     - Marketing\n     - Sales\n     - Public Affairs\n     - Communications\n     - HR\n     - Finance\n     - Legal\n     - Operations\n     - Business Development\n2. **Other Roles:**\n   - All other positions not listed above\n   - Unknown titles\n   - Junior positions\n   - Non-security focused roles\n\n#### Scoring Guidelines:\n1. **Title Evaluation Process:**\n   - First, look for exact title matches in the lists above.\n   - If no exact match, look for the closest category.\n   - When in doubt, use the lower score.\n2. **Leadership Title Rules:**\n   - \"Head of\", \"Director of\", \"VP of\" are scored based on their department, not the leadership level.\n   - Only security/compliance/risk departments qualify for Score 4 unless the title indicates ownership in the business.  For example, a person with the title of Founder, Co-founder, Owner, Co-owner, Partner and Principle all indicate the person has equity/ownership in the business - these people qualify for Score 4. \n- Founder, Co-founder, Owner, Co-owner, Principle and Partner = Score 4.  \n   - Leadership of other departments = Score 1.\n3. **Default Positions:**\n   - If role is unclear or ambiguous = Score 1.\n   - If department focus is unclear = Score 1.\n   - If multiple interpretations possible = Use lower score.\n\n**Examples:**\n- **Score 4:**\n  - Chief Information Security Officer\n  - Director of IT Security\n  - VP of Compliance\n  - Head of Information Security\n  - Head of Internal Audit\n  - VP of Internal Audit\n  - Head of GRC\n  - VP of GRC\n- Owner, Co-Owner\n- Founder, Co-Founder\n- Partner\n- Principle\n- **Score 3:**\n  - Security Operations Manager\n  - Senior IT Audit Manager\n  - Compliance Program Manager\n  - Senior Security Architect\n  - Information Systems Security Officer (ISSO)\n  - Internal Audit Manager\n  - Manager of GRC\n- **Score 2:**\n  - Security Analyst\n  - IT Auditor\n  - GRC Specialist\n  - Compliance Administrator\n- **Score 1:**\n  - Head of Public Affairs\n  - Director of Marketing\n  - VP of Sales\n  - Legal Counsel\n  - Business Analyst\n  - Project Manager\n\n#### Calculation:\n- **Determine score (1-4)** based on above criteria.\n- **Multiply by weight of 3**.\n- **Maximum points possible:** 4 × 3 = 12 points.\n\n---\n### 2. Industry Scoring\n**Weight: 2**\n\n#### Special Case - Federal Agencies\nWhen organization is verified as a US Federal Agency (\".gov\" domain or official federal listing):\n- **Automatically qualifies for Score 4** (Target - Government).\n- **Default Size Score:** 4 (Enterprise-level).\n- **Location Score** follows standard rules based on Philadelphia proximity.\n\n#### Scoring Criteria\n- **Score 4 (Target):**\n  - Technology/SaaS (e.g., cloud providers, software developers)\n  - Financial Services (e.g., banks, investment firms)\n  - Healthcare (e.g., hospitals, medical device companies)\n  - Government (e.g., federal agencies)\n  - Computer Software (e.g., cybersecurity vendors)\n- **Score 3 (Related):**\n  - Manufacturing with Tech Focus (e.g., tech-oriented auto manufacturers)\n  - Professional Services (e.g., law firms, consulting firms)\n  - Energy/Utilities (e.g., renewable energy companies)\n- **Score 2 (Adjacent):**\n  - Traditional Manufacturing (e.g., consumer goods manufacturing)\n  - Retail with Digital Focus (e.g., e-commerce platforms)\n  - Education (e.g., universities, e-learning platforms)\n- **Score 1 (Limited Fit):**\n  - Industries with minimal relevance to compliance or technology\n  - Unknown industries\n\n---\n### 3. Location Scoring\n**Weight: 2**\n\n#### Scoring Criteria\n- **Score 4:**\n  - Within 60 miles of Philadelphia, Pennsylvania.\n- **Score 1:**\n  - Any location outside 60 miles of Philadelphia, Pennsylvania.\n\n---\n### 4. Company Size Scoring\n**Weight: 1**\n\n#### Scoring Criteria\n- **Score 4:** 500+ employees.\n- **Score 3:** 100-499 employees.\n- **Score 2:** 50-99 employees.\n- **Score 1:** <50 employees or unknown.\n\n---\n### 5. Framework Scoring\n**Weight: 3**\n\n#### Framework Determination Guidelines\n- **Only count frameworks** explicitly listed in company information provided.\n- **Don't infer frameworks** from blog topics or page visits.\n- **If frameworks are unknown/undocumented, default to Score 1**.\n\n#### Frameworks List:\n- SOC 1\n- SOC 2\n- SOC 3\n- ISO 27001\n- HIPAA\n- PCI DSS\n- HITRUST\n- NIST AI RMF\n- HITRUST AI RMF\n- NIST AI Risk Management\n- NIST Cybersecurity for IoT\n- ISO 42001\n- ISO 50001\n- CMMC\n- CCPA\n- GDPR\n- GLBA\n- FISMA\n- MAR/SOX\n- MARS-E\n- NERC\n- NYDFS\n- NIST CSF\n- SP 800-53\n\n#### Factor A: Number of Frameworks\n- **Score 4:** Three or more frameworks.\n- **Score 3:** Two frameworks.\n- **Score 2:** One framework.\n- **Score 1:** No frameworks or unknown.\n\n#### Total Framework Score Calculation\n- **Total Framework Score = Factor A Score.**\n- **Maximum Score:** 4 (4 from Factor A).\n\n#### Calculation:\n- **Determine score (1-4)** based on the number of frameworks.\n- **Multiply by weight of 3**.\n- **Maximum points possible:** 4 × 3 = 12 points.\n\n---\n### 6. Intent Scoring\n**Weight: 3**\n\n#### Factor A: Page Type by URL Structure\n- **Score 3:** Sales page visit (URL does not contain \"/blog/\").\n- **Score 1:** Blog or informational page (URL contains \"/blog/\").\n\n#### Factor B: Framework Relevancy\n- **Score 3:**\n  - Page is **EXCLUSIVELY** about a framework the company currently has implemented.\n  - Example: Company has SOC 2, visits a page specifically about SOC 2 services.\n- **Score 2:**\n  - Page is **EXCLUSIVELY** about a single framework the company does **NOT** have.\n  - The page must focus on **ONLY ONE** framework.\n  - Example: Company has no HIPAA, visits a page specifically about HIPAA certification.\n- **Score 1:**\n  - **AUTOMATICALLY SCORE 1 IF ANY** of the following are true:\n    - Page mentions more than one framework.\n    - Page is about general compliance topics.\n    - Page is a comparison between frameworks.\n    - Page is a guide or overview.\n    - Page discusses industry trends.\n    - Page contains \"guide\", \"overview\", \"comparison\", or \"process\" in the title.\n    - Any uncertainty about the page's primary focus.\n\n**Examples with Scoring:**\n1. **URL:** \"/blog/guide-hitrust-csf-certification-process/\"\n   - **Factor A:** Score 1 (contains \"/blog/\").\n   - **Factor B:** Score 1 (contains \"guide\" and \"process\").\n   - **Total:** 2\n2. **URL:** \"/soc-2-compliance-services\" (Company has SOC 2)\n   - **Factor A:** Score 3 (no \"/blog/\").\n   - **Factor B:** Score 3 (exclusively about their framework).\n   - **Total:** 6\n3. **URL:** \"/blog/comparing-soc-2-and-iso-27001\"\n   - **Factor A:** Score 1 (contains \"/blog/\").\n   - **Factor B:** Score 1 (compares multiple frameworks).\n   - **Total:** 2\n4. **URL:** \"/hipaa-certification\" (Company has no frameworks)\n   - **Factor A:** Score 3 (no \"/blog/\").\n   - **Factor B:** Score 2 (single framework they don't have).\n   - **Total:** 5\n\n#### Default Positions:\n- **If in doubt, score Factor B as 1.**\n- **Any page with multiple frameworks = Score 1.**\n- **Any page with \"guide\", \"process\", or similar terms = Score 1.**\n- **Only score 2 or 3 when absolutely certain about single framework focus.**\n\n#### Total Intent Score Calculation:\n- **Total Intent Score = Factor A Score + Factor B Score.**\n- **Maximum Score:** 6 (3 from Factor A + 3 from Factor B).\n\n---\n## Final Tier Determination\n\n### Point Calculation\n**Sum of weighted scores:**\n- **Job Title:** Score × 3 (max 12)\n- **Industry:** Score × 2 (max 8)\n- **Location:** Score × 2 (max 8)\n- **Company Size:** Score × 1 (max 4)\n- **Frameworks:** Total Framework Score × 3 (max 12)\n- **Intent:** Total Intent Score × 3 (max 18)\n\n**Maximum Total Points:** 62 points.\n\n### Tier Thresholds\n- **Tier 1:** 50-62 points.\n- **Tier 2:** 31-49 points.\n- **Tier 3:** 20-30 points.\n\n### Modifiers\n- **Local:** If within 60 miles of Philadelphia.\n- **Partner:** If matching partner criteria.\n- **Tier Elevation:** Elevate one tier if within 2 points of the next tier threshold and has a modifier (only one elevation applies).\n\n# ADITIONAL RULES / TASKS\n- Use provided Calculator tool to calculate to total ICP score before you use that score in the summary. Total ICP score is a sum of all total_score's from each category (Job Title Total Score, Inudstry Total Score, Location Total score, Company size score , Frameworks Total Score, Intent Total Score)\n\n# YOUR OUTPUT FORMAT\nThis is very important:\nStrictly follow json schema defined bellow and structure your output based on that:\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"component_scores\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"job_title\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"industry\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"location\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"company_size\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"frameworks\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"factor_a\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"factor_a\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"intent\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"factor_a\": {\n              \"type\": \"number\"\n            },\n            \"factor_b\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"factor_a\",\n            \"factor_b\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        }\n      },\n      \"required\": [\n        \"job_title\",\n        \"industry\",\n        \"location\",\n        \"company_size\",\n        \"frameworks\",\n        \"intent\"\n      ]\n    },\n    \"summary\": {\n      \"type\": \"string\"\n    },\n    \"reasoning\":{\n      \"type\": \"string\"\n    }\n  },\n  \"required\": [\n    \"component_scores\",\n    \"summary\",\n    \"reasoning\"    \n  ]\n}\n`\n\nreturn {prompt:prompt}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[18800,720],"id":"0ff21560-168f-4081-bbab-d43d3126a6f3","name":"ICP Score prompt"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining Framework Review').first().json\nconst scores = $json?.output?.component_scores\nconst summary =$json?.output?.summary\nconst reasoning = $json?.output?.reasoning\n//ICP SCORES\nconst total_score = \n  (scores?.job_title?.total_score || 0) + \n  (scores?.industry?.total_score || 0) + \n  (scores?.location?.total_score || 0) + \n  (scores?.company_size?.total_score || 0) + \n  (scores?.frameworks?.total_score || 0) + \n  (scores?.intent?.total_score || 0);\n\nlet total_score_string = '';\n\nif (total_score >= 50 && total_score <= 62) {\n  total_score_string = '🔥 Great Prospect Identified';\n} else if (total_score >= 31 && total_score <= 49) {\n  total_score_string = '😀 Good Prospect Identified';\n} else if (total_score >= 20 && total_score <= 30) {\n  total_score_string = '☹️ Poor Prospect Identified';\n} else {\n  total_score_string = 'Website Visitor Identified';\n}\n// ICP TITLES\nlet icp_job_title = ''\nif(scores?.job_title?.score == 4){\n  icp_job_title = \"High Authority - \" + original?.user_info?.role\n}else if(scores?.job_title?.score == 3){\n    icp_job_title = \"Strong Influence - \" + original?.user_info?.role\n}else if(scores?.job_title?.score == 2){\n    icp_job_title = \"Contributing Role - \" + original?.user_info?.role\n}else{\n    icp_job_title = \"Limited Influence - \" + original?.user_info?.role\n}\n\nlet icp_company_size = ''\nif(scores?.company_size?.score == 4){\n  icp_company_size = \"500+ Employees\" \n}else if(scores?.company_size?.score == 3){\n  icp_company_size = \"100 - 499 Employees\" \n}else if(scores?.company_size?.score == 2){\n  icp_company_size = \"25 - 99 Employees\" \n}else{\n  icp_company_size = \"Unknown or less than < 25 Employees\" \n}\n\nlet icp_industry = \"\"\nif(scores?.industry?.score == 4){\n  icp_industry = \"Target Industry - \" + original?.company_info?.industries[0] || \"\"\n}else if(scores?.industry?.score == 3){\n  icp_industry = \"Related Industry = \" + original?.company_info?.industries[0] || \"\"\n}else if(scores?.industry?.score == 2){\n  icp_industry = \"Adjacent Industry - \" + original?.company_info?.industries[0] || \"\"\n}else{\n  icp_industry = \"Limited Fit - \" + original?.company_info?.industries[0] || \"\"\n}  \n\nlet icp_local\nif(scores?.location?.score == 4){\n  icp_local = \"Local Prospect\"\n}else{\n  icp_local = \"Not Local\"\n}\n\nlet icp_intent\nif(scores?.intent?.factor_a == 3 && scores?.intent?.factor_b  == 3){\n  icp_intent = \"High Intent Match\"\n}else if(scores?.intent?.factor_a == 3 && scores?.intent?.factor_b == 2){\n  icp_intent = \"High Intent Prospect\"\n}else if(scores?.intent?.factor_a == 3 && scores?.intent?.factor_b == 1){\n  icp_intent = \"General Sales Interest\"\n}else if(scores?.intent?.factor_a == 1 && scores?.intent?.factor_b == 3){\n  icp_intent = \"Research Existing Framework\"\n}else if(scores?.intent?.factor_a == 1 && scores?.intent?.factor_b == 2){\n  icp_intent = \"Research New Framework\"\n}else{\n  icp_intent = \"General Research\"\n}\n\n\n\n\nconst icp = {\ncomponents:{\n  icp_job: icp_job_title,\n  icp_company_size: icp_company_size,\n  icp_industry: icp_industry,\n  icp_local:icp_local,\n  icp_intent: icp_intent\n},\ncomponent_scores:{\n  job_title: scores?.job_title || {},\n  industry: scores?.industry || {},\n  location: scores?.location || {},\n  company_size: scores?.company_size || {},\n  frameworks: scores?.frameworks || {},\n  intent: scores?.intent || {}\n},\nsummary: summary,\nreasoning: reasoning,\ntotal_score_string: total_score_string,\ntotal_score:total_score\n}\n\n\n\n\noriginal.company_info.icp_score = icp\nreturn original "},"type":"n8n-nodes-base.code","typeVersion":2,"position":[19380,720],"id":"cbb9e607-ffeb-4704-852b-885c8ee73adc","name":"Combining ICP score"},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"type\": \"object\",\n  \"properties\": {\n    \"component_scores\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"job_title\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"industry\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"location\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"company_size\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"frameworks\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"factor_a\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"factor_a\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        },\n        \"intent\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"score\": {\n              \"type\": \"number\"\n            },\n            \"factor_a\": {\n              \"type\": \"number\"\n            },\n            \"factor_b\": {\n              \"type\": \"number\"\n            },\n            \"weight\": {\n              \"type\": \"number\"\n            },\n            \"total_score\": {\n              \"type\": \"number\"\n            },\n            \"reasoning\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"score\",\n            \"factor_a\",\n            \"factor_b\",\n            \"weight\",\n            \"total_score\",\n            \"reasoning\"\n          ]\n        }\n      },\n      \"required\": [\n        \"job_title\",\n        \"industry\",\n        \"location\",\n        \"company_size\",\n        \"frameworks\",\n        \"intent\"\n      ]\n    },\n    \"summary\": {\n      \"type\": \"string\"\n    },\n    \"reasoning\":{\n      \"type\": \"string\"\n    }\n  },\n  \"required\": [\n    \"component_scores\",\n    \"summary\",\n    \"reasoning\"    \n  ]\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[19320,940],"id":"a496224c-3ef8-41d4-97f0-47dfc715b421","name":"ICP Output parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"let industries =' '\n\nif($json.company_info.industries.length > 0){\n for(const industry of $json.company_info.industries){\n   industries = industries + \",\" + industry\n }\n}\n\nlet specialities = ``\n\nif($json.company_info.specialities && $json.company_info.specialities.length >0 ){\n for(const spec of $json.company_info.specialities ){\n  specialities += spec + \"\"\n }\n}\nconst prompt = `\n# INFORMATION\n## ABOUT I.S. PARTNERS\nI.S. Partners provides various IT compliance and audit services, including SOC 1, SOC 2, SOC 3, ISO 27001, PCI DSS, and other related certifications. They offer services such as readiness assessments, gap analysis, implementation support, and formal audits to help organizations achieve and maintain compliance with various security and data protection standards. For example, I.S. Partners will help companies achieve ISO-27001 certification or audit a company to ensure they are SOC 2 compliant. \n# IT AUDIT AND COMPLIANCE SERVICES\nHere are the IT audit and compliance services that I.S. Partners offers: \n**IT audit and compliance services**\n- SOC 1\n- SOC 2\n- SOC 3\n- SOC for Cybersecurity\n- SOC for Supply Chain\n- HIPAA/HITECH and HITRUST\n- PCI DSS\n- ISO Certifications (ISO 27001, ISO 42001, ISO 50001)\n- CMMC\n- CCPA and GDPR\n- GLBA\n- FISMA\n- MAR/SOX\n- MARS-E\n- NERC\n- NYDFS\n- Risk Assessments\n**Artificial Intelligence audit and compliance services**\n- NIST AI RMF\n- ISO 42001\n- HITRUST AI RMF\n**Cybersecurity audit and compliance services**\n- NIST CSF\n- SP 800-53\n- NIST Cybersecurity for IoT\n- NIST AI Risk Management (NIST AI RMF)\n# TARGET COMPANY \nCompany name: ${$json.company_info.name}\nWebsite: ${$json.company_info.domain}\nCompany LinkedIn:  ${$json.company_info.social_urls.linked_in}\nIndustry: ${industries}\nSpecialities: ${specialities}\n# CLASSIFICATION GUIDE\n## COMPETITORS\nA competitor would be any company that provides IT compliance and audit services, including SOC 1, SOC 2, SOC 3, ISO 27001, PCI DSS, and other related certifications on the list below. They may offer services such as readiness assessments and gap analysis in addition to implementation support, and formal audits to help organizations achieve and maintain compliance with various security and data protection standards.\n### EXAMPLE - EXISTING COMPETITORS\nBelow is a list of companies that are competitors of I.S. Partners.  This is not a complete list - it is just a few of the thousands of potential competitors.  You can use this list to help you classify the target company as a competitor.   \n- Kirkpatrick Price: A cybersecurity and compliance audit firm specializing in SOC 1, SOC 2, PCI DSS, ISO 27001, and other IT compliance audits, offering a user-friendly platform and expert guidance throughout the audit process12.\n- A-lign: A cybersecurity and compliance solutions provider offering various audit and assessment services, including SOC, ISO, PCI, and HITRUST certifications.\n- Deloitte: A multinational professional services network providing audit, consulting, financial advisory, risk advisory, tax, and legal services across various industries.\n- BARR Advisory: A cloud-based security and compliance solutions provider specializing in cybersecurity consulting and compliance audits for various frameworks.\n- Prescient Security: A cybersecurity consulting firm offering security assessments, penetration testing, and compliance services.\n- RSI Security: A managed security services provider offering comprehensive cybersecurity solutions and compliance services for various industries and regulatory frameworks.\n- Schellman: A global independent security and privacy compliance assessor, providing various IT audit and certification services across multiple frameworks and standards.\n- KPMG: A multinational professional services network offering audit, tax, and advisory services, including IT compliance and cybersecurity solutions.\n- Ernst & Young (EY): A global professional services firm providing assurance, consulting, strategy, transactions, and tax services, including compliance and regulatory advisory services.\n- Hancock Askew & Co.: A regional accounting and advisory firm offering various services, including IT assurance and cybersecurity compliance audits.\n## PARTNERS\nCompanies that offer services and solutions like Cyber Insurance, Legal and Regulatory Consulting, Business Continuity Planning, Financial Auditing, Physical Security, Employee Training, Data Backup, Digital Forensics, Incident Response (DFIR), Managed IT Services, or Cloud Hosting and Infrastructure Services are potential partners. \nThese companies may provide services related to IT Compliance, but if IT compliance and audit services  (e.g., SOC 2 compliance, ISO certification, NIST certification, PCI DSS certification, HITRUST certification,etc.) are not their primary offering, they should be considered as potential partners.\nSpecifically:\n- If a company only provides IT compliance and audit readiness or preperation services, and does not provide the actual audit, they are potential partners. \n- If a company primarily sells these non-compliance services but does not specialize in IT Compliance audits or certifications, they could complement our offerings.\n- They could be a good partner for us in delivering comprehensive solutions where IT Compliance intersects with their services.\n - Such companies are probably not a competitor unless they position themselves as a specialist in IT compliance and audit frameworks like SOC 2 or ISO 27001.\n- Education, Government and Federal organizations are NOT to be considered as either competitors or partners.  You can identify Education organizations because their websites have the .edu domain extension.  Government and Federal organizations have websites and domains that end in .gov.  DO NOT CLASSIFY EDUCATION OR GOVERNMENT (LOCAL OR FEDERAL) ORGANIZATIONS AS COMPETITORS OR PARTNERS.\nIdentify companies as potential partners if they do not provide IT and cybersecurity compliance, certification, audits, and assessments as their core service or solution offering.\n### EXAMPLE - EXISTING PARTNERS\nHere are our existing partners.  You can use these companies to help classify partner opportunities: \n- 3factor: Cybersecurity consulting firm offering white glove cybersecurity solutions.\n- Alvarez Technology Group Inc: Provider of IT services and consulting in Salinas.\n- Arrakis Consulting: Full-service cybersecurity company specializing in various cybersecurity solutions.\n- Axiotrop: Offers cybersecurity assessment, remediation, and validation services.\n- Bemo: SaaS provider specializing in Hosted Project Portfolio Management solutions.\n- CTN Solutions: Managed IT service provider offering various IT services.\n- Connectivtech: Fractional CTO organization specializing in IT Procurement and vendor management.\n- Consilium Labs: Specializes in ISO certification services, particularly ISO/IEC 27001.\n- DEKRA: Global expert organization dedicated to safety across various industries.\n- Delaney Computer Services, Inc.: Provides managed IT services, cybersecurity, and IT support.\n- Drata: Advanced security and compliance automation platform.\n- Eden Data: Cybersecurity company providing virtual CISO leadership and professional services.\n- Fieldguide: Enterprise software company offering automation and collaboration software for risk and compliance.\n- GRSee Consulting: Information security firm from Israel with expertise in leading cybersecurity projects.\n- HITRUST Alliance: Focuses on information and privacy security, regulatory compliance, and risk management.\n- Ihloom: Managed cybersecurity company providing critical and comprehensive cybersecurity services.\n- KPInterface: Managed Security Service Provider (MSSP) based in Philadelphia.\n- Lumifi Cyber: Managed Security Service Provider (MDR) based in Scottsdale, AZ.\n- Magna5: Offers managed IT, cybersecurity, data backup & recovery, SD WAN, and cloud solutions.\n- Pondurance: Provides managed detection and response services backed by human intelligence.\n- PreVeil: Offers end-to-end encryption solutions for email, file sharing, and more.\n- Raxis LLC: Top-tier penetration testing services company based in Atlanta.\n- Sniper Watch: Provider of AI-powered cybersecurity solutions.\n- Subrosa Cyber: Cybersecurity company specializing in expert penetration testing services.\n- Twintel: IT company providing comprehensive IT services to Orange County, CA businesses.\n- Valander Group: Veteran-owned consortium of subject matter experts in various fields.\n- nGuard, Inc.: Provides info security solutions with security experts and custom-tailored services.\n# TASK\n1. Determine if the target company is an educational institution or government (local or federal) agency or organization.  If it is, do not progress to step 3.  Terminate the task. Government organizations/agencies can usually be identified by their website or domain, which has the .gov domain extension.  Educational institutions can be determined by their website or domain, which ends in .edu.\n2. Carefully analyze what the target company does - what services, solutions and products they sell or offer and describe it in one or two sentences.  \n3. Carefully compare the services and solutions that I.S. Partners provides to the those of the target company ( ${$json.company_info.name}) and determine if the target company is a competitor.\n4. Carefully compare the services and solutions that I.S. Partners provides to the those of the target company ( ${$json.company_info.name}) and determine if the target company is a potential partner.\n5. Make a clear determination of whether the target company is a competitor or I.S. Partners or a potential partner of I.S. Partners, or neither.  You will classify the target company based on the solutions and services they offer compared to I.S. Partners\n6. Explain your reasoning\n7. If a target company is neither a competitor or partner, do nothing.  \n8. You are judged on accuracy and not how many companies you identify as competitors or partners. \n# CRITICAL RULES\n1. If a company provides or sells an IT audit or compliance service that I.S. Partners offers, it is a competitor.  \n2. Only classify as PARTNER if you can confirm they don't perform competing services\n3. Focus on actual services offered, not just marketing language\n4. Government and federal agencies and organizations with websites that end in .gov are NOT competitors or partners. \n5. Companies that provide GRC software in a SaaS (Software as a Service) model are not typically competitors but partners. These companies provide software that helps organizations and auditors facilitate compliance audits or certifications. They typically do not provide the actual audit itself, so they would be considered partners. These companies include Drata, Vanta, SecureFrame, OneLogic, etc. \n6. A company may have achieved IT compliance or certification, but that does not influence if they are a partner or competitor.  For example, a target company may have achieved SOC 2 Compliance and mentions it on their website, but this has no influence on their standing as a potential partner or competitor.  Do not consider - or look for - if the company has achieved IT compliance or certification.  ONLY IF THEY PROVIDE SOLUTIONS TO OTHER COMPANIES TO HELP THEM ACHIEVE COMPLIANCE.  \n8. Only consider the IT compliance and audit solutions that I.S. Partners offers when considering if a target company is a potential partner or competitor.  Companies that offer compliance audits or certifications outside of what I.S. Partners offers are not in competition with I.S. Partners.\n# OUTPUT\nFormat your response in JSON\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"is_government\": {\n      \"type\": \"boolean\",\n      \"description\": \"\"\n    },\n    \"is_partner\": {\n      \"type\": \"boolean\",\n      \"description\": \"\"\n    },\n    \"is_competitor\": {\n      \"type\": \"boolean\",\n      \"description\": \"\"\n    },\n    \"confidence_level\": {\n      \"type\": \"string\",\n      \"description\": \"\"\n    },\n    \"services_offered\": {\n      \"type\": \"string\",\n      \"description\": \"\"\n    },\n    \"competitor_partner_reasoning\": {\n      \"type\": \"string\",\n      \"description\": \"\"\n    },\n    \"competitor_partner_confidence\": {\n      \"type\": \"string\",\n      \"description\": \"\"\n    }\n  },\n  \"required\": [\n    \"is_government\",\n    \"is_partner\",\n    \"is_competitor\",\n    \"confidence_level\",\n    \"services_offered\",\n    \"competitor_partner_reasoning\",\n    \"competitor_partner_confidence\"\n  ]\n}\n# ACCURACY STATEMENT\nYour classification is critical.  Accuracy is of the utmost importance.  Incorrect classification of a target company can destroy your relationship with us and terminate the agreement.  Your output must be as accurate as possible. \n`\n\nreturn {prompt: prompt}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[13200,720],"id":"77c5ecd3-719c-40b7-a41f-f6da71b1ac72","name":"Competitor Partner classification - prompt"},{"parameters":{"jsonSchemaExample":"{\n  \"is_government\": \"False\",\n  \"is_partner\": \"True\",\n  \"is_competitor\": \"False\",\n  \"services_offered\": \"Cloud Hosting and Managed IT Services\",\n  \"competitor_partner_reasoning\": \"The target company offers Managed IT Services and Cloud Hosting, which complements the services offered by I.S. Partners. They do not seem to have a focus on IT Compliance and Audit services like SOC 2 or ISO 27001, making it not a competitor but a potential partner.\",\n  \"competitor_partner_confidence\": \"High\",\n  \"steps_taken\": [\"Checked the target company's website and LinkedIn\"],\n  \"reasoning\": \"The offered services by the target company are not in competition with I.S. Partners. Their focus on Managed IT Services and Cloud Hosting is potentially beneficial and can complement I.S. Partners' offerings.\",\n  \"confidence_level\": \"High\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[13640,920],"id":"a3594169-aff1-445e-85be-dfe2110ec64d","name":"Competitor/Partner Classification Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"let original = $('Combining Contact non-public information').first().json\nlet classification = {\n is_government:$json?.output?.is_government || \"\",\n is_partner: $json?.output?.is_partner || \"\",\n is_competitor: $json?.output?.is_competitor || \"\",\n services_offered:$json?.output?.services_offered  || \"\",\n competitor_partner_reasoning: $json?.output?.competitor_partner_reasoning || \"\",\n competitor_partner_confidence:  $json?.output?.competitor_partner_confidence || \"\",\n steps_taken: $json?.output?.steps_taken || [],\n reasoning: $json?.output?.reasoning || \"\",\n confidence_level: $json?.output?.confidence_level || \"\"\n}\n\noriginal.company_info.partner_classification = classification\n\nreturn original"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[13820,720],"id":"4d7db2de-ae4b-4edd-9375-90d929a13677","name":"Combining Competitor/Partner Classification"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const prompt = `\n### ROLE\nYou are an expert data verification specialist with advanced skills in online research and business intelligence. You identify accurate information using publicly available data.\n### INFORMATION\nCompany name: ${$json.company_info.name}\nSummary: ${$json.company_info.report}\nWebsite: ${$json.company_info.domain}\nCompany LinkedIn: ${$json.company_info.social_urls.linked_in}\nIndustry: ${$json.company_info.industries}\nSpecialties: ${$json.company_info.specialities}\n\n\n### TASK\nLet's find out what compliance certifications and frameworks this company has.  \n1. Compliance Frameworks/Certifications: Identify security and compliance frameworks from the specified list (e.g., SOC 1, SOC 2, HIPAA, HITRUST, PCI DSS, ISO 27001, etc.).\n2. Vendors/Certifying Bodies: Look for mentions of vendors, auditing firms, or certifying bodies responsible for issuing the certifications (e.g., \"audited by [Vendor]\" or \"certified by [Auditor]\").\n3. Certification Validity Timeframes: Capture the certification’s start and expiration dates (e.g., \"valid from [date]\" or \"expires on [date]\").\n\nTarget Frameworks/Certifications:\n- SOC 1\n- SOC 2\n- SOC 3\n- ISO 27001\n- HIPAA\n- PCI DSS\n- HITRUST\n- NIST AI RMF\n- HITRUST AI RMF\n- NIST AI Risk Management\n- NIST Cybersecurity for IoT\n- ISO 42001\n- ISO 50001\n- CMMC\n- CCPA\n- GDPR\n- GLBA\n- FISMA\n- MAR/SOX\n- MARS-E\n- NERC\n- NYDFS\n- NIST CSF\n- NIST SP 800-53\n### SEARCH TARGETS\n1.  Trust Center, Security, and Compliance Pages:\n   - Focus on pages or sections that reference \"Trust Center,\" \"Security,\" \"Compliance,\" or \"Certifications.\"\n   - **Keywords:** \"SOC 2,\" \"HIPAA,\" \"ISO 27001,\" \"PCI DSS,\" \"certified by,\" \"audited by,\" \"framework,\" \"vendor,\" \"security page,\" \"compliance certifications.\"\n2. Press Releases and Blog Announcements:\n   - Focus on announcements of new certifications, renewals, or partnerships with auditing firms or vendors.\n   - Keywords: “SOC 2 certified,” “ISO 27001 certification,” “audit completed by [Vendor],” “compliance certification announcement.”\n3. Corporate Reports (Annual, Security, Governance):\n   - Search for security or governance reports that summarize compliance frameworks from the list. Look for references to auditing firms and certification validity periods.\n4. Search Engines\n- Searches:\n- site: ${$json.company_info.domain}  trust center\n- site:  ${$json.company_info.domain}\n\n <framework/certification>\n- intext:\"${$json.company_info.domain} trust center\"\n- intext:\"${$json.company_info.domain} compliance\"\n-  \"${$json.company_info.domain}\"\n\n\n  <framework> certification/compliance \n- Keywords: “Annual Security Report,” “Governance Report,” “SOC 2 certification,” “compliance summary,” “audited by [Vendor],” “valid from [date].”\n5. Frameworks/Certifications: SOC 1, SOC 2, SOC 3, HIPAA, HITRUST, ISO 27001, PCI DSS, CMMC, GDPR, NIST AI RMF, cybersecurity frameworks.\n6. Vendors/Certifying Bodies: Audited by, certified by, issued by, audit firm, vendor, certifying authority, security partner.\n\n### Fields Explained:\n1. **company_name:** The name of the company from which the data is scraped.\n   \n2. **compliance_frameworks:** An array that lists each compliance framework or certification the company has implemented. Each entry contains:\n    - **framework_name:** The name of the compliance framework or certification (e.g., SOC 2, ISO 27001).\n    - **vendor:** The auditing firm, vendor, or certifying body responsible for issuing or verifying the certification (e.g., \"Audited by [Vendor]\").\n    - **validity_period:** An object that includes:\n        - **valid_from:** The start date of the certification or audit validity.\n        - **expires_on:** The expiration or renewal date for the certification.\n  \n3. **source:** The URL of the page from which the data was extracted, for tracking and verification purposes.\n\n### Example JSON Response:\n\n- **Timeframes:** Valid from, valid until, expires on, certification period, issued on, expiry date, validity, renewal date.\n### IMPORTANT\n- You must ensure that you are researching the correct company.  Many companies have similar names and domains.  The company you are researching is called ${$json.company_info.name}, has \n${$json.company_info.domain} as their domain and can be found at this linkedin page: ${$json.company_info.social_urls.linked_in}\n\n\n\n  \n- Be aware that GDPR, CCPA, HIPAA and other privacy certifications and frameworks are often mentioned on websites because the company complies with them.  This may not mean they are actually certified to be compliant.  For example, many websites have a cookie acknowledgement that visitors have to acknowledge.  These cookie policies often mention GDPR and CCPA.  Do not confuse this with the actual certification.  \n- If you are taking information from an online source, such as a Press Release, the information in the \"About\" section (or other section that contains the company's contact information) you must verify that the company mentioned is the same EXACT company as our prospect. \n- Many websites impersonate ${$json.company_info.name} - you will ensure that if you visit ${$json.company_info.name}'s website, that you are visiting the domain ${$json.company_info.domain}\n.  \n\n### FICTIONAL EXAMPLES\n- Our target company is called Vector and you were told their website/domain is vector.co.  During a Google Search you find a company called Vector Solutions and you visit their website at vectorsolutions.com.  You should not be on vectorsolutions.com because it is the domain of the wrong company.   You risk providing the world with fake, harmful information. \n- Our target company is Acme with a website/domain at acme.net.  You search Google and find a press release that mentions Acme has achieved HITRUST Certification.  At the bottom of the press release, there is an about section.  In the about section, the company Acme is mentioned, along with the website acme.net.  This is a reliable press release because the website/domain matches the target company. \n# Example 3\nOur target company is called Giant Inc and have the website/domain smallthings.com.  You search Google and find a result that says \"Giant achieves ISO 27001 Certification\".  You click to the website, which is at smallthings.com.jp and owned by a company called \"Giant Small Things\".  Since the domains do not match and the company names do not match exactly, you will not consider this website.  You are putting the world at risk of contaminating it with fake information because you are not on the correct companys website. \n\n### YOUR RESPONSE  / EXAMPLES\n- Your response should be structured following this object:\n{\n\"SOC_1\": \"false\",\n\"SOC_2\": \"true\",\n\"HIPAA_HITECH\": \"true\",\n\"PCI_DSS\": \"false\",\n\"ISO_27001\": \"false\",\n\"ISO_42001\": \"false\",\n\"ISO_50001\": \"false\",\n\"CMMC\": \"false\",\n\"CCPA\": \"true\",\n\"GDPR\": \"true\",\n\"GLBA\": \"false\",\n\"FISMA\": \"false\",\n\"MAR_SOX\": \"false\",\n\"MARS_E\": \"false\",\n\"NERC\": \"false\",\n\"NYDFS\": \"false\",\n\"NIST_AI_RMF\": \"false\",\n\"HITRUST_AI_RMF\": \"false\",\n\"NIST_CSF\": \"false\",\n\"NIST_SP_800_53\": \"false\",\n\"NIST_Cybersecurity_for_IOT\": \"false\",\n\"website_found_on\": \"Example1.com\",\n\"steps_taken\" : [\"Performed a Google Search on the company\", \"Checked the company’s website for trust center or security pages\", \"Verified the information on LinkedIn\", \"Scrutinized their blog posts\", \"Cross-referenced with reliable third-party platforms\"],\n\"reasoning\":\"The company's trust center on their website made it clear that they are SOC 2, HIPAA and CCPA compliant, and adhere to GDPR regulations. They have not released any information about their compliance with other frameworks or certifications.\",\n\"confidence_level\": \"High\"\n}\n`\n\nreturn {prompt: prompt}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[15260,720],"id":"fa83df01-7b5d-4330-941f-2b001b53e82d","name":"Find frameworks prompt"},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{"systemMessage":"### ROLE: Partner/Competitor Classification Assistant\n\nYou are a classification assistant responsible for analyzing companies to determine if they are competitors or potential partners of I.S. Partners. Your primary goal is to protect I.S. Partners from inadvertently marketing to competitors while identifying valuable partnership opportunities."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[13420,720],"id":"a3f7792b-0320-43ab-9eb7-14a36d8cc912","name":"Competitor / Partner agent","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[15500,720],"id":"99741021-2135-4d12-ae49-957bef50046e","name":"Framework Agent - First","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"jsonSchemaExample":" {\n    \"SOC_1\": \"\",\n    \"SOC_2\": \"\",\n    \"HIPAA_HITECH\": \"\",\n    \"PCI_DSS\": \"\",\n    \"ISO_27001\": \"\",\n    \"ISO_42001\": \"\",\n    \"ISO_50001\": \"\",\n    \"CMMC\": \"\",\n    \"CCPA\": \"\",\n    \"GDPR\": \"\",\n    \"GLBA\": \"\",\n    \"FISMA\": \"\",\n    \"MAR_SOX\": \"\",\n    \"MARS_E\": \"\",\n    \"NERC\": \"\",\n    \"NYDFS\": \"\",\n    \"NIST_AI_RMF\": \"\",\n    \"HITRUST_AI_RMF\": \"\",\n    \"NIST_CSF\": \"\",\n    \"NIST_SP_800_53\": \"\",\n    \"NIST_Cybersecurity_for_IOT\": \"\",\n    \"website_found_on\": \"\",\n   \"steps_taken\" : [\"Searched through company’s public statements\", \"Perused multiple blogs\", \"Reviewed statements from leadership\"],\n\"reasoning\":\"Though the company hasn't officially confirmed using Secureframe, their public statements and blogs strongly hint at its usage. The company also appears to be proactive about their compliance journey.\",\n\"confidence_level\": \"Low\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[15720,920],"id":"a71e7ab6-e5e5-4062-9339-20598c4f37e7","name":"Framework First - Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"\nconst company_name = $('Combining Competitor/Partner Classification')?.first()?.json?.company_info?.name || \"\"\nconst company_summary = $('Combining Competitor/Partner Classification')?.first()?.json?.company_info?.report || \"\"\nconst domain = $('Combining Competitor/Partner Classification')?.first()?.json?.company_info?.domain || \"\"\nconst linked_in = $('Combining Competitor/Partner Classification').first()?.json?.company_info?.social_urls?.linked_in || \"\"\nconst industry = $('Combining Competitor/Partner Classification')?.first()?.json?.company_info?.industries || []\nconst specialities = $('Combining Competitor/Partner Classification')?.first()?.json?.company_info?.specialities || []\n\n\nconst prompt = `\n### ROLE\nYou are an expert data verification specialist and IT compliance analyst with advanced skills in online research and business intelligence. You identify accurate information using publicly available data.\n### INFORMATION\nCompany name: ${company_name}\nSummary: ${company_summary}\nWebsite: ${domain}\nCompany LinkedIn: ${linked_in}\nIndustry: ${industry}\nSpecialties: ${specialities}\n\n### TASK\nYour task is to analyze the given text about a company and determine which compliance frameworks and certifications they have implemented or adhere to. Please provide a true/false response for each of the following frameworks and certifications based on the information provided. If there's not enough information to determine, mark it as \"False.\"\n## IT Compliance and Certification:\n- SOC 1: [True/False]\n- SOC 2: [True/False]\n- HIPAA/HITECH and HITRUST: [True/False]\n- PCI DSS: [True/False]\n- ISO 27001: [True/False]\n- ISO 42001: [True/False]\n- ISO 50001: [True/False]\n- CMMC: [True/False]\n- CCPA and GDPR: [True/False]\n- GLBA: [True/False]\n- FISMA: [True/False]\n- MAR/SOX: [True/False]\n- MARS-E: [True/False]\n- NERC: [True/False]\n- NYDFS: [True/False]\n\n## Artificial Intelligence Compliance:\n- NIST AI RMF: [True/False]\n- ISO 42001: [True/False]\n- HITRUST AI RMF: [True/False]\n\n## Cybersecurity and Risk Management:\n- NIST CSF: [True/False]\n- NIST SP 800-53: [True/False]\n- NIST Cybersecurity for IoT: [True/False]\n- NIST AI Risk Management: [True/False]\n### SEARCH TARGETS\nBelow are just a few ways you can find out what compliance frameworks that ${company_name} has:\n1.  Trust Center, Security, and Compliance Pages on ${domain}:\n   - Focus on pages or sections that reference \"Trust Center,\" \"Security,\" \"Compliance,\" or \"Certifications.\"\n\n\n2. Press Releases and Blog Announcements:\n   - Focus on announcements of new certifications, renewals, or partnerships with auditing firms or vendors.    They may mention keywords such as \"[framework/certification] certified,\" \"[framework/certification] certification,\" \"audit completed by [Vendor],\" \"compliance certification announcement,\" \"[framework/certification] report issued\"\n\n3. Corporate Reports (Annual, Security, Governance):\n   - Search for security or governance reports summarizing compliance frameworks from the list. Look for references to auditing firms and certification validity periods. They may mention keywords such as \"Annual Security Report,\" \"Annual Impact Report,\" \"Governance Report,\" \"[framework/certification] certification,\" \"compliance summary,\" \"audited by [Vendor],\" \"valid from [date].\"\n4. Search Engines\n- Searches:\n- site:\"${domain} [framework/certification]\"\n- intext:\"${domain} trust center\"\n- intext:\"${domain} compliance\"\n-  \"${domain}\" achieves  [framework/certification]\n5. Vendors/Auditors/Certifying Bodies:  The companies that helped them achieve compliance or certification may mention it on their websites or in press releases.  They may mentioned things like Audited by, certified by, issued by, audit firm, vendor, certifying authority, security partner.\n6. GRC Software Vendors: Companies such as Drata, Vanta, Secureframe, OneLogic and others often have case studies or testimonials from companies who have used them to help facilitate the audit or certification.\n### EVALUATION GUIDELINES\nWhen assessing compliance claims, verify:\n## Credibility\n- Is it from an official source (company domain, verified auditor, or industry database)?\n- Are specific auditors, dates, and certification details provided?\n- Do multiple sources confirm the same information?\n## Currency\n- Is the certification active and maintained?\n- Are there recent updates or ongoing activities?\n- Watch for outdated claims or expired certifications\n## Red Flags\n- Generic compliance statements without specifics\n- Claims mismatched with industry/business type\n- Information only in privacy policies/terms\n- Missing key details (dates, auditors, scope)\n### OUTPUT EXAMPLES\nThese output examples are completely fake examples and are not to be used in your research.  They are provided to you strictly as an example and are completely fake.  Including these examples in your research will void our contract with the company and destory the relationship.   \n\nExample 1:\nImagine you found a \"Security and Compliance\" page on ${domain} which states that ${company_name} has been ISO 27001 certified since 2017, is also certified with SOC 2, complies with HIPAA and GDPR, and is currently working towards ISO 50001 certification.\n\nThe response format following the information provided would be:\n{\n    \"SOC_1\": \"False\",\n    \"SOC_2\": \"True\",\n    \"HIPAA_HITECH\": \"True\",\n    \"PCI_DSS\": \"False\",\n    \"ISO_27001\": \"True\",\n    \"ISO_42001\": \"False\",\n    \"ISO_50001\": \"False\",\n    \"CMMC\": \"False\",\n    \"CCPA\": \"True\",\n    \"GDPR\": \"True\",\n    \"GLBA\": \"False\",\n    \"FISMA\": \"False\",\n    \"MAR_SOX\": \"False\",\n    \"MARS_E\": \"False\",\n    \"NERC\": \"False\",\n    \"NYDFS\": \"False\",\n    \"NIST_AI_RMF\": \"False\",\n    \"HITRUST_AI_RMF\": \"False\",\n    \"NIST_CSF\": \"True\",\n    \"NIST_SP_800_53\": \"True\",\n    \"NIST_Cybersecurity_for_IOT\": \"False\",\n    \"website_found_on\": \"${domain}/security-compliance\",\n    \"steps_taken\" : [\"Checked company's official 'Security and Compliance' page\"],\n    \"reasoning\":\"The information was obtained from the company's official website which mentions their complete compliances\",\n    \"confidence_level\": \"High\"\n} \nExample 2:\nImagine you found a blog post on ${domain} that says ${company_name} is working towards achieving the SOC 1 certification but hasn't yet achieved it. Logically, they wouldn't have SOC 2 or SOC 3 certifications either if they are still working towards SOC 1.\n\nThe response format following the information provided would be:\n{\n    \"SOC_1\": \"False\",\n    \"SOC_2\": \"False\",\n    \"HIPAA_HITECH\": \"False\",\n    \"PCI_DSS\": \"False\",\n    \"ISO_27001\": \"False\",\n    \"ISO_42001\": \"False\",\n    \"ISO_50001\": \"False\",\n    \"CMMC\": \"False\",\n    \"CCPA\": \"False\",\n    \"GDPR\": \"False\",\n    \"GLBA\": \"False\",\n    \"FISMA\": \"False\",\n    \"MAR_SOX\": \"False\",\n    \"MARS_E\": \"False\",\n    \"NERC\": \"False\",\n    \"NYDFS\": \"False\",\n    \"NIST_AI_RMF\": \"False\",\n    \"HITRUST_AI_RMF\": \"False\",\n    \"NIST_CSF\": \"False\",\n    \"NIST_SP_800_53\": \"False\",\n    \"NIST_Cybersecurity_for_IOT\": \"False\",\n    \"website_found_on\": \"${domain}/blog\",\n    \"steps_taken\" : [\"Searched through company’s public statements\", \"Perused multiple blogs\"],\n    \"reasoning\":\"Just a single blog post indicating the company's intention to get SOC 1 certification. No official recognition of any other certifications.\",\n    \"confidence_level\": \"Low\"\n} \n\n### IMPORTANT\n- You must ensure that you are researching the correct company.  Many companies have similar names and domains.  The company you are researching is called ${company_name}, has ${domain} as their domain and can be found at this linkedin page: ${linked_in}\n\n- Be aware that GDPR, CCPA, HIPAA and other privacy certifications and frameworks are often mentioned on websites because the company complies with them.  This may not mean they are actually certified to be compliant.  For example, many websites have a cookie acknowledgement that visitors have to acknowledge.  These cookie policies often mention GDPR and CCPA.  Do not confuse this with the actual certification.  \n- If you are taking information from an online source, such as a Press Release, the information in the \"About\" section (or other section that contains the company's contact information) you must verify that the company mentioned is the same EXACT company as our prospect.  \n`\n\nreturn {prompt:prompt}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[16180,720],"id":"a0191c8e-41f1-4fe2-9025-241e8641d787","name":"Find frameworks - second prompt"},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[16380,720],"id":"87f31ced-00ed-4cda-8ec3-13b1fb4c80ee","name":"Framework Agent - Second","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"jsonSchemaExample":" {\n    \"SOC_1\": \"\",\n    \"SOC_2\": \"\",\n    \"HIPAA_HITECH\": \"\",\n    \"PCI_DSS\": \"\",\n    \"ISO_27001\": \"\",\n    \"ISO_42001\": \"\",\n    \"ISO_50001\": \"\",\n    \"CMMC\": \"\",\n    \"CCPA\": \"\",\n    \"GDPR\": \"\",\n    \"GLBA\": \"\",\n    \"FISMA\": \"\",\n    \"MAR_SOX\": \"\",\n    \"MARS_E\": \"\",\n    \"NERC\": \"\",\n    \"NYDFS\": \"\",\n    \"NIST_AI_RMF\": \"\",\n    \"HITRUST_AI_RMF\": \"\",\n    \"NIST_CSF\": \"\",\n    \"NIST_SP_800_53\": \"\",\n    \"NIST_Cybersecurity_for_IOT\": \"\",\n    \"website_found_on\": \"\",\n    \"steps_taken\" : [\"Searched through company’s public statements\", \"Perused multiple blogs\", \"Reviewed statements from leadership\"],\n    \"reasoning\":\"Though the company hasn't officially confirmed using Secureframe, their public statements and blogs strongly hint at its usage. The company also appears to be proactive about their compliance journey.\",\n    \"confidence_level\": \"Low\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[16600,940],"id":"b5b081c7-1f90-4cc4-aec2-1a4129844c9a","name":"Framework Second - Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const prompt = `\n<ROLE>\nYou are an Audit Intelligence Analyst who identifies audit vendors and GRC (Governance, Risk, and Compliance) tooling from company compliance documentation. You provide accurate, structured analysis of companies' compliance vendors and tools.\n<INFORMATION>\nCompany Name: ${$json.company_info.name}\nCompany Website: ${$json.company_info.domain} \nDomain: ${$json.company_info.domain}\nOur research found the following information about ${$json.company_info.name} that may be helpful to this task: ${$json.company_info.report}\n\n<TASK>\nPlease analyze ${$json.company_info.name}'s compliance documentation and identify:\n1. The auditor(s) or third-party firm(s) that conducted their compliance assessments. \n2. The GRC (Governance, Risk, and Compliance) platform or software used to manage their compliance program\n3. Bonus Insights to Watch For:\n- Specific Dates: Audit completion, certification dates\n- Integration Tools: Cloud providers, identity providers, monitoring tools\n- Team Structure: Internal security team vs. external partners\n- Assessment Frequency: Annual, quarterly, continuous monitoring\n- Auditor Change: Certification done by a new external auditor than previous years\n\n<REFERENCES AND EXAMPLES>\n**Auditors and GRC Platforms**\nThe auditor and GRC tool providers below are not a complete list and are provided as reference.  You must find the actual auditors and software associated with ${$json.company_info.name}'s certifications, audits and frameworks. \nExamples of auditors:\n- Schellman & Company\n- A-LIGN\n- Kirkpatrick Price\n- Deloitte\n- Ernst & Young (EY)\n- KPMG\n- PricewaterhouseCoopers (PwC)\nExamples of GRC Software/Platforms:\n- Vanta\n- Drata\n- Secureframe\n- OneTrust\n- LogicGate\n- ZenGRC\n- Hyperproof\n- Sprinto\n**OUTPUT EXAMPLES**\nThese output examples are completely fake examples and are not to be used in your research.  They are provided to you strictly as an example and are completely fake.  Including these examples in your research will void our contract with the company and destory the relationship.   \nOutput Example 1: \nInput: \"As stated in our SOC 2 Type II report issued by Schellman & Company LLC in December 2023, we maintain comprehensive controls... Our compliance program is managed through the Vanta platform...\"\nOutput:{\n\"auditors\": [\"A-LIGN\"],\n\"grc_tools\": [\"OneTrust\"],\n\"confidence_auditor_grc\": \"high\",\n\"source\": \"Company's compliance documentation\",\n\"frameworks\":[\"SOC 1\",\"SOC 2\",\"SOC 3\"],\n\"notes\": \"The company has explicitly mentioned that they got their certification audits done from A-LIGN. They manage their compliance program using the OneTrust software.\",\n\"bonus_info\":\"The last audit got completed in May 2024. They have an internally driven security team, and a new CISO was hired recently. Their assessments are conducted annually.\",\n\"steps_taken\" : [\"Inspected the company’s compliance documentation\", \"Perused their website\", \"Looked at recent public disclosures\"],\n\"reasoning\":\"The information regarding the auditors and GRC tools was directly available in the company's compliance documentation. The recent hiring of a new CISO indicates a focus on strengthening internal security protocols.\",\n\"confidence_level\": \"High\"\n}\nOutput Example 2:\nThis is a completely fake example and is not to be used in your research.  It is provided only as an example and is completely fake.  Including it in your research will void our contract with the company. \nYour Research: You found that the company has a Trust Center on their website.  Within the Trust Center you found a section that mentioned the company achived ISO 27001 certification, but did not find mention of an auditor or GRC tool used.  However, you found a press-release from an auditor called \"Bobs Auditing\" announcing that they helped the company achieve certification\nOutput:\n{\n\"auditors\": [\"Ernst & Young (EY)\"],\n\"grc_tools\": [\"Not Found\"],\n\"confidence_auditor_grc\": \"medium\",\n\"source\": \"Public reports and information on the company's website\",\n\"frameworks\":[\"ISO 27001\",\"HIPAA\"],\n\"notes\": \"According to public reports and information available on the company's website, Ernst & Young carried out their certification audits. No specific GRC tool was mentioned.\",\n\"bonus_info\":\"The company underwent an audit in December 2023. They seem to have a mixed team structure with internal security professionals and support from EY for their audit. HIPAA certification was done last year.\",\n\"steps_taken\" : [\"Reviewed public reports\", \"Explored the company’s website\", \"Checked company's historical timeline\"],\n\"reasoning\":\"Evidence about the company using EY for their audits is solid. However, the GRC tool is missing. The company has been ISO 27001 certified since 2018 and just got its HIPAA certification.\",\n\"confidence_level\": \"Medium\"\n}\nOutput Example 3:\nYour Research: You find mentions of HIPAA compliance and GDPR compliance in a Google Search, which takes you to the companys website where you find the following statement:  \"Our website complies with HIPAA and GDPR requirements. Read our privacy policy to learn more about how we protect your data. [Found in company's privacy policy page, US-based company selling productivity software]\"\nOutput:\n{\n\"auditors\": [\"Schellman & Company LLC\"],\n\"grc_tools\": [\"Secureframe\"],\n\"confidence_auditor_grc\": \"low\",\n\"source\": \"Company's public statements and blogs\",\n\"frameworks\":[\"SOC 2\",\"GDPR\"],\n\"notes\": \"Public statements mention audits conducted by Schellman & Company LLC. Blogs point to potential use of Secureframe, though the company hasn't officially confirmed this in any formal documentation.\",\n\"bonus_info\":\"The company plans to move its operations to the cloud by the end of 2025. They have a strong internal security team and are preparing for an upcoming SOC 2 Type II audit.\",\n\"steps_taken\" : [\"Searched through company’s public statements\", \"Perused multiple blogs\", \"Reviewed statements from leadership\"],\n\"reasoning\":\"Though the company hasn't officially confirmed using Secureframe, their public statements and blogs strongly hint at its usage. The company also appears to be proactive about their compliance journey.\",\n\"confidence_level\": \"Low\"\n}\n<ACCURACY STATEMENT>\nPlease take your time and do thorough research.  Accuracy is mandatory.\n\n`\n\nreturn {prompt:prompt}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[14280,720],"id":"40224561-1127-4dd6-8ade-b454bfa517e6","name":"Find Auditor & GRC Tool"},{"parameters":{"content":"# Auditor & GRC Tool","height":660,"width":1020},"type":"n8n-nodes-base.stickyNote","position":[14080,400],"typeVersion":1,"id":"acc33db2-25a8-468b-ba01-3bbba9eb8df1","name":"Sticky Note11"},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[14500,720],"id":"422b93ea-b53a-4aa5-8f10-cd696728433a","name":"Auditor & GRC Tool Agent","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"jsonSchemaExample":"{\n\"auditors\": [\"Schellman & Company LLC\"],\n\"grc_tools\": [\"Secureframe\"],\n\"confidence_auditor_grc\": \"low\",\n\"source\": \"Company's public statements and blogs\",\n\"frameworks\":[\"SOC 2\",\"GDPR\"],\n\"notes\": \"Public statements mention audits conducted by Schellman & Company LLC. Blogs point to potential use of Secureframe, though the company hasn't officially confirmed this in any formal documentation.\",\n\"bonus_info\":\"The company plans to move its operations to the cloud by the end of 2025. They have a strong internal security team and are preparing for an upcoming SOC 2 Type II audit.\",\n\"steps_taken\" : [\"Searched through company’s public statements\", \"Perused multiple blogs\", \"Reviewed statements from leadership\"],\n\"reasoning\":\"Though the company hasn't officially confirmed using Secureframe, their public statements and blogs strongly hint at its usage. The company also appears to be proactive about their compliance journey.\",\n\"confidence_level\": \"Low\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[14700,940],"id":"6abb0acd-12e5-476f-a456-c254f0e4a868","name":"Auditor & GRC Tool - Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining Competitor/Partner Classification').first().json\n\nconst grc = {\n auditors: $json?.output?.auditors || \"\",\n grc_tools: $json?.output?.grc_tools || \"\",\n confidence_auditor_grc: $json?.output?.confidence_auditor_grc || \"\",\n source: $json?.output?.source || \"\",\n frameworks: $json?.output?.frameworks || \"\",\n notes: $json?.output?.notes || \"\",\n bonus_info: $json?.output?.bonus_info || \"\",\n steps_taken: $json?.output?.steps_taken || \"\",\n reasoning: $json?.output?.reasoning || \"\",\n confidence_level: $json?.output?.confidence_level || \"\"\n}\n\noriginal.company_info.auditor_grc_tools = grc\nreturn original"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[14940,720],"id":"dd2e72c2-e5dc-4ac2-b3de-062d87ef5b0c","name":"Combining Auditor & GRC Tool"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining Auditor & GRC Tool').first().json\nconst output = $json?.output\nconst frameworks ={\n\"SOC_1\": output?.SOC_1 || \"\",\n\"SOC_2\": output?.SOC_2 || \"\",\n\"HIPAA_HITECH\": output?.HIPAA_HITECH || \"\",\n\"PCI_DSS\": output?.PCI_DSS || \"\",\n\"ISO_27001\": output?.ISO_27001 || \"\",\n\"ISO_42001\": output?.ISO_42001 || \"\",\n\"ISO_50001\": output?.ISO_50001 || \"\",\n\"CMMC\": output?.CMMC || \"\",\n\"CCPA\": output?.CCPA || \"\",\n\"GDPR\": output?.GDPR || \"\",\n\"GLBA\": output?.GLBA || \"\",\n\"FISMA\": output?.FISMA || \"\",\n\"MAR_SOX\": output?.MAR_SOX || \"\",\n\"MARS_E\": output?.MARS_E || \"\",\n\"NERC\": output?.NERC || \"\",\n\"NYDFS\": output?.NYDFS || \"\",\n\"NIST_AI_RMF\": output?.NIST_AI_RMF || \"\",\n\"HITRUST_AI_RMF\": output?.HITRUST_AI_RMF || \"\",\n\"NIST_CSF\": output?.NIST_CSF || \"\",\n\"NIST_SP_800_53\": output?.NIST_SP_800_53 || \"\",\n\"NIST_Cybersecurity_for_IOT\": output?.NIST_Cybersecurity_for_IOT || \"\",\n\"website_found_on\": output?.website_found_on || \"No accessible website/public information available\",\n\"steps_taken\": output?.steps_taken || [],\n\"reasoning\": output?.reasoning || \"\",\n\"confidence_level\":output?.confidence_level || \"\"\n}\n\noriginal.company_info.found_frameworks = [frameworks]\nreturn original"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[15920,720],"id":"9db6804c-2c2d-412b-8558-e92a6d83b97f","name":"Combining frameworks  - 1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining frameworks  - 1').first().json\nconst output = $json.output\nconst frameworks = {\n\"SOC_1\": output?.SOC_1 || \"\",\n\"SOC_2\": output?.SOC_2 || \"\",\n\"HIPAA_HITECH\": output?.HIPAA_HITECH || \"\",\n\"PCI_DSS\": output?.PCI_DSS || \"\",\n\"ISO_27001\": output?.ISO_27001 || \"\",\n\"ISO_42001\": output?.ISO_42001 || \"\",\n\"ISO_50001\": output?.ISO_50001 || \"\",\n\"CMMC\": output?.CMMC || \"\",\n\"CCPA\": output?.CCPA || \"\",\n\"GDPR\": output?.GDPR || \"\",\n\"GLBA\": output?.GLBA || \"\",\n\"FISMA\": output?.FISMA || \"\",\n\"MAR_SOX\": output?.MAR_SOX || \"\",\n\"MARS_E\": output?.MARS_E || \"\",\n\"NERC\": output?.NERC || \"\",\n\"NYDFS\": output?.NYDFS || \"\",\n\"NIST_AI_RMF\": output?.NIST_AI_RMF || \"\",\n\"HITRUST_AI_RMF\": output?.HITRUST_AI_RMF || \"\",\n\"NIST_CSF\": output?.NIST_CSF || \"\",\n\"NIST_SP_800_53\": output?.NIST_SP_800_53 || \"\",\n\"NIST_Cybersecurity_for_IOT\": output?.NIST_Cybersecurity_for_IOT || \"\",\n\"website_found_on\": output?.website_found_on || \"https://www.searchactions.com/\",\n\"steps_taken\": output?.steps_taken || [],\n\"reasoning\": output?.reasoning || \"\",\n\"confidence_level\": output?.confidence_level || \"\"\n}\noriginal.company_info.found_frameworks.push(frameworks)\nreturn original"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[16840,720],"id":"a6626310-57c6-4d16-a46b-bccc2cdb4630","name":"Combining frameworks - 2"},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[17340,720],"id":"0f3f401f-f671-49cf-96bc-76b5a7d8dd40","name":"Frameworks - Review Agent","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const prompt = `\n### ROLE\nYou are an expert quality assurance and data verification specialist with advanced skills in online research and business intelligence. You critique and verify information found by our team using publicly available data.  Your attention to detail and dedication to the truth keeps the world safe from false information. You only allow content through that is 100% factual  \n\n### TARGET INFORMATION\nCompany name: ${$json.company_info.name}\nSummary: ${$json.company_info.report}\nDomain: ${$json.company_info.domain}\nWebsite: ${$json.company_info.domain}\nCompany LinkedIn: ${$json.company_info.social_urls.linked_in}\nIndustry: ${$json.company_info.industries}\nSpecialties: ${$json.company_info.specialities}\n\n\n\nInitial Compliance Research:\nTwo researches have provided us with their findings.  \nResearcher 1: \nReasoning: ${$json.company_info.found_frameworks[0].reasoning}\nResearch Process: ${$json.company_info.found_frameworks[0].steps_taken}\nResearcher 2: \nReasoning: ${$json.company_info.found_frameworks[1].reasoning}\nResearch Process:${$json.company_info.found_frameworks[1].steps_taken}\n\n## Vendors/Auditors/Tools found:\nThe researchers were tasked with finding out which auditors or third-parties provided the audit or assisted the company with the certification process or issued the certification or final report. \nReasoning:  ${$json.company_info.auditor_grc_tools.reasoning}\nGRC Software: ${$json.company_info.auditor_grc_tools.grc_tools}\nAuditors: ${$json.company_info.auditor_grc_tools.auditors}\nAdditional Info:${$json.company_info.auditor_grc_tools.bonus_info}\nSteps Taken:${$json.company_info.auditor_grc_tools.steps_taken}\n\n\n### TASK\nYour task is to critique the research about ${$json.company_info.name}'s (${$json.company_info.domain}) compliance frameworks and certifications they have been reported to achieve to determine if the research is accurate.   Here are the specific frameworks being evaluated: \n\nIT Compliance and Certification:\n- SOC 1\n- SOC 2\n- HIPAA/HITECH\n- HITRUST\n- PCI DSS\n- ISO 27001\n- ISO 42001\n- ISO 50001\n- CMMC\n- CCPA and GDPR\n- GLBA\n- FISMA\n- MAR/SOX\n- MARS-E\n- NERC\n- NYDFS\nArtificial Intelligence Compliance:\n- NIST AI RMF\n- ISO 42001\n- HITRUST AI RMF\nCybersecurity and Risk Management:\n- NIST CSF\n- NIST SP 800-53\n- NIST Cybersecurity for IoT\n- NIST AI Risk Management\nNote: These are the only frameworks and certifications you will evaluate.\n\n### Output\n- Analysis:  Provide your analysis of the research.  \n- Revisions: If the research has innacuracies, provide corrections so we can update our reseach with more accurate information.\n- Confirmed Company:  You will confirm that the company our team has found compliance certifications and frameworks for is, in fact, the target company ${$json.company_info.name} with the domain ${$json.company_info.domain}.\n- Confirmed Frameworks:  You will ONLY list the frameworks that you are 100% confident our target \n${$json.company_info.name} has achieved for THEMSELVES and can confirm.  Do not provide an explanation or reasoning here.  Just an array.   If there are no certifications or frameworks that ${$json.company_info.name} has achieved for themselves that you can confirm, respond with empty array. If ${$json.company_info.name} provides the compliance certification or framework to other companies, and have not achieved the certification or framework for themselves, then DO NOT LIST that framework or certification as \"Confirmed\".   CONFIRMED FRAMEWORKS AND CERTIFCATIONS ARE ONLY FRAMEWORKS AND CERTIFCATIONS THE TARGET COMPANY HAS ACHIEVED FOR THEMSELVES.\n- Unconfirmed Frameworks:  List the frameworks that were wronly attributed to the target company or frameworks that you are not confident they have and/or cannot confirm. Do not provide an explanation or reasoning here.  Just list the frameworks in an array\n- Confirmed GRC Platforms/Software:   List the GRC Tools that you are confident they use and can confirm. If there are no confirmed GRC platforms, then respond with \"Not Found\"\n- Confirmed auditors:  List the auditors that you are confident they use and can confirm.  If there are no confirmed auditors, then respond with \"Not Found\"\n- Steps taken:Steps taken refers to the process or actions you performed in order to verify the information provided by researchers. This should include, but not be limited to, looking up the company on their own website, on social media (particularly LinkedIn), seeking references to the company in relation to compliance on third party websites or authoritative sources, and cross-referencing all findings to confirm they apply to the correct company—not one simply with a similar name.\n- Reasoning:Steps taken refers to the process or actions you performed in order to verify the information provided by researchers. This should include, but not be limited to, looking up the company on their own website, on social media (particularly LinkedIn), seeking references to the company in relation to compliance on third party websites or authoritative sources, and cross-referencing all findings to confirm they apply to the correct company—not one simply with a similar name.\n- Confidence Level: \nConfidence Level is your final, overall judgment on the validity or veracity of the entire set of information presented by your research and verification process. This would generally encapsulate how sure you are that the details—if published—would hold up as factual, accurate and true. High confidence would denote you have no, or very minor, reservations about the truth of the findings. Medium confidence would indicate there are some uncertainties in the obtained information. Low confidence would be reserved for instances where considerable doubts exist about many or key aspects of the findings.\n\n\n### IMPORTANT\n- THIS IS CRITICAL - WE WILL DESTORY OUR RELATIONSHIP WITH THE CUSTOMER IF THIS IS NOT ACCURATE: You must ensure that you are researching the company named ${$json.company_info.name} that matches the company found at ${$json.company_info.social_urls.linked_in}.   Many companies have similar names and domains.  The company you are researching is called ${$json.company_info.name}, has ${$json.company_info.domain} as their domain and can be found at this linkedin page: ${$json.company_info.social_urls.linked_in}.\n- Be aware that GDPR, CCPA, HIPAA and other privacy certifications and frameworks are often mentioned on websites because the company complies with them.  This may not mean they are actually certified to be compliant.  For example, many websites have a cookie acknowledgement that visitors have to acknowledge.  These cookie policies often mention GDPR and CCPA.  Do not confuse this with the actual certification.  \n### ACCURACY STATEMENT\n- You will verify that your ouput is for ${$json.company_info.name}, who is the same company at this LinkedIn URL: ${$json.company_info.social_urls.linked_in}. If you do not have high confience that the certifications and frameworks that you found in your research (on search engines and other sources) are for this exact company, respond with \"Low Confidence\" \n- If the website does not have a \"Trust Center\" or other sections prooving thier commitment to data security and compliance, then search Google\n-  You MUST document the steps you have taken, specifically any google searches you made\n- If you are taking information from an online source, such as a Press Release, the information in the \"About\" section (or other section that contains the company's contact information) you must verify that the company mentioned is the same EXACT company as our prospect.  \n- ALWAYS CLEAR YOUR CACHE BEFORE SEARCHING.  YOUR JOB DEPENDS ON FRESH INFORMATION\n`\n\nreturn {prompt:prompt}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[17120,720],"id":"6d41df09-ab45-4a61-aa4d-cd506fb59288","name":"Frameworks Review - Prompt"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[13380,920],"id":"65540c7a-bd08-44eb-bd78-b0c0519fdecf","name":"OpenAI Chat Model - Competitor / Partner  Classification","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[14480,920],"id":"b4e49825-b3ad-45bf-9ad1-de5223659621","name":"OpenAI Chat Model - Auditor & GRC Tool","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[15460,920],"id":"45db3c08-c9b6-494d-b523-13a7fb95aec7","name":"OpenAI Chat Model - Framework First","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[16320,940],"id":"3e987a5b-8560-4321-a98e-f62d713aa3f9","name":"OpenAI Chat Model - Framework Second","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[17280,920],"id":"afcd20ea-2e42-4868-8228-c5ed964b889b","name":"OpenAI Chat Model - Framework Review","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"jsonSchemaExample":"{\n\"analysis\":\"The information provided by both researchers is detailed. While they've outlined the steps they've taken clearly, some inconsistencies were noticed during the verification process.\",\n\"revisions\":\"Researcher 2 stated the company has PCI DSS certification. My investigation has confirmed that the company is compliant with PCI DSS but is not officially certified. On the other hand, I could not find any concrete evidence to support Researcher 1's claim of the company having ISO 27001 certification.\",\n\"frameworks_confirmed\":[\"SOC 2\", \"HIPAA\"],\n\"frameworks_unconfirmed\":[\"SOC 1, HITRUST\"],\n\"grc_tools_confirmed\":\"Not Found\",\n\"auditors_confirmed\":\"PWC\",\n\"target_company_confirmed\":\"True\",\n\"steps_taken\" : [\"Reviewed the company's official website\", \"Checked the LinkedIn page of the company\", \"Searched for PWC's audit client list\", \"Googled for press releases regarding the company's certifications\"],\n\"reasoning\":\"I critically analyzed the researchers' findings and followed their track using additional resources too. I discovered that people often confuse compliance to a standard with being certified in it. Hence, I was careful in distinguishing between the two.\",\n\"confidence_level\": \"Medium\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[17560,920],"id":"b678b761-c75f-45f5-914e-59a0d844ea01","name":"Framework review - Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining frameworks - 2').first().json\nconst output = $json?.output\n\nconst review = {\n analysis: output?.analysis || \"\",\n revisions: output?.revisions || \"\",\n confirmed_frameworks: output?.frameworks_confirmed ||\"\",\n unconfirmed_frameworks: output?.frameworks_unconfirmed || \"\",\n confirmed_grc_platforms: output?.grc_tools_confirmed|| \"\",\n confirmed_auditors: output?.auditors_confirmed || \"\",\n steps_taken: output?.steps_taken || [],\n reasoning: output?.reasoning || \"\",\n confidence_level: output?.confidence_level || \"\"\n}\n\noriginal.company_info.framework_review = review\nreturn original"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[17800,720],"id":"177e112e-9ed4-4c10-8729-74731217bad8","name":"Combining Framework Review"},{"parameters":{"model":"gpt-4o","options":{"maxRetries":10}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[18940,940],"id":"6ae3b740-c72b-43d4-94fc-280162687f44","name":"OpenAI Chat Model - ICP Score","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"promptType":"define","text":"={{ $json.prompt }}","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[19780,720],"id":"4f3863ff-3ff3-44f9-87df-6c5fb9f9a5ce","name":"ICP Frameworks Agent","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const prompt = `\n### INFORMATION\nOur marketing team has researched a company to identify if they currently hold any cybersecurity or IT compliance certifications or use any frameworks.  The results of the research are below: \n*Number of Certifications/Frameworks:*  ${$json.company_info.icp_score.component_scores.frameworks.factor_a}\n*Names of Certifications/Frameworks:* ${$json.company_info.framework_review.confirmed_frameworks}\n*Research Summary:* ${$json.company_info.framework_review.analysis}\n\n### TASK\nLet's analyze the research and provide our sales team with the number of Certifications/Frameworks the company has and the names of the Certifications/Frameworks.   Since the sales team requires our response in a consistent format, you must format your response according to the instructions below.  \nThe research summary is provided so that you can double check the Number of Certifications/Frameworks and the Names of the Certifications/Frameworks the sales team provided.  The summary will include whether or not the company has any Certifications/Frameworks and which ones they are.  Use the summary to double check how many Certifications/Frameworks the company has and their names (if they have any).   \n\n- If the number of frameworks equals 4 or more, icp_frameworks will be \"3+ Frameworks - {{Frameworks}}\" \n- If the number of frameworks equals 3,icp_frameworks will be \"2 Frameworks - {{Frameworks}}\" \n- If the number of frameworks equals 2, icp_frameworks will be \"1 Framework - {{Frameworks}}\" \n- If the number of frameworks equals 1, insert \"No Frameworks Found\"  \n- If the number of frameworks equals None Confirmed or None Found, insert \"No Frameworks Found\" \n\n### TASK EXAMPLES\n1. For example, if the input equals 3, then the icp_frameworks will equal \"2 Frameworks - {{Frameworks}}\"\n2. For example, if the input equals 2, then the icp_frameworks will equal \"1 Framework - {{Frameworks}}\"\n3. For example, if the input equals None Found, then the icp_frameworks will equal \"No Frameworks Found\"\n\n### YOUR RESPONSE FORMAT\nYour response should be structured like the following object:\n{\n\t\"icp_frameworks\": \"\",\n\t\"steps_taken\": [],\n    \"reasoning\": \"\",\n    \"confidence_level\":\"\"\n}\n1. You will only reference the information provided to accomplish this task.  \n2. It's important for you to follow the response format provided \n3. Don't include any additional info then the response format provided.\n`\n\nreturn {prompt:prompt}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[19600,720],"id":"89a43010-c251-4666-a1b7-77b5201282a8","name":"ICP Frameworks Prompt"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[19740,920],"id":"e8e6c938-21f9-4c8b-83db-026413124b3b","name":"OpenAI Chat Model - ICP Frameworks","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining ICP score').first().json\nconst res = $json.output\noriginal.company_info.icp_score.components.icp_frameworks = res?.icp_frameworks\noriginal.company_info.icp_score.components.icp_frameworks.reasoning = res?.reasoning\n\nreturn original\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[20200,720],"id":"4f132c86-d30e-4b16-a4cd-02046c9ff055","name":"Adding ICP Framework"},{"parameters":{"jsonSchemaExample":"{\n\"icp_frameworks\": \"2 Frameworks - SOC 2, HIPAA, CCPA, GDPR\",\n\"steps_taken\": [\"Reviewed the number of Certifications/Frameworks mentioned in the research summary.\",\t\t\"Identified the specific names of the Certifications/Frameworks listed.\",\"Formatted the response according to the instructions based on the total number of frameworks.\"],\n\"reasoning\": \"The research summary indicates that the company claims compliance with four frameworks, hence it was formatted as '3+ Frameworks - SOC 2, HIPAA, CCPA, GDPR'.\",\n\"confidence_level\": \"High\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[19980,920],"id":"2563107f-ac7a-4023-9c31-3c176aebfc5b","name":"ICP Frameworks - Parser"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolCalculator","typeVersion":1,"position":[19120,940],"id":"0afeb35b-5428-49de-bb8b-c4b6e20166fc","name":"Calculator"},{"parameters":{"promptType":"define","text":"=# INPUT\n{{$json.company_info.framework_review.analysis}}\n\n# TASK\nLet's write a single sentence for a sales email acknowledging a prospect's IT compliance achievements. The sentence will reference research conducted about their compliance frameworks.\n\n# Output Requirements\n## Generate a single sentence that: \n1. Uses first-person perspective\n2. References specific research source (e.g., trust center, press release, compliance database)\n3. Only reference frameworks that are explicitly confirmed in the research provided\n4. Maintains 6th-grade reading level\n5. Emphasizes research effort without using adjectives\n6. Does not make claims about specific frameworks if they have not been confirmed in the research\n\n# Style Rules\n- No greetings or conclusions\n- No commentary about unconfirmed frameworks\n- No compound sentences\n- No use of \"website and trust center\" together\n- Maximum 20 words\n\n# Output Format\nReturn only the single sentence, nothing else.\n\n# Examples\nBad: \"I noticed from extensive research that your company has achieved multiple frameworks.\"\nGood: \"I found in your trust center that {{$json.company_info.name}} achieved SOC 1 and 2 compliance.\"","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[20480,720],"id":"0cb35205-6b2d-4b35-abfb-97105cbc36bc","name":"Framework research results","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.1,"position":[20440,920],"id":"a257968a-7e36-45f9-a739-9e93abd5652b","name":"OpenAI Chat Model - Framework research results","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Adding ICP Framework').first().json\nconst sentence = $json?.output || ''\n\noriginal.company_info.framework_review.framework_research_results = sentence\n\nreturn original"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[20840,720],"id":"946cbefe-5419-457a-99bd-471b95a11c3e","name":"Adding Framework research results"},{"parameters":{"promptType":"define","text":"=# YOUR TASK\nYour task is to compare frameworks held by the prospect with the frameworks of the page they visited, finding matching frameworks.\n\nHere is data to use in the task:\nFrameworks Prospect Has:  {{ $json.company_info.framework_review.confirmed_frameworks }}\nFrameworks of the page they visited: {{ $json.technical_data.page_visited_framework }}\n\n# YOUR OUTPUT\nYour output should be structured like this object: \n{\n\t\"matches_frameworks_held\": \"True\", \n\t\"matched_framework\": \"SOC 2\"\n}\n\nmatches_frameworks_held = This should be True or False depending if any of the frameworks held by the prospect matches any of the \nframeworks held by the page.\n\nmatched_framework = This should be a list of all the frameworks that match.\n\nMake sure both the values are strings","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[18020,720],"id":"82268834-de7b-4332-88d5-2ad11598a537","name":"Matches framework of the Page","alwaysOutputData":true,"retryOnFail":true},{"parameters":{"options":{"maxRetries":10}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.1,"position":[17940,920],"id":"35686a03-3cb3-45d0-9286-e2875587eccd","name":"OpenAI Chat Model - Matching Frameworks","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"jsonSchemaExample":"{\n\t\"matches_frameworks_held\": \"True\",\n\t\"matched_framework\": \"SOC 2\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[18220,920],"id":"97b06fb4-eddb-413a-9447-607117aec51e","name":"Matched Frameworks - Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Combining Framework Review').first().json\n\noriginal.technical_data.matches_frameworks_held = $json?.output?.matches_frameworks_held || 'Not found'\noriginal.technical_data.matched_framework = $json?.output?.matched_framework || 'Not found'\n\nreturn original"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[18400,720],"id":"99ea6671-8735-4ec8-95d9-250a5f966718","name":"Combining Matched Frameworks"},{"parameters":{"content":"# Ideal Customer Profile Score ","height":660,"width":2460},"type":"n8n-nodes-base.stickyNote","position":[18740,400],"typeVersion":1,"id":"f3162504-ccaf-4bd7-be0c-6e9c03a01dec","name":"Sticky Note10"},{"parameters":{"content":"# Competitor / Partner Classification\n","height":660,"width":1020},"type":"n8n-nodes-base.stickyNote","position":[13040,400],"typeVersion":1,"id":"759a9e65-20d6-4030-b11c-f9576caa5120","name":"Sticky Note7"},{"parameters":{"content":"# Find Compliance Frameworks\n\n","height":660,"width":3600},"type":"n8n-nodes-base.stickyNote","position":[15120,400],"typeVersion":1,"id":"16d5d10d-ee4e-499e-ac88-19f4b47da523","name":"Sticky Note8"},{"parameters":{"content":"# Personalization\n","height":660,"width":1020},"type":"n8n-nodes-base.stickyNote","position":[21220,400],"typeVersion":1,"id":"7af9dfbd-01de-47f9-bc8d-ff2227c44008","name":"Sticky Note14"},{"parameters":{"promptType":"define","text":"={{JSON.stringify($json)}}\n\nUsing provided data about the prospect who visited one of our pages on the website generate appealing message we could send to them on Linked In.\n\nDon't include the subject, just the message.\n","hasOutputParser":true,"options":{"maxIterations":10}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[21420,720],"id":"7da3f31c-4523-41de-9903-80c837d3d850","name":"Generating Linked In message","executeOnce":false,"alwaysOutputData":true},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.1,"position":[21360,920],"id":"18df74d5-d6db-4b06-bce2-0d6b0975e9bd","name":"OpenAI Model - Linked In message","credentials":{"openAiApi":{"id":"7rqV8eJ2LpO7fXqw","name":"searchactions.com: digitalsandwich.agency - Prospect Feed Applic"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const original = $('Adding Framework research results').first().json\nconst sentence = $json?.output?.message || ''\n\n//original.technical_data.linked_in_message = sentence\nconst personalization = {}\npersonalization.linked_in_message = sentence\noriginal.personalization = personalization\nreturn original"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[21800,720],"id":"9449aa57-a520-40dd-8350-c431a17d32cd","name":"Combining Linked In message"},{"parameters":{"jsonSchemaExample":"{\n\t\"message\": \"\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[21640,920],"id":"89939fbf-bfb8-40ca-91ca-9624f14281dd","name":"Structured Output Parser"},{"parameters":{"authentication":"oAuth2","resource":"channel","operation":"invite","channelId":{"__rl":true,"value":"={{ $json.id }}","mode":"id"},"userIds":["U089LTPDYJJ"]},"type":"n8n-nodes-base.slack","typeVersion":2.3,"position":[1720,20],"id":"c2d7b728-bc99-4c94-90fd-bb7df5d77c24","name":"Adding the App in the channel","webhookId":"e6567e89-e63d-468d-9241-b1b4acf3468f","notesInFlow":true,"credentials":{"slackOAuth2Api":{"id":"PPnwMaC7LkBl1xoD","name":"searchactions.com: digitalsandwich.agency  - Prospect Feed"}}},{"parameters":{"httpMethod":"POST","path":"digitalsandwich-prospect-feed-signup","responseMode":"responseNode","options":{"ignoreBots":true}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-40,-40],"id":"54725849-9302-4091-85ba-5e4d41c01ef7","name":"Webhook","webhookId":"a01ddf82-3039-45dc-b390-6c43e0e4c2af"},{"parameters":{"operation":"get","tableId":"signup-form","filters":{"conditions":[{"keyName":"company_domain","keyValue":"={{ $json.domain }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[620,-100],"id":"60e2c86a-5965-4f28-bb3a-61162ca25aa4","name":"Pulling up the Client","notesInFlow":true,"alwaysOutputData":true,"credentials":{"supabaseApi":{"id":"AZhuxf9jkjUKSF2O","name":"searchactions.com -  digitalsandwich.agency - Prospect Feed appl"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"5c9e9e08-9dd8-4442-8abe-94ab09eaa56b","leftValue":"={{ $json.id }}","rightValue":"","operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[800,-100],"id":"0e2c20c6-1522-4eed-8e8c-68c24c51a89b","name":"Already Signed Up ?"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"960ab92c-d423-46e3-afc7-bb26a1bc4485","leftValue":"={{ $json.error }}","rightValue":"","operator":{"type":"string","operation":"notExists","singleValue":true}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[340,-40],"id":"dfe0d9c4-e73d-432f-aec1-ac711e9bc421","name":"All data is Valid ?"},{"parameters":{"respondWith":"json","responseBody":"={\n  \"error\" : \"{{ $json.error }}\",\n  \"message\" : \"{{ $json.error }}\"\n} ","options":{"responseCode":400}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.1,"position":[620,80],"id":"7ba737f4-fdd5-4573-8221-db9a559c4cf9","name":"data invalid"},{"parameters":{"respondWith":"json","responseBody":"{\n  \"error\": \"This website is already Signed Up\",\n  \"message\": \"This website is already Signed Up\"\n}","options":{"responseCode":409}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.1,"position":[1180,-140],"id":"e0814edc-3bcf-4c1b-a0a7-a39200729a35","name":"already signed up"},{"parameters":{"respondWith":"text","responseBody":"Successfully Singed Up","options":{"responseCode":200}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.1,"position":[1180,80],"id":"618f5c54-2355-4f1b-9edb-fce3fcbd643a","name":"Success"}],"connections":{"On form submission":{"main":[[]]},"Formatting Form response":{"main":[[{"node":"All data is Valid ?","type":"main","index":0}]]},"Adding company to the database":{"main":[[{"node":"Success","type":"main","index":0}]]},"Vector data normalization":{"main":[[{"node":"Page Visited URL present","type":"main","index":0}]]},"Vector":{"main":[[{"node":"Vector data normalization","type":"main","index":0}]]},"Summarizing":{"main":[[{"node":"Getting Client","type":"main","index":0}]]},"Manually Testing the workflow":{"main":[[{"node":"Mockup Data","type":"main","index":0}]]},"Mockup Data":{"main":[[{"node":"Page Visited URL present","type":"main","index":0}]]},"Page Visited URL present":{"main":[[{"node":"Summarizing","type":"main","index":0}]]},"Getting Client":{"main":[[{"node":"Client Exists","type":"main","index":0}]]},"Client Exists":{"main":[[{"node":"Is client on a free plan ?","type":"main","index":0}]]},"Is client on a free plan ?":{"main":[[{"node":"Did they exceed the limit ?","type":"main","index":0}],[{"node":"Anhtropic Query","type":"main","index":0}]]},"Did they exceed the limit ?":{"main":[[],[{"node":"Anhtropic Query","type":"main","index":0}]]},"Anthropic Chat Model":{"ai_languageModel":[[{"node":"Finding Missing data Agent","type":"ai_languageModel","index":0}]]},"Anhtropic Query":{"main":[[{"node":"Finding Missing data Agent","type":"main","index":0}]]},"Anthropic Response":{"main":[[{"node":"Email Finder Agent","type":"main","index":0}]]},"Finding Missing data Agent":{"main":[[{"node":"Anthropic Response","type":"main","index":0}]]},"Finding Missing Data - Parser":{"ai_outputParser":[[{"node":"Finding Missing data Agent","type":"ai_outputParser","index":0}]]},"Lead magic Email Finder":{"ai_tool":[[{"node":"Email Finder Agent","type":"ai_tool","index":0}]]},"Findymail Email Finder 1":{"ai_tool":[[{"node":"Email Finder Agent","type":"ai_tool","index":0}]]},"Findymail Email Finder 2":{"ai_tool":[[{"node":"Email Finder Agent","type":"ai_tool","index":0}]]},"Prospeo Email Finder":{"ai_tool":[[{"node":"Email Finder Agent","type":"ai_tool","index":0}]]},"LeadMagic Email Validation":{"ai_tool":[[{"node":"Email Finder Agent","type":"ai_tool","index":0}]]},"Split Out":{"main":[[{"node":"Combining Email data","type":"main","index":0}]]},"Email Finder Agent":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"OpenAI Chat Model - Email finder":{"ai_languageModel":[[{"node":"Email Finder Agent","type":"ai_languageModel","index":0}]]},"Email Finder Parser":{"ai_outputParser":[[{"node":"Email Finder Agent","type":"ai_outputParser","index":0}]]},"Findymail Email Finder 3":{"ai_tool":[[{"node":"Email Finder Agent","type":"ai_tool","index":0}]]},"Finding Linked In query":{"main":[[{"node":"Finding Linked In2","type":"main","index":0}]]},"Is personal LinkedIn present?":{"main":[[{"node":"Is personal OR company LinkedIn present?","type":"main","index":0}],[{"node":"Finding Linked In query","type":"main","index":0}]]},"Is personal OR company LinkedIn present?":{"main":[[{"node":"Profile Search","type":"main","index":0}],[{"node":"Mobile Finder query","type":"main","index":0}]]},"Mobile Finder query":{"main":[[{"node":"Mobile Finder","type":"main","index":0}]]},"Company Search query":{"main":[[{"node":"Do we have Linked in, company domain or company name ?","type":"main","index":0}]]},"Do we have Linked in, company domain or company name ?":{"main":[[{"node":"Company Search","type":"main","index":0}],[{"node":"Summarizing User Info","type":"main","index":0}]]},"Company Search":{"main":[[{"node":"Summarizing User Info","type":"main","index":0}]]},"Combining Company - User - Technical Data":{"main":[[{"node":"Analyzing data","type":"main","index":0}]]},"Finding Linked In2":{"main":[[{"node":"Is personal OR company LinkedIn present?","type":"main","index":0}]]},"Profile Search":{"main":[[{"node":"Mobile Finder query","type":"main","index":0}]]},"Mobile Finder":{"main":[[{"node":"Company Search query","type":"main","index":0}]]},"Summarizing Company Info":{"main":[[{"node":"Summarizing Technical Data","type":"main","index":0}]]},"Summarizing User Info":{"main":[[{"node":"Summarizing Company Info","type":"main","index":0}]]},"Page Information prompt":{"main":[[{"node":"Page Visited Agent","type":"main","index":0}]]},"Page info - Output parser":{"ai_outputParser":[[{"node":"Page Visited Agent","type":"ai_outputParser","index":0}]]},"Page Visited Agent":{"main":[[{"node":"Combining Page Info. Data","type":"main","index":0}]]},"About the Contact - Output parser":{"ai_outputParser":[[{"node":"About the Contact Agent","type":"ai_outputParser","index":0}]]},"Combining Page Info. Data":{"main":[[{"node":"About the Company prompt","type":"main","index":0}]]},"About the Company prompt":{"main":[[{"node":"About the Company Agent","type":"main","index":0}]]},"Combining Company info. data":{"main":[[{"node":"About the contact prompt","type":"main","index":0}]]},"About the contact prompt":{"main":[[{"node":"About the Contact Agent","type":"main","index":0}]]},"About the Company Agent":{"main":[[{"node":"Combining Company info. data","type":"main","index":0}]]},"About the Contact Agent":{"main":[[{"node":"Combining Contact non-public information","type":"main","index":0}]]},"Analyzing data":{"main":[[{"node":"Prospect final structure","type":"main","index":0}]]},"Prospect final structure":{"main":[[{"node":"Page Information prompt","type":"main","index":0}]]},"Analyzing data - Parser":{"ai_outputParser":[[{"node":"Analyzing data","type":"ai_outputParser","index":0}]]},"About Company - Parser":{"ai_outputParser":[[{"node":"About the Company Agent","type":"ai_outputParser","index":0}]]},"OpenAI Chat Model - Page Info":{"ai_languageModel":[[{"node":"Page Visited Agent","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Company Info":{"ai_languageModel":[[{"node":"About the Company Agent","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Contact info.":{"ai_languageModel":[[{"node":"About the Contact Agent","type":"ai_languageModel","index":0}]]},"Summarizing Technical Data":{"main":[[{"node":"Combining Company - User - Technical Data","type":"main","index":0}]]},"Analyzing data Anthropic Model":{"ai_languageModel":[[{"node":"Analyzing data","type":"ai_languageModel","index":0}]]},"Combining Email data":{"main":[[{"node":"Visitor Exists","type":"main","index":0}]]},"Data Normalization":{"main":[[{"node":"Prospect Report","type":"main","index":0}]]},"Combining Contact non-public information":{"main":[[{"node":"Competitor Partner classification - prompt","type":"main","index":0}]]},"Prospect Report":{"main":[[{"node":"Extend enrichment ?","type":"main","index":0}]]},"Adding enriched data to the database":{"main":[[{"node":"Sending out slack notification","type":"main","index":0}]]},"Extend enrichment ?":{"main":[[],[{"node":"Adding enriched data to the database","type":"main","index":0},{"node":"Updating enrichment count for the Client","type":"main","index":0}]]},"Visitor Exists":{"main":[[{"node":"Does visitor exist ?","type":"main","index":0}]]},"Does visitor exist ?":{"main":[[],[{"node":"Is personal LinkedIn present?","type":"main","index":0}]]},"ICP Score":{"main":[[{"node":"Combining ICP score","type":"main","index":0}]]},"ICP Score prompt":{"main":[[{"node":"ICP Score","type":"main","index":0}]]},"Combining ICP score":{"main":[[{"node":"ICP Frameworks Prompt","type":"main","index":0}]]},"ICP Output parser":{"ai_outputParser":[[{"node":"ICP Score","type":"ai_outputParser","index":0}]]},"Competitor Partner classification - prompt":{"main":[[{"node":"Competitor / Partner agent","type":"main","index":0}]]},"Competitor/Partner Classification Parser":{"ai_outputParser":[[{"node":"Competitor / Partner agent","type":"ai_outputParser","index":0}]]},"Combining Competitor/Partner Classification":{"main":[[{"node":"Find Auditor & GRC Tool","type":"main","index":0}]]},"Find frameworks prompt":{"main":[[{"node":"Framework Agent - First","type":"main","index":0}]]},"Competitor / Partner agent":{"main":[[{"node":"Combining Competitor/Partner Classification","type":"main","index":0}]]},"Framework Agent - First":{"main":[[{"node":"Combining frameworks  - 1","type":"main","index":0}]]},"Framework First - Parser":{"ai_outputParser":[[{"node":"Framework Agent - First","type":"ai_outputParser","index":0}]]},"Find frameworks - second prompt":{"main":[[{"node":"Framework Agent - Second","type":"main","index":0}]]},"Framework Agent - Second":{"main":[[{"node":"Combining frameworks - 2","type":"main","index":0}]]},"Framework Second - Parser":{"ai_outputParser":[[{"node":"Framework Agent - Second","type":"ai_outputParser","index":0}]]},"Find Auditor & GRC Tool":{"main":[[{"node":"Auditor & GRC Tool Agent","type":"main","index":0}]]},"Auditor & GRC Tool Agent":{"main":[[{"node":"Combining Auditor & GRC Tool","type":"main","index":0}]]},"Auditor & GRC Tool - Parser":{"ai_outputParser":[[{"node":"Auditor & GRC Tool Agent","type":"ai_outputParser","index":0}]]},"Combining Auditor & GRC Tool":{"main":[[{"node":"Find frameworks prompt","type":"main","index":0}]]},"Combining frameworks  - 1":{"main":[[{"node":"Find frameworks - second prompt","type":"main","index":0}]]},"Combining frameworks - 2":{"main":[[{"node":"Frameworks Review - Prompt","type":"main","index":0}]]},"Frameworks - Review Agent":{"main":[[{"node":"Combining Framework Review","type":"main","index":0}]]},"Frameworks Review - Prompt":{"main":[[{"node":"Frameworks - Review Agent","type":"main","index":0}]]},"OpenAI Chat Model - Competitor / Partner  Classification":{"ai_languageModel":[[{"node":"Competitor / Partner agent","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Auditor & GRC Tool":{"ai_languageModel":[[{"node":"Auditor & GRC Tool Agent","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Framework First":{"ai_languageModel":[[{"node":"Framework Agent - First","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Framework Second":{"ai_languageModel":[[{"node":"Framework Agent - Second","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Framework Review":{"ai_languageModel":[[{"node":"Frameworks - Review Agent","type":"ai_languageModel","index":0}]]},"Framework review - Parser":{"ai_outputParser":[[{"node":"Frameworks - Review Agent","type":"ai_outputParser","index":0}]]},"Combining Framework Review":{"main":[[{"node":"Matches framework of the Page","type":"main","index":0}]]},"OpenAI Chat Model - ICP Score":{"ai_languageModel":[[{"node":"ICP Score","type":"ai_languageModel","index":0}]]},"ICP Frameworks Agent":{"main":[[{"node":"Adding ICP Framework","type":"main","index":0}]]},"ICP Frameworks Prompt":{"main":[[{"node":"ICP Frameworks Agent","type":"main","index":0}]]},"OpenAI Chat Model - ICP Frameworks":{"ai_languageModel":[[{"node":"ICP Frameworks Agent","type":"ai_languageModel","index":0}]]},"Adding ICP Framework":{"main":[[{"node":"Framework research results","type":"main","index":0}]]},"ICP Frameworks - Parser":{"ai_outputParser":[[{"node":"ICP Frameworks Agent","type":"ai_outputParser","index":0}]]},"Calculator":{"ai_tool":[[{"node":"ICP Score","type":"ai_tool","index":0}]]},"Framework research results":{"main":[[{"node":"Adding Framework research results","type":"main","index":0}]]},"OpenAI Chat Model - Framework research results":{"ai_languageModel":[[{"node":"Framework research results","type":"ai_languageModel","index":0}]]},"Matches framework of the Page":{"main":[[{"node":"Combining Matched Frameworks","type":"main","index":0}]]},"OpenAI Chat Model - Matching Frameworks":{"ai_languageModel":[[{"node":"Matches framework of the Page","type":"ai_languageModel","index":0}]]},"Matched Frameworks - Parser":{"ai_outputParser":[[{"node":"Matches framework of the Page","type":"ai_outputParser","index":0}]]},"Combining Matched Frameworks":{"main":[[{"node":"ICP Score prompt","type":"main","index":0}]]},"Adding Framework research results":{"main":[[{"node":"Generating Linked In message","type":"main","index":0}]]},"Sending out slack notification":{"main":[[]]},"OpenAI Model - Linked In message":{"ai_languageModel":[[{"node":"Generating Linked In message","type":"ai_languageModel","index":0}]]},"Generating Linked In message":{"main":[[{"node":"Combining Linked In message","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Generating Linked In message","type":"ai_outputParser","index":0}]]},"Combining Linked In message":{"main":[[{"node":"Data Normalization","type":"main","index":0}]]},"Creating Slack Channel":{"main":[[{"node":"Adding the App in the channel","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"Formatting Form response","type":"main","index":0}]]},"Pulling up the Client":{"main":[[{"node":"Already Signed Up ?","type":"main","index":0}]]},"Already Signed Up ?":{"main":[[{"node":"already signed up","type":"main","index":0}],[{"node":"Adding company to the database","type":"main","index":0}]]},"All data is Valid ?":{"main":[[{"node":"Pulling up the Client","type":"main","index":0}],[{"node":"data invalid","type":"main","index":0}]]},"already signed up":{"main":[[]]},"data invalid":{"main":[[]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Manually Testing the workflow":[{"json":{}}]},"versionId":"aa9274c4-50a1-4767-9b4e-01396260a26a","triggerCount":1,"tags":[{"createdAt":"2025-01-17T13:25:11.155Z","updatedAt":"2025-01-17T13:25:11.155Z","id":"W6udcxjzvKUbuKHD","name":"digitalsandwich.agency"}]}